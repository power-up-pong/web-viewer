{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./components/pong/style.css","webpack:///../node_modules/paho-mqtt/paho-mqtt.js","webpack:///../src/util.js","webpack:///../src/create-element.js","webpack:///../src/component.js","webpack:///../src/diff/children.js","webpack:///../src/diff/props.js","webpack:///../src/diff/index.js","webpack:///../src/render.js","webpack:///../src/constants.js","webpack:///../src/options.js","webpack:///../src/diff/catch-error.js","webpack:///../node_modules/preact-cli/lib/lib/entry.js","webpack:///../node_modules/webpack/buildin/global.js","webpack:///../src/index.js","webpack:///./components/header/index.tsx","webpack:///./components/pong/wsClient.ts","webpack:///./components/pong/constants.ts","webpack:///./components/pong/interfaces.ts","webpack:///./components/pong/canvasUtils.ts","webpack:///./components/pong/PowerupLegendEntry.tsx","webpack:///./components/pong/PowerUpLegend.tsx","webpack:///./components/pong/index.ts","webpack:///./components/pong/Pong.tsx","webpack:///./components/pong/getDerivedConstants.ts","webpack:///./index.ts","webpack:///./components/app.tsx","webpack:///./components/header/style.css"],"names":["__webpack_require__","moduleId","installedModules","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","global","decodeMessage","input","pos","digit","startingPos","first","type","messageInfo","remLength","multiplier","length","endPos","wireMessage","WireMessage","MESSAGE_TYPE","sessionPresent","returnCode","qos","len","readUint16","topicName","parseUTF8","messageIdentifier","message","Message","subarray","retained","duplicate","destinationName","payloadMessage","writeUint16","buffer","offset","writeString","utf8Length","stringToUTF8","UTF8Length","output","charCode","charCodeAt","start","lowCharCode","isNaN","Error","format","ERROR","MALFORMED_UNICODE","utf16","byte1","byte2","MALFORMED_UTF","toString","byte3","byte4","String","fromCharCode","data","localStorage","setItem","item","getItem","removeItem","validate","obj","keys","errorStr","validKey","INVALID_TYPE","scope","f","apply","arguments","OK","code","text","CONNECT_TIMEOUT","SUBSCRIBE_TIMEOUT","UNSUBSCRIBE_TIMEOUT","PING_TIMEOUT","INTERNAL_ERROR","CONNACK_RETURNCODE","SOCKET_ERROR","SOCKET_CLOSE","UNSUPPORTED","INVALID_STATE","INVALID_ARGUMENT","UNSUPPORTED_OPERATION","INVALID_STORED_DATA","INVALID_MQTT_MESSAGE_TYPE","BUFFER_FULL","CONNACK_RC","0","1","2","3","4","5","error","substitutions","field","indexOf","part1","substring","part2","MqttProtoIdentifierv3","MqttProtoIdentifierv4","options","this","encode","willMessagePayloadBytes","topicStrLength","destinationNameLength","undefined","mqttVersion","clientId","willMessage","payloadBytes","Uint8Array","byteLength","userName","password","topics","requestedQos","ArrayBuffer","mbi","number","Array","numBytes","encodeMBI","byteStream","set","connectFlags","cleanSession","keepAliveInterval","Pinger","client","_client","_keepAliveInterval","isReset","pingReq","doTimeout","pinger","doPing","_trace","socket","send","timeout","setTimeout","_disconnected","reset","clearTimeout","cancel","Timeout","timeoutSeconds","action","args","ClientImpl","uri","host","port","path","WebSocket","_wsuri","_localKey","_msg_queue","_buffered_msg_queue","_sentMessages","_receivedMessages","_notify_msg_sent","_message_identifier","_sequence","restore","connected","maxMessageIdentifier","connectOptions","hostIndex","onConnected","onConnectionLost","onMessageDelivered","onMessageArrived","traceFunction","_connectTimeout","sendPinger","receivePinger","_reconnectInterval","_reconnecting","_reconnectTimeout","disconnectedPublishing","disconnectedBufferSize","receiveBuffer","_traceBuffer","_MAX_TRACE_ENTRIES","connect","connectOptionsMasked","_traceMask","uris","_doConnect","subscribe","filter","subscribeOptions","constructor","onSuccess","grantedQos","invocationContext","onFailure","errorCode","errorMessage","timeOut","_requires_ack","_schedule_message","unsubscribe","unsubscribeOptions","callback","sequence","unshift","disconnect","getTraceLog","Date","startTrace","stopTrace","wsurl","useSSL","uriParts","split","join","binaryType","onopen","_on_socket_open","onmessage","_on_socket_message","onerror","_on_socket_error","onclose","_on_socket_close","_process_queue","store","prefix","storedMessage","version","pubRecReceived","hex","messageBytes","payloadHex","JSON","stringify","parse","x","parseInt","pop","_socket_send","messageCount","event","messages","_deframeMessages","_handleMessage","byteArray","newData","result","push","errorStack","stack","sentMessage","receivedMessage","sequencedMessages","msgId","msg","sort","a","b","pubRelMessage","reconnected","_connected","_receivePublish","_receiveMessage","pubCompMessage","wireMessageMasked","pubAckMessage","pubRecMessage","reconnect","_reconnect","errorText","readyState","close","mqttVersionExplicit","slice","splice","record","severity","max","shift","traceObject","masked","traceObjectMasked","attr","newPayload","payload","isView","DataView","defineProperties","newDestinationName","newQos","newRetained","newTopic","newDuplicate","Client","match","ipv6AddSBracket","clientIdLength","newOnConnected","newDisconnectedPublishing","newDisconnectedBufferSize","newOnConnectionLost","newOnMessageDelivered","newOnMessageArrived","trace","hosts","ports","stringPayload","usingURIs","test","ipv6","topic","publish","isConnected","self","window","factory","assign","props","removeNode","node","parentNode","removeChild","createElement","children","ref","normalizedProps","defaultProps","createVNode","original","vnode","Fragment","Component","context","getDomSibling","childIndex","sibling","updateParentDomPointers","child","base","enqueueRender","rerenderQueue","process","prevDebounce","debounceRendering","defer","queue","some","component","commitQueue","oldVNode","oldDom","parentDom","diff","ownerSVGElement","commitRoot","diffChildren","renderResult","newParentVNode","oldParentVNode","globalContext","isSvg","excessDomChildren","isHydrating","j","childVNode","newDom","firstChildDom","refs","oldChildren","EMPTY_ARR","oldChildrenLength","isArray","EMPTY_OBJ","reorderChildren","placeChild","unmount","applyRef","tmp","nextDom","sibDom","outer","appendChild","nextSibling","insertBefore","setStyle","style","setProperty","IS_NON_DIMENSIONAL","dom","oldValue","useCapture","cssText","replace","toLowerCase","_listeners","addEventListener","eventProxyCapture","eventProxy","removeEventListener","e","setAttribute","removeAttribute","newVNode","isNew","oldProps","oldState","snapshot","clearProcessingException","newProps","provider","componentContext","newType","contextType","render","doRender","sub","state","getDerivedStateFromProps","componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","forEach","componentWillUpdate","componentDidUpdate","getChildContext","getSnapshotBeforeUpdate","diffElementNodes","diffed","root","cb","oldHtml","newHtml","nodeType","localName","document","createTextNode","createElementNS","is","childNodes","dangerouslySetInnerHTML","attributes","innerHTML","hydrate","diffProps","firstChild","checked","current","parentVNode","skipRemove","componentWillUnmount","replaceNode","ctor","handled","getDerivedStateFromError","setState","componentDidCatch","update","forceUpdate","Promise","then","resolve","h","Preact","interopDefault","default","navigator","serviceWorker","register","__webpack_public_path__","require","getElementById","body","firstElementChild","app","preRenderData","inlineDataElement","querySelector","decodeURI","url","CLI_DATA","init","g","Function","getHookState","index","currentComponent","currentHook","hooks","useState","initialState","reducer","hookState","currentIndex","_reducer","invokeOrReturn","nextValue","useReducer","useRef","initialValue","useMemo","argsChanged","flushAfterPaintEffects","afterPaintEffects","invokeCleanup","invokeEffect","hook","comp","oldArgs","newArgs","arg","prevRaf","Header","class","header","oldBeforeDiff","oldBeforeRender","oldAfterDiff","oldCommit","oldBeforeUnmount","requestAnimationFrame","raf","done","HAS_RAF","cancelAnimationFrame","WEB_SOCKET_ID","Math","random","defaultPlayerState","id","score","paddle_pos","paddle_width","powerups","defaultGameState","players","ball","defaultGameProps","x_constraints","y_constraints","powerup_radius","Paho","console","log","drawPowerupQueue","ctxPowerup","canvasWidth","left","powerup","xPos","time_used","fillStyle","fillRect","USED_POWERUP_BORDER","POWERUP_CANVAS_OFFSET","POWERUP_CANVAS_WIDTH","getPowerupColor","PowerupLegendEntry","squareStyle","display","justifyContent","width","squareText","PowerupLegend","squares","square1","square2","square3","Pong","canvasRef","canvasRefPowerup","gameState","setGameState","gameProps","setGameProps","payloadString","derivedConstants","X_CONSTRAINTS","Y_CONSTRAINTS","POWERUP_RADIUS","CANVAS_PADDING","SCALE","POWERUP_CANVAS_HEIGHT","CANVAS_HEIGHT","CANVAS_WIDTH","getContext","contextPowerup","ctx","player1","player2","ballX","ballY","paddle1","powerups1","paddle1_width","paddle2","powerups2","paddle2_width","HALF_PADDING","clearCanvases","calculatedBallX","calculatedBallY","beginPath","arc","PI","fill","draw","map","player1_score","player2_score","pong","center","height","border","App"],"mappings":"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","file":"bundle.b29b6.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"mdyV\");\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"pong\":\"pong__1JXmR\",\"center\":\"center__q2HNF\",\"squares\":\"squares__2m5GE\",\"square1\":\"square1__3wjOj\",\"square2\":\"square2__2JyCS\",\"square3\":\"square3__29OwC\",\"squareText\":\"squareText__1PJwh\"};","/*******************************************************************************\n * Copyright (c) 2013 IBM Corp.\n *\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * and Eclipse Distribution License v1.0 which accompany this distribution.\n *\n * The Eclipse Public License is available at\n *    http://www.eclipse.org/legal/epl-v10.html\n * and the Eclipse Distribution License is available at\n *   http://www.eclipse.org/org/documents/edl-v10.php.\n *\n * Contributors:\n *    Andrew Banks - initial API and implementation and initial documentation\n *******************************************************************************/\n\n\n// Only expose a single object name in the global namespace.\n// Everything must go through this module. Global Paho module\n// only has a single public function, client, which returns\n// a Paho client object given connection details.\n\n/**\n * Send and receive messages using web browsers.\n * <p>\n * This programming interface lets a JavaScript client application use the MQTT V3.1 or\n * V3.1.1 protocol to connect to an MQTT-supporting messaging server.\n *\n * The function supported includes:\n * <ol>\n * <li>Connecting to and disconnecting from a server. The server is identified by its host name and port number.\n * <li>Specifying options that relate to the communications link with the server,\n * for example the frequency of keep-alive heartbeats, and whether SSL/TLS is required.\n * <li>Subscribing to and receiving messages from MQTT Topics.\n * <li>Publishing messages to MQTT Topics.\n * </ol>\n * <p>\n * The API consists of two main objects:\n * <dl>\n * <dt><b>{@link Paho.Client}</b></dt>\n * <dd>This contains methods that provide the functionality of the API,\n * including provision of callbacks that notify the application when a message\n * arrives from or is delivered to the messaging server,\n * or when the status of its connection to the messaging server changes.</dd>\n * <dt><b>{@link Paho.Message}</b></dt>\n * <dd>This encapsulates the payload of the message along with various attributes\n * associated with its delivery, in particular the destination to which it has\n * been (or is about to be) sent.</dd>\n * </dl>\n * <p>\n * The programming interface validates parameters passed to it, and will throw\n * an Error containing an error message intended for developer use, if it detects\n * an error with any parameter.\n * <p>\n * Example:\n *\n * <code><pre>\nvar client = new Paho.MQTT.Client(location.hostname, Number(location.port), \"clientId\");\nclient.onConnectionLost = onConnectionLost;\nclient.onMessageArrived = onMessageArrived;\nclient.connect({onSuccess:onConnect});\n\nfunction onConnect() {\n  // Once a connection has been made, make a subscription and send a message.\n  console.log(\"onConnect\");\n  client.subscribe(\"/World\");\n  var message = new Paho.MQTT.Message(\"Hello\");\n  message.destinationName = \"/World\";\n  client.send(message);\n};\nfunction onConnectionLost(responseObject) {\n  if (responseObject.errorCode !== 0)\n\tconsole.log(\"onConnectionLost:\"+responseObject.errorMessage);\n};\nfunction onMessageArrived(message) {\n  console.log(\"onMessageArrived:\"+message.payloadString);\n  client.disconnect();\n};\n * </pre></code>\n * @namespace Paho\n */\n\n/* jshint shadow:true */\n(function ExportLibrary(root, factory) {\n\tif(typeof exports === \"object\" && typeof module === \"object\"){\n\t\tmodule.exports = factory();\n\t} else if (typeof define === \"function\" && define.amd){\n\t\tdefine(factory);\n\t} else if (typeof exports === \"object\"){\n\t\texports = factory();\n\t} else {\n\t\t//if (typeof root.Paho === \"undefined\"){\n\t\t//\troot.Paho = {};\n\t\t//}\n\t\troot.Paho = factory();\n\t}\n})(this, function LibraryFactory(){\n\n\n\tvar PahoMQTT = (function (global) {\n\n\t// Private variables below, these are only visible inside the function closure\n\t// which is used to define the module.\n\tvar version = \"@VERSION@-@BUILDLEVEL@\";\n\n\t/**\n\t * @private\n\t */\n\tvar localStorage = global.localStorage || (function () {\n\t\tvar data = {};\n\n\t\treturn {\n\t\t\tsetItem: function (key, item) { data[key] = item; },\n\t\t\tgetItem: function (key) { return data[key]; },\n\t\t\tremoveItem: function (key) { delete data[key]; },\n\t\t};\n\t})();\n\n\t\t/**\n\t * Unique message type identifiers, with associated\n\t * associated integer values.\n\t * @private\n\t */\n\t\tvar MESSAGE_TYPE = {\n\t\t\tCONNECT: 1,\n\t\t\tCONNACK: 2,\n\t\t\tPUBLISH: 3,\n\t\t\tPUBACK: 4,\n\t\t\tPUBREC: 5,\n\t\t\tPUBREL: 6,\n\t\t\tPUBCOMP: 7,\n\t\t\tSUBSCRIBE: 8,\n\t\t\tSUBACK: 9,\n\t\t\tUNSUBSCRIBE: 10,\n\t\t\tUNSUBACK: 11,\n\t\t\tPINGREQ: 12,\n\t\t\tPINGRESP: 13,\n\t\t\tDISCONNECT: 14\n\t\t};\n\n\t\t// Collection of utility methods used to simplify module code\n\t\t// and promote the DRY pattern.\n\n\t\t/**\n\t * Validate an object's parameter names to ensure they\n\t * match a list of expected variables name for this option\n\t * type. Used to ensure option object passed into the API don't\n\t * contain erroneous parameters.\n\t * @param {Object} obj - User options object\n\t * @param {Object} keys - valid keys and types that may exist in obj.\n\t * @throws {Error} Invalid option parameter found.\n\t * @private\n\t */\n\t\tvar validate = function(obj, keys) {\n\t\t\tfor (var key in obj) {\n\t\t\t\tif (obj.hasOwnProperty(key)) {\n\t\t\t\t\tif (keys.hasOwnProperty(key)) {\n\t\t\t\t\t\tif (typeof obj[key] !== keys[key])\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof obj[key], key]));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar errorStr = \"Unknown property, \" + key + \". Valid properties are:\";\n\t\t\t\t\t\tfor (var validKey in keys)\n\t\t\t\t\t\t\tif (keys.hasOwnProperty(validKey))\n\t\t\t\t\t\t\t\terrorStr = errorStr+\" \"+validKey;\n\t\t\t\t\t\tthrow new Error(errorStr);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Return a new function which runs the user function bound\n\t * to a fixed scope.\n\t * @param {function} User function\n\t * @param {object} Function scope\n\t * @return {function} User function bound to another scope\n\t * @private\n\t */\n\t\tvar scope = function (f, scope) {\n\t\t\treturn function () {\n\t\t\t\treturn f.apply(scope, arguments);\n\t\t\t};\n\t\t};\n\n\t\t/**\n\t * Unique message type identifiers, with associated\n\t * associated integer values.\n\t * @private\n\t */\n\t\tvar ERROR = {\n\t\t\tOK: {code:0, text:\"AMQJSC0000I OK.\"},\n\t\t\tCONNECT_TIMEOUT: {code:1, text:\"AMQJSC0001E Connect timed out.\"},\n\t\t\tSUBSCRIBE_TIMEOUT: {code:2, text:\"AMQJS0002E Subscribe timed out.\"},\n\t\t\tUNSUBSCRIBE_TIMEOUT: {code:3, text:\"AMQJS0003E Unsubscribe timed out.\"},\n\t\t\tPING_TIMEOUT: {code:4, text:\"AMQJS0004E Ping timed out.\"},\n\t\t\tINTERNAL_ERROR: {code:5, text:\"AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}\"},\n\t\t\tCONNACK_RETURNCODE: {code:6, text:\"AMQJS0006E Bad Connack return code:{0} {1}.\"},\n\t\t\tSOCKET_ERROR: {code:7, text:\"AMQJS0007E Socket error:{0}.\"},\n\t\t\tSOCKET_CLOSE: {code:8, text:\"AMQJS0008I Socket closed.\"},\n\t\t\tMALFORMED_UTF: {code:9, text:\"AMQJS0009E Malformed UTF data:{0} {1} {2}.\"},\n\t\t\tUNSUPPORTED: {code:10, text:\"AMQJS0010E {0} is not supported by this browser.\"},\n\t\t\tINVALID_STATE: {code:11, text:\"AMQJS0011E Invalid state {0}.\"},\n\t\t\tINVALID_TYPE: {code:12, text:\"AMQJS0012E Invalid type {0} for {1}.\"},\n\t\t\tINVALID_ARGUMENT: {code:13, text:\"AMQJS0013E Invalid argument {0} for {1}.\"},\n\t\t\tUNSUPPORTED_OPERATION: {code:14, text:\"AMQJS0014E Unsupported operation.\"},\n\t\t\tINVALID_STORED_DATA: {code:15, text:\"AMQJS0015E Invalid data in local storage key={0} value={1}.\"},\n\t\t\tINVALID_MQTT_MESSAGE_TYPE: {code:16, text:\"AMQJS0016E Invalid MQTT message type {0}.\"},\n\t\t\tMALFORMED_UNICODE: {code:17, text:\"AMQJS0017E Malformed Unicode string:{0} {1}.\"},\n\t\t\tBUFFER_FULL: {code:18, text:\"AMQJS0018E Message buffer is full, maximum buffer size: {0}.\"},\n\t\t};\n\n\t\t/** CONNACK RC Meaning. */\n\t\tvar CONNACK_RC = {\n\t\t\t0:\"Connection Accepted\",\n\t\t\t1:\"Connection Refused: unacceptable protocol version\",\n\t\t\t2:\"Connection Refused: identifier rejected\",\n\t\t\t3:\"Connection Refused: server unavailable\",\n\t\t\t4:\"Connection Refused: bad user name or password\",\n\t\t\t5:\"Connection Refused: not authorized\"\n\t\t};\n\n\t/**\n\t * Format an error message text.\n\t * @private\n\t * @param {error} ERROR value above.\n\t * @param {substitutions} [array] substituted into the text.\n\t * @return the text with the substitutions made.\n\t */\n\t\tvar format = function(error, substitutions) {\n\t\t\tvar text = error.text;\n\t\t\tif (substitutions) {\n\t\t\t\tvar field,start;\n\t\t\t\tfor (var i=0; i<substitutions.length; i++) {\n\t\t\t\t\tfield = \"{\"+i+\"}\";\n\t\t\t\t\tstart = text.indexOf(field);\n\t\t\t\t\tif(start > 0) {\n\t\t\t\t\t\tvar part1 = text.substring(0,start);\n\t\t\t\t\t\tvar part2 = text.substring(start+field.length);\n\t\t\t\t\t\ttext = part1+substitutions[i]+part2;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn text;\n\t\t};\n\n\t\t//MQTT protocol and version          6    M    Q    I    s    d    p    3\n\t\tvar MqttProtoIdentifierv3 = [0x00,0x06,0x4d,0x51,0x49,0x73,0x64,0x70,0x03];\n\t\t//MQTT proto/version for 311         4    M    Q    T    T    4\n\t\tvar MqttProtoIdentifierv4 = [0x00,0x04,0x4d,0x51,0x54,0x54,0x04];\n\n\t\t/**\n\t * Construct an MQTT wire protocol message.\n\t * @param type MQTT packet type.\n\t * @param options optional wire message attributes.\n\t *\n\t * Optional properties\n\t *\n\t * messageIdentifier: message ID in the range [0..65535]\n\t * payloadMessage:\tApplication Message - PUBLISH only\n\t * connectStrings:\tarray of 0 or more Strings to be put into the CONNECT payload\n\t * topics:\t\t\tarray of strings (SUBSCRIBE, UNSUBSCRIBE)\n\t * requestQoS:\t\tarray of QoS values [0..2]\n\t *\n\t * \"Flag\" properties\n\t * cleanSession:\ttrue if present / false if absent (CONNECT)\n\t * willMessage:  \ttrue if present / false if absent (CONNECT)\n\t * isRetained:\t\ttrue if present / false if absent (CONNECT)\n\t * userName:\t\ttrue if present / false if absent (CONNECT)\n\t * password:\t\ttrue if present / false if absent (CONNECT)\n\t * keepAliveInterval:\tinteger [0..65535]  (CONNECT)\n\t *\n\t * @private\n\t * @ignore\n\t */\n\t\tvar WireMessage = function (type, options) {\n\t\t\tthis.type = type;\n\t\t\tfor (var name in options) {\n\t\t\t\tif (options.hasOwnProperty(name)) {\n\t\t\t\t\tthis[name] = options[name];\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tWireMessage.prototype.encode = function() {\n\t\t// Compute the first byte of the fixed header\n\t\t\tvar first = ((this.type & 0x0f) << 4);\n\n\t\t\t/*\n\t\t * Now calculate the length of the variable header + payload by adding up the lengths\n\t\t * of all the component parts\n\t\t */\n\n\t\t\tvar remLength = 0;\n\t\t\tvar topicStrLength = [];\n\t\t\tvar destinationNameLength = 0;\n\t\t\tvar willMessagePayloadBytes;\n\n\t\t\t// if the message contains a messageIdentifier then we need two bytes for that\n\t\t\tif (this.messageIdentifier !== undefined)\n\t\t\t\tremLength += 2;\n\n\t\t\tswitch(this.type) {\n\t\t\t// If this a Connect then we need to include 12 bytes for its header\n\t\t\tcase MESSAGE_TYPE.CONNECT:\n\t\t\t\tswitch(this.mqttVersion) {\n\t\t\t\tcase 3:\n\t\t\t\t\tremLength += MqttProtoIdentifierv3.length + 3;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4:\n\t\t\t\t\tremLength += MqttProtoIdentifierv4.length + 3;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tremLength += UTF8Length(this.clientId) + 2;\n\t\t\t\tif (this.willMessage !== undefined) {\n\t\t\t\t\tremLength += UTF8Length(this.willMessage.destinationName) + 2;\n\t\t\t\t\t// Will message is always a string, sent as UTF-8 characters with a preceding length.\n\t\t\t\t\twillMessagePayloadBytes = this.willMessage.payloadBytes;\n\t\t\t\t\tif (!(willMessagePayloadBytes instanceof Uint8Array))\n\t\t\t\t\t\twillMessagePayloadBytes = new Uint8Array(payloadBytes);\n\t\t\t\t\tremLength += willMessagePayloadBytes.byteLength +2;\n\t\t\t\t}\n\t\t\t\tif (this.userName !== undefined)\n\t\t\t\t\tremLength += UTF8Length(this.userName) + 2;\n\t\t\t\tif (this.password !== undefined)\n\t\t\t\t\tremLength += UTF8Length(this.password) + 2;\n\t\t\t\tbreak;\n\n\t\t\t// Subscribe, Unsubscribe can both contain topic strings\n\t\t\tcase MESSAGE_TYPE.SUBSCRIBE:\n\t\t\t\tfirst |= 0x02; // Qos = 1;\n\t\t\t\tfor ( var i = 0; i < this.topics.length; i++) {\n\t\t\t\t\ttopicStrLength[i] = UTF8Length(this.topics[i]);\n\t\t\t\t\tremLength += topicStrLength[i] + 2;\n\t\t\t\t}\n\t\t\t\tremLength += this.requestedQos.length; // 1 byte for each topic's Qos\n\t\t\t\t// QoS on Subscribe only\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.UNSUBSCRIBE:\n\t\t\t\tfirst |= 0x02; // Qos = 1;\n\t\t\t\tfor ( var i = 0; i < this.topics.length; i++) {\n\t\t\t\t\ttopicStrLength[i] = UTF8Length(this.topics[i]);\n\t\t\t\t\tremLength += topicStrLength[i] + 2;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.PUBREL:\n\t\t\t\tfirst |= 0x02; // Qos = 1;\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\tif (this.payloadMessage.duplicate) first |= 0x08;\n\t\t\t\tfirst  = first |= (this.payloadMessage.qos << 1);\n\t\t\t\tif (this.payloadMessage.retained) first |= 0x01;\n\t\t\t\tdestinationNameLength = UTF8Length(this.payloadMessage.destinationName);\n\t\t\t\tremLength += destinationNameLength + 2;\n\t\t\t\tvar payloadBytes = this.payloadMessage.payloadBytes;\n\t\t\t\tremLength += payloadBytes.byteLength;\n\t\t\t\tif (payloadBytes instanceof ArrayBuffer)\n\t\t\t\t\tpayloadBytes = new Uint8Array(payloadBytes);\n\t\t\t\telse if (!(payloadBytes instanceof Uint8Array))\n\t\t\t\t\tpayloadBytes = new Uint8Array(payloadBytes.buffer);\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.DISCONNECT:\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// Now we can allocate a buffer for the message\n\n\t\t\tvar mbi = encodeMBI(remLength);  // Convert the length to MQTT MBI format\n\t\t\tvar pos = mbi.length + 1;        // Offset of start of variable header\n\t\t\tvar buffer = new ArrayBuffer(remLength + pos);\n\t\t\tvar byteStream = new Uint8Array(buffer);    // view it as a sequence of bytes\n\n\t\t\t//Write the fixed header into the buffer\n\t\t\tbyteStream[0] = first;\n\t\t\tbyteStream.set(mbi,1);\n\n\t\t\t// If this is a PUBLISH then the variable header starts with a topic\n\t\t\tif (this.type == MESSAGE_TYPE.PUBLISH)\n\t\t\t\tpos = writeString(this.payloadMessage.destinationName, destinationNameLength, byteStream, pos);\n\t\t\t// If this is a CONNECT then the variable header contains the protocol name/version, flags and keepalive time\n\n\t\t\telse if (this.type == MESSAGE_TYPE.CONNECT) {\n\t\t\t\tswitch (this.mqttVersion) {\n\t\t\t\tcase 3:\n\t\t\t\t\tbyteStream.set(MqttProtoIdentifierv3, pos);\n\t\t\t\t\tpos += MqttProtoIdentifierv3.length;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4:\n\t\t\t\t\tbyteStream.set(MqttProtoIdentifierv4, pos);\n\t\t\t\t\tpos += MqttProtoIdentifierv4.length;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tvar connectFlags = 0;\n\t\t\t\tif (this.cleanSession)\n\t\t\t\t\tconnectFlags = 0x02;\n\t\t\t\tif (this.willMessage !== undefined ) {\n\t\t\t\t\tconnectFlags |= 0x04;\n\t\t\t\t\tconnectFlags |= (this.willMessage.qos<<3);\n\t\t\t\t\tif (this.willMessage.retained) {\n\t\t\t\t\t\tconnectFlags |= 0x20;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (this.userName !== undefined)\n\t\t\t\t\tconnectFlags |= 0x80;\n\t\t\t\tif (this.password !== undefined)\n\t\t\t\t\tconnectFlags |= 0x40;\n\t\t\t\tbyteStream[pos++] = connectFlags;\n\t\t\t\tpos = writeUint16 (this.keepAliveInterval, byteStream, pos);\n\t\t\t}\n\n\t\t\t// Output the messageIdentifier - if there is one\n\t\t\tif (this.messageIdentifier !== undefined)\n\t\t\t\tpos = writeUint16 (this.messageIdentifier, byteStream, pos);\n\n\t\t\tswitch(this.type) {\n\t\t\tcase MESSAGE_TYPE.CONNECT:\n\t\t\t\tpos = writeString(this.clientId, UTF8Length(this.clientId), byteStream, pos);\n\t\t\t\tif (this.willMessage !== undefined) {\n\t\t\t\t\tpos = writeString(this.willMessage.destinationName, UTF8Length(this.willMessage.destinationName), byteStream, pos);\n\t\t\t\t\tpos = writeUint16(willMessagePayloadBytes.byteLength, byteStream, pos);\n\t\t\t\t\tbyteStream.set(willMessagePayloadBytes, pos);\n\t\t\t\t\tpos += willMessagePayloadBytes.byteLength;\n\n\t\t\t\t}\n\t\t\t\tif (this.userName !== undefined)\n\t\t\t\t\tpos = writeString(this.userName, UTF8Length(this.userName), byteStream, pos);\n\t\t\t\tif (this.password !== undefined)\n\t\t\t\t\tpos = writeString(this.password, UTF8Length(this.password), byteStream, pos);\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\t// PUBLISH has a text or binary payload, if text do not add a 2 byte length field, just the UTF characters.\n\t\t\t\tbyteStream.set(payloadBytes, pos);\n\n\t\t\t\tbreak;\n\n\t\t\t\t//    \t    case MESSAGE_TYPE.PUBREC:\n\t\t\t\t//    \t    case MESSAGE_TYPE.PUBREL:\n\t\t\t\t//    \t    case MESSAGE_TYPE.PUBCOMP:\n\t\t\t\t//    \t    \tbreak;\n\n\t\t\tcase MESSAGE_TYPE.SUBSCRIBE:\n\t\t\t\t// SUBSCRIBE has a list of topic strings and request QoS\n\t\t\t\tfor (var i=0; i<this.topics.length; i++) {\n\t\t\t\t\tpos = writeString(this.topics[i], topicStrLength[i], byteStream, pos);\n\t\t\t\t\tbyteStream[pos++] = this.requestedQos[i];\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.UNSUBSCRIBE:\n\t\t\t\t// UNSUBSCRIBE has a list of topic strings\n\t\t\t\tfor (var i=0; i<this.topics.length; i++)\n\t\t\t\t\tpos = writeString(this.topics[i], topicStrLength[i], byteStream, pos);\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\t// Do nothing.\n\t\t\t}\n\n\t\t\treturn buffer;\n\t\t};\n\n\t\tfunction decodeMessage(input,pos) {\n\t\t\tvar startingPos = pos;\n\t\t\tvar first = input[pos];\n\t\t\tvar type = first >> 4;\n\t\t\tvar messageInfo = first &= 0x0f;\n\t\t\tpos += 1;\n\n\n\t\t\t// Decode the remaining length (MBI format)\n\n\t\t\tvar digit;\n\t\t\tvar remLength = 0;\n\t\t\tvar multiplier = 1;\n\t\t\tdo {\n\t\t\t\tif (pos == input.length) {\n\t\t\t\t\treturn [null,startingPos];\n\t\t\t\t}\n\t\t\t\tdigit = input[pos++];\n\t\t\t\tremLength += ((digit & 0x7F) * multiplier);\n\t\t\t\tmultiplier *= 128;\n\t\t\t} while ((digit & 0x80) !== 0);\n\n\t\t\tvar endPos = pos+remLength;\n\t\t\tif (endPos > input.length) {\n\t\t\t\treturn [null,startingPos];\n\t\t\t}\n\n\t\t\tvar wireMessage = new WireMessage(type);\n\t\t\tswitch(type) {\n\t\t\tcase MESSAGE_TYPE.CONNACK:\n\t\t\t\tvar connectAcknowledgeFlags = input[pos++];\n\t\t\t\tif (connectAcknowledgeFlags & 0x01)\n\t\t\t\t\twireMessage.sessionPresent = true;\n\t\t\t\twireMessage.returnCode = input[pos++];\n\t\t\t\tbreak;\n\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\tvar qos = (messageInfo >> 1) & 0x03;\n\n\t\t\t\tvar len = readUint16(input, pos);\n\t\t\t\tpos += 2;\n\t\t\t\tvar topicName = parseUTF8(input, pos, len);\n\t\t\t\tpos += len;\n\t\t\t\t// If QoS 1 or 2 there will be a messageIdentifier\n\t\t\t\tif (qos > 0) {\n\t\t\t\t\twireMessage.messageIdentifier = readUint16(input, pos);\n\t\t\t\t\tpos += 2;\n\t\t\t\t}\n\n\t\t\t\tvar message = new Message(input.subarray(pos, endPos));\n\t\t\t\tif ((messageInfo & 0x01) == 0x01)\n\t\t\t\t\tmessage.retained = true;\n\t\t\t\tif ((messageInfo & 0x08) == 0x08)\n\t\t\t\t\tmessage.duplicate =  true;\n\t\t\t\tmessage.qos = qos;\n\t\t\t\tmessage.destinationName = topicName;\n\t\t\t\twireMessage.payloadMessage = message;\n\t\t\t\tbreak;\n\n\t\t\tcase  MESSAGE_TYPE.PUBACK:\n\t\t\tcase  MESSAGE_TYPE.PUBREC:\n\t\t\tcase  MESSAGE_TYPE.PUBREL:\n\t\t\tcase  MESSAGE_TYPE.PUBCOMP:\n\t\t\tcase  MESSAGE_TYPE.UNSUBACK:\n\t\t\t\twireMessage.messageIdentifier = readUint16(input, pos);\n\t\t\t\tbreak;\n\n\t\t\tcase  MESSAGE_TYPE.SUBACK:\n\t\t\t\twireMessage.messageIdentifier = readUint16(input, pos);\n\t\t\t\tpos += 2;\n\t\t\t\twireMessage.returnCode = input.subarray(pos, endPos);\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn [wireMessage,endPos];\n\t\t}\n\n\t\tfunction writeUint16(input, buffer, offset) {\n\t\t\tbuffer[offset++] = input >> 8;      //MSB\n\t\t\tbuffer[offset++] = input % 256;     //LSB\n\t\t\treturn offset;\n\t\t}\n\n\t\tfunction writeString(input, utf8Length, buffer, offset) {\n\t\t\toffset = writeUint16(utf8Length, buffer, offset);\n\t\t\tstringToUTF8(input, buffer, offset);\n\t\t\treturn offset + utf8Length;\n\t\t}\n\n\t\tfunction readUint16(buffer, offset) {\n\t\t\treturn 256*buffer[offset] + buffer[offset+1];\n\t\t}\n\n\t\t/**\n\t * Encodes an MQTT Multi-Byte Integer\n\t * @private\n\t */\n\t\tfunction encodeMBI(number) {\n\t\t\tvar output = new Array(1);\n\t\t\tvar numBytes = 0;\n\n\t\t\tdo {\n\t\t\t\tvar digit = number % 128;\n\t\t\t\tnumber = number >> 7;\n\t\t\t\tif (number > 0) {\n\t\t\t\t\tdigit |= 0x80;\n\t\t\t\t}\n\t\t\t\toutput[numBytes++] = digit;\n\t\t\t} while ( (number > 0) && (numBytes<4) );\n\n\t\t\treturn output;\n\t\t}\n\n\t\t/**\n\t * Takes a String and calculates its length in bytes when encoded in UTF8.\n\t * @private\n\t */\n\t\tfunction UTF8Length(input) {\n\t\t\tvar output = 0;\n\t\t\tfor (var i = 0; i<input.length; i++)\n\t\t\t{\n\t\t\t\tvar charCode = input.charCodeAt(i);\n\t\t\t\tif (charCode > 0x7FF)\n\t\t\t\t{\n\t\t\t\t\t// Surrogate pair means its a 4 byte character\n\t\t\t\t\tif (0xD800 <= charCode && charCode <= 0xDBFF)\n\t\t\t\t\t{\n\t\t\t\t\t\ti++;\n\t\t\t\t\t\toutput++;\n\t\t\t\t\t}\n\t\t\t\t\toutput +=3;\n\t\t\t\t}\n\t\t\t\telse if (charCode > 0x7F)\n\t\t\t\t\toutput +=2;\n\t\t\t\telse\n\t\t\t\t\toutput++;\n\t\t\t}\n\t\t\treturn output;\n\t\t}\n\n\t\t/**\n\t * Takes a String and writes it into an array as UTF8 encoded bytes.\n\t * @private\n\t */\n\t\tfunction stringToUTF8(input, output, start) {\n\t\t\tvar pos = start;\n\t\t\tfor (var i = 0; i<input.length; i++) {\n\t\t\t\tvar charCode = input.charCodeAt(i);\n\n\t\t\t\t// Check for a surrogate pair.\n\t\t\t\tif (0xD800 <= charCode && charCode <= 0xDBFF) {\n\t\t\t\t\tvar lowCharCode = input.charCodeAt(++i);\n\t\t\t\t\tif (isNaN(lowCharCode)) {\n\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UNICODE, [charCode, lowCharCode]));\n\t\t\t\t\t}\n\t\t\t\t\tcharCode = ((charCode - 0xD800)<<10) + (lowCharCode - 0xDC00) + 0x10000;\n\n\t\t\t\t}\n\n\t\t\t\tif (charCode <= 0x7F) {\n\t\t\t\t\toutput[pos++] = charCode;\n\t\t\t\t} else if (charCode <= 0x7FF) {\n\t\t\t\t\toutput[pos++] = charCode>>6  & 0x1F | 0xC0;\n\t\t\t\t\toutput[pos++] = charCode     & 0x3F | 0x80;\n\t\t\t\t} else if (charCode <= 0xFFFF) {\n\t\t\t\t\toutput[pos++] = charCode>>12 & 0x0F | 0xE0;\n\t\t\t\t\toutput[pos++] = charCode>>6  & 0x3F | 0x80;\n\t\t\t\t\toutput[pos++] = charCode     & 0x3F | 0x80;\n\t\t\t\t} else {\n\t\t\t\t\toutput[pos++] = charCode>>18 & 0x07 | 0xF0;\n\t\t\t\t\toutput[pos++] = charCode>>12 & 0x3F | 0x80;\n\t\t\t\t\toutput[pos++] = charCode>>6  & 0x3F | 0x80;\n\t\t\t\t\toutput[pos++] = charCode     & 0x3F | 0x80;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn output;\n\t\t}\n\n\t\tfunction parseUTF8(input, offset, length) {\n\t\t\tvar output = \"\";\n\t\t\tvar utf16;\n\t\t\tvar pos = offset;\n\n\t\t\twhile (pos < offset+length)\n\t\t\t{\n\t\t\t\tvar byte1 = input[pos++];\n\t\t\t\tif (byte1 < 128)\n\t\t\t\t\tutf16 = byte1;\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tvar byte2 = input[pos++]-128;\n\t\t\t\t\tif (byte2 < 0)\n\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16),\"\"]));\n\t\t\t\t\tif (byte1 < 0xE0)             // 2 byte character\n\t\t\t\t\t\tutf16 = 64*(byte1-0xC0) + byte2;\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tvar byte3 = input[pos++]-128;\n\t\t\t\t\t\tif (byte3 < 0)\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16), byte3.toString(16)]));\n\t\t\t\t\t\tif (byte1 < 0xF0)        // 3 byte character\n\t\t\t\t\t\t\tutf16 = 4096*(byte1-0xE0) + 64*byte2 + byte3;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar byte4 = input[pos++]-128;\n\t\t\t\t\t\t\tif (byte4 < 0)\n\t\t\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16), byte3.toString(16), byte4.toString(16)]));\n\t\t\t\t\t\t\tif (byte1 < 0xF8)        // 4 byte character\n\t\t\t\t\t\t\t\tutf16 = 262144*(byte1-0xF0) + 4096*byte2 + 64*byte3 + byte4;\n\t\t\t\t\t\t\telse                     // longer encodings are not supported\n\t\t\t\t\t\t\t\tthrow new Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16), byte3.toString(16), byte4.toString(16)]));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (utf16 > 0xFFFF)   // 4 byte character - express as a surrogate pair\n\t\t\t\t{\n\t\t\t\t\tutf16 -= 0x10000;\n\t\t\t\t\toutput += String.fromCharCode(0xD800 + (utf16 >> 10)); // lead character\n\t\t\t\t\tutf16 = 0xDC00 + (utf16 & 0x3FF);  // trail character\n\t\t\t\t}\n\t\t\t\toutput += String.fromCharCode(utf16);\n\t\t\t}\n\t\t\treturn output;\n\t\t}\n\n\t\t/**\n\t * Repeat keepalive requests, monitor responses.\n\t * @ignore\n\t */\n\t\tvar Pinger = function(client, keepAliveInterval) {\n\t\t\tthis._client = client;\n\t\t\tthis._keepAliveInterval = keepAliveInterval*1000;\n\t\t\tthis.isReset = false;\n\n\t\t\tvar pingReq = new WireMessage(MESSAGE_TYPE.PINGREQ).encode();\n\n\t\t\tvar doTimeout = function (pinger) {\n\t\t\t\treturn function () {\n\t\t\t\t\treturn doPing.apply(pinger);\n\t\t\t\t};\n\t\t\t};\n\n\t\t\t/** @ignore */\n\t\t\tvar doPing = function() {\n\t\t\t\tif (!this.isReset) {\n\t\t\t\t\tthis._client._trace(\"Pinger.doPing\", \"Timed out\");\n\t\t\t\t\tthis._client._disconnected( ERROR.PING_TIMEOUT.code , format(ERROR.PING_TIMEOUT));\n\t\t\t\t} else {\n\t\t\t\t\tthis.isReset = false;\n\t\t\t\t\tthis._client._trace(\"Pinger.doPing\", \"send PINGREQ\");\n\t\t\t\t\tthis._client.socket.send(pingReq);\n\t\t\t\t\tthis.timeout = setTimeout(doTimeout(this), this._keepAliveInterval);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis.reset = function() {\n\t\t\t\tthis.isReset = true;\n\t\t\t\tclearTimeout(this.timeout);\n\t\t\t\tif (this._keepAliveInterval > 0)\n\t\t\t\t\tthis.timeout = setTimeout(doTimeout(this), this._keepAliveInterval);\n\t\t\t};\n\n\t\t\tthis.cancel = function() {\n\t\t\t\tclearTimeout(this.timeout);\n\t\t\t};\n\t\t};\n\n\t\t/**\n\t * Monitor request completion.\n\t * @ignore\n\t */\n\t\tvar Timeout = function(client, timeoutSeconds, action, args) {\n\t\t\tif (!timeoutSeconds)\n\t\t\t\ttimeoutSeconds = 30;\n\n\t\t\tvar doTimeout = function (action, client, args) {\n\t\t\t\treturn function () {\n\t\t\t\t\treturn action.apply(client, args);\n\t\t\t\t};\n\t\t\t};\n\t\t\tthis.timeout = setTimeout(doTimeout(action, client, args), timeoutSeconds * 1000);\n\n\t\t\tthis.cancel = function() {\n\t\t\t\tclearTimeout(this.timeout);\n\t\t\t};\n\t\t};\n\n\t/**\n\t * Internal implementation of the Websockets MQTT V3.1 client.\n\t *\n\t * @name Paho.ClientImpl @constructor\n\t * @param {String} host the DNS nameof the webSocket host.\n\t * @param {Number} port the port number for that host.\n\t * @param {String} clientId the MQ client identifier.\n\t */\n\t\tvar ClientImpl = function (uri, host, port, path, clientId) {\n\t\t// Check dependencies are satisfied in this browser.\n\t\t\tif (!(\"WebSocket\" in global && global.WebSocket !== null)) {\n\t\t\t\tthrow new Error(format(ERROR.UNSUPPORTED, [\"WebSocket\"]));\n\t\t\t}\n\t\t\tif (!(\"ArrayBuffer\" in global && global.ArrayBuffer !== null)) {\n\t\t\t\tthrow new Error(format(ERROR.UNSUPPORTED, [\"ArrayBuffer\"]));\n\t\t\t}\n\t\t\tthis._trace(\"Paho.Client\", uri, host, port, path, clientId);\n\n\t\t\tthis.host = host;\n\t\t\tthis.port = port;\n\t\t\tthis.path = path;\n\t\t\tthis.uri = uri;\n\t\t\tthis.clientId = clientId;\n\t\t\tthis._wsuri = null;\n\n\t\t\t// Local storagekeys are qualified with the following string.\n\t\t\t// The conditional inclusion of path in the key is for backward\n\t\t\t// compatibility to when the path was not configurable and assumed to\n\t\t\t// be /mqtt\n\t\t\tthis._localKey=host+\":\"+port+(path!=\"/mqtt\"?\":\"+path:\"\")+\":\"+clientId+\":\";\n\n\t\t\t// Create private instance-only message queue\n\t\t\t// Internal queue of messages to be sent, in sending order.\n\t\t\tthis._msg_queue = [];\n\t\t\tthis._buffered_msg_queue = [];\n\n\t\t\t// Messages we have sent and are expecting a response for, indexed by their respective message ids.\n\t\t\tthis._sentMessages = {};\n\n\t\t\t// Messages we have received and acknowleged and are expecting a confirm message for\n\t\t\t// indexed by their respective message ids.\n\t\t\tthis._receivedMessages = {};\n\n\t\t\t// Internal list of callbacks to be executed when messages\n\t\t\t// have been successfully sent over web socket, e.g. disconnect\n\t\t\t// when it doesn't have to wait for ACK, just message is dispatched.\n\t\t\tthis._notify_msg_sent = {};\n\n\t\t\t// Unique identifier for SEND messages, incrementing\n\t\t\t// counter as messages are sent.\n\t\t\tthis._message_identifier = 1;\n\n\t\t\t// Used to determine the transmission sequence of stored sent messages.\n\t\t\tthis._sequence = 0;\n\n\n\t\t\t// Load the local state, if any, from the saved version, only restore state relevant to this client.\n\t\t\tfor (var key in localStorage)\n\t\t\t\tif (   key.indexOf(\"Sent:\"+this._localKey) === 0 || key.indexOf(\"Received:\"+this._localKey) === 0)\n\t\t\t\t\tthis.restore(key);\n\t\t};\n\n\t\t// Messaging Client public instance members.\n\t\tClientImpl.prototype.host = null;\n\t\tClientImpl.prototype.port = null;\n\t\tClientImpl.prototype.path = null;\n\t\tClientImpl.prototype.uri = null;\n\t\tClientImpl.prototype.clientId = null;\n\n\t\t// Messaging Client private instance members.\n\t\tClientImpl.prototype.socket = null;\n\t\t/* true once we have received an acknowledgement to a CONNECT packet. */\n\t\tClientImpl.prototype.connected = false;\n\t\t/* The largest message identifier allowed, may not be larger than 2**16 but\n\t\t * if set smaller reduces the maximum number of outbound messages allowed.\n\t\t */\n\t\tClientImpl.prototype.maxMessageIdentifier = 65536;\n\t\tClientImpl.prototype.connectOptions = null;\n\t\tClientImpl.prototype.hostIndex = null;\n\t\tClientImpl.prototype.onConnected = null;\n\t\tClientImpl.prototype.onConnectionLost = null;\n\t\tClientImpl.prototype.onMessageDelivered = null;\n\t\tClientImpl.prototype.onMessageArrived = null;\n\t\tClientImpl.prototype.traceFunction = null;\n\t\tClientImpl.prototype._msg_queue = null;\n\t\tClientImpl.prototype._buffered_msg_queue = null;\n\t\tClientImpl.prototype._connectTimeout = null;\n\t\t/* The sendPinger monitors how long we allow before we send data to prove to the server that we are alive. */\n\t\tClientImpl.prototype.sendPinger = null;\n\t\t/* The receivePinger monitors how long we allow before we require evidence that the server is alive. */\n\t\tClientImpl.prototype.receivePinger = null;\n\t\tClientImpl.prototype._reconnectInterval = 1; // Reconnect Delay, starts at 1 second\n\t\tClientImpl.prototype._reconnecting = false;\n\t\tClientImpl.prototype._reconnectTimeout = null;\n\t\tClientImpl.prototype.disconnectedPublishing = false;\n\t\tClientImpl.prototype.disconnectedBufferSize = 5000;\n\n\t\tClientImpl.prototype.receiveBuffer = null;\n\n\t\tClientImpl.prototype._traceBuffer = null;\n\t\tClientImpl.prototype._MAX_TRACE_ENTRIES = 100;\n\n\t\tClientImpl.prototype.connect = function (connectOptions) {\n\t\t\tvar connectOptionsMasked = this._traceMask(connectOptions, \"password\");\n\t\t\tthis._trace(\"Client.connect\", connectOptionsMasked, this.socket, this.connected);\n\n\t\t\tif (this.connected)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"already connected\"]));\n\t\t\tif (this.socket)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"already connected\"]));\n\n\t\t\tif (this._reconnecting) {\n\t\t\t// connect() function is called while reconnect is in progress.\n\t\t\t// Terminate the auto reconnect process to use new connect options.\n\t\t\t\tthis._reconnectTimeout.cancel();\n\t\t\t\tthis._reconnectTimeout = null;\n\t\t\t\tthis._reconnecting = false;\n\t\t\t}\n\n\t\t\tthis.connectOptions = connectOptions;\n\t\t\tthis._reconnectInterval = 1;\n\t\t\tthis._reconnecting = false;\n\t\t\tif (connectOptions.uris) {\n\t\t\t\tthis.hostIndex = 0;\n\t\t\t\tthis._doConnect(connectOptions.uris[0]);\n\t\t\t} else {\n\t\t\t\tthis._doConnect(this.uri);\n\t\t\t}\n\n\t\t};\n\n\t\tClientImpl.prototype.subscribe = function (filter, subscribeOptions) {\n\t\t\tthis._trace(\"Client.subscribe\", filter, subscribeOptions);\n\n\t\t\tif (!this.connected)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"not connected\"]));\n\n            var wireMessage = new WireMessage(MESSAGE_TYPE.SUBSCRIBE);\n            wireMessage.topics = filter.constructor === Array ? filter : [filter];\n            if (subscribeOptions.qos === undefined)\n                subscribeOptions.qos = 0;\n            wireMessage.requestedQos = [];\n            for (var i = 0; i < wireMessage.topics.length; i++)\n                wireMessage.requestedQos[i] = subscribeOptions.qos;\n\n\t\t\tif (subscribeOptions.onSuccess) {\n\t\t\t\twireMessage.onSuccess = function(grantedQos) {subscribeOptions.onSuccess({invocationContext:subscribeOptions.invocationContext,grantedQos:grantedQos});};\n\t\t\t}\n\n\t\t\tif (subscribeOptions.onFailure) {\n\t\t\t\twireMessage.onFailure = function(errorCode) {subscribeOptions.onFailure({invocationContext:subscribeOptions.invocationContext,errorCode:errorCode, errorMessage:format(errorCode)});};\n\t\t\t}\n\n\t\t\tif (subscribeOptions.timeout) {\n\t\t\t\twireMessage.timeOut = new Timeout(this, subscribeOptions.timeout, subscribeOptions.onFailure,\n\t\t\t\t\t[{invocationContext:subscribeOptions.invocationContext,\n\t\t\t\t\t\terrorCode:ERROR.SUBSCRIBE_TIMEOUT.code,\n\t\t\t\t\t\terrorMessage:format(ERROR.SUBSCRIBE_TIMEOUT)}]);\n\t\t\t}\n\n\t\t\t// All subscriptions return a SUBACK.\n\t\t\tthis._requires_ack(wireMessage);\n\t\t\tthis._schedule_message(wireMessage);\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype.unsubscribe = function(filter, unsubscribeOptions) {\n\t\t\tthis._trace(\"Client.unsubscribe\", filter, unsubscribeOptions);\n\n\t\t\tif (!this.connected)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"not connected\"]));\n\n            var wireMessage = new WireMessage(MESSAGE_TYPE.UNSUBSCRIBE);\n            wireMessage.topics = filter.constructor === Array ? filter : [filter];\n\n\t\t\tif (unsubscribeOptions.onSuccess) {\n\t\t\t\twireMessage.callback = function() {unsubscribeOptions.onSuccess({invocationContext:unsubscribeOptions.invocationContext});};\n\t\t\t}\n\t\t\tif (unsubscribeOptions.timeout) {\n\t\t\t\twireMessage.timeOut = new Timeout(this, unsubscribeOptions.timeout, unsubscribeOptions.onFailure,\n\t\t\t\t\t[{invocationContext:unsubscribeOptions.invocationContext,\n\t\t\t\t\t\terrorCode:ERROR.UNSUBSCRIBE_TIMEOUT.code,\n\t\t\t\t\t\terrorMessage:format(ERROR.UNSUBSCRIBE_TIMEOUT)}]);\n\t\t\t}\n\n\t\t\t// All unsubscribes return a SUBACK.\n\t\t\tthis._requires_ack(wireMessage);\n\t\t\tthis._schedule_message(wireMessage);\n\t\t};\n\n\t\tClientImpl.prototype.send = function (message) {\n\t\t\tthis._trace(\"Client.send\", message);\n\n\t\t\tvar wireMessage = new WireMessage(MESSAGE_TYPE.PUBLISH);\n\t\t\twireMessage.payloadMessage = message;\n\n\t\t\tif (this.connected) {\n\t\t\t// Mark qos 1 & 2 message as \"ACK required\"\n\t\t\t// For qos 0 message, invoke onMessageDelivered callback if there is one.\n\t\t\t// Then schedule the message.\n\t\t\t\tif (message.qos > 0) {\n\t\t\t\t\tthis._requires_ack(wireMessage);\n\t\t\t\t} else if (this.onMessageDelivered) {\n\t\t\t\t\tthis._notify_msg_sent[wireMessage] = this.onMessageDelivered(wireMessage.payloadMessage);\n\t\t\t\t}\n\t\t\t\tthis._schedule_message(wireMessage);\n\t\t\t} else {\n\t\t\t// Currently disconnected, will not schedule this message\n\t\t\t// Check if reconnecting is in progress and disconnected publish is enabled.\n\t\t\t\tif (this._reconnecting && this.disconnectedPublishing) {\n\t\t\t\t// Check the limit which include the \"required ACK\" messages\n\t\t\t\t\tvar messageCount = Object.keys(this._sentMessages).length + this._buffered_msg_queue.length;\n\t\t\t\t\tif (messageCount > this.disconnectedBufferSize) {\n\t\t\t\t\t\tthrow new Error(format(ERROR.BUFFER_FULL, [this.disconnectedBufferSize]));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (message.qos > 0) {\n\t\t\t\t\t\t// Mark this message as \"ACK required\"\n\t\t\t\t\t\t\tthis._requires_ack(wireMessage);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\twireMessage.sequence = ++this._sequence;\n\t\t\t\t\t\t\t// Add messages in fifo order to array, by adding to start\n\t\t\t\t\t\t\tthis._buffered_msg_queue.unshift(wireMessage);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"not connected\"]));\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype.disconnect = function () {\n\t\t\tthis._trace(\"Client.disconnect\");\n\n\t\t\tif (this._reconnecting) {\n\t\t\t// disconnect() function is called while reconnect is in progress.\n\t\t\t// Terminate the auto reconnect process.\n\t\t\t\tthis._reconnectTimeout.cancel();\n\t\t\t\tthis._reconnectTimeout = null;\n\t\t\t\tthis._reconnecting = false;\n\t\t\t}\n\n\t\t\tif (!this.socket)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_STATE, [\"not connecting or connected\"]));\n\n\t\t\tvar wireMessage = new WireMessage(MESSAGE_TYPE.DISCONNECT);\n\n\t\t\t// Run the disconnected call back as soon as the message has been sent,\n\t\t\t// in case of a failure later on in the disconnect processing.\n\t\t\t// as a consequence, the _disconected call back may be run several times.\n\t\t\tthis._notify_msg_sent[wireMessage] = scope(this._disconnected, this);\n\n\t\t\tthis._schedule_message(wireMessage);\n\t\t};\n\n\t\tClientImpl.prototype.getTraceLog = function () {\n\t\t\tif ( this._traceBuffer !== null ) {\n\t\t\t\tthis._trace(\"Client.getTraceLog\", new Date());\n\t\t\t\tthis._trace(\"Client.getTraceLog in flight messages\", this._sentMessages.length);\n\t\t\t\tfor (var key in this._sentMessages)\n\t\t\t\t\tthis._trace(\"_sentMessages \",key, this._sentMessages[key]);\n\t\t\t\tfor (var key in this._receivedMessages)\n\t\t\t\t\tthis._trace(\"_receivedMessages \",key, this._receivedMessages[key]);\n\n\t\t\t\treturn this._traceBuffer;\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype.startTrace = function () {\n\t\t\tif ( this._traceBuffer === null ) {\n\t\t\t\tthis._traceBuffer = [];\n\t\t\t}\n\t\t\tthis._trace(\"Client.startTrace\", new Date(), version);\n\t\t};\n\n\t\tClientImpl.prototype.stopTrace = function () {\n\t\t\tdelete this._traceBuffer;\n\t\t};\n\n\t\tClientImpl.prototype._doConnect = function (wsurl) {\n\t\t// When the socket is open, this client will send the CONNECT WireMessage using the saved parameters.\n\t\t\tif (this.connectOptions.useSSL) {\n\t\t\t\tvar uriParts = wsurl.split(\":\");\n\t\t\t\turiParts[0] = \"wss\";\n\t\t\t\twsurl = uriParts.join(\":\");\n\t\t\t}\n\t\t\tthis._wsuri = wsurl;\n\t\t\tthis.connected = false;\n\n\n\n\t\t\tif (this.connectOptions.mqttVersion < 4) {\n\t\t\t\tthis.socket = new WebSocket(wsurl, [\"mqttv3.1\"]);\n\t\t\t} else {\n\t\t\t\tthis.socket = new WebSocket(wsurl, [\"mqtt\"]);\n\t\t\t}\n\t\t\tthis.socket.binaryType = \"arraybuffer\";\n\t\t\tthis.socket.onopen = scope(this._on_socket_open, this);\n\t\t\tthis.socket.onmessage = scope(this._on_socket_message, this);\n\t\t\tthis.socket.onerror = scope(this._on_socket_error, this);\n\t\t\tthis.socket.onclose = scope(this._on_socket_close, this);\n\n\t\t\tthis.sendPinger = new Pinger(this, this.connectOptions.keepAliveInterval);\n\t\t\tthis.receivePinger = new Pinger(this, this.connectOptions.keepAliveInterval);\n\t\t\tif (this._connectTimeout) {\n\t\t\t\tthis._connectTimeout.cancel();\n\t\t\t\tthis._connectTimeout = null;\n\t\t\t}\n\t\t\tthis._connectTimeout = new Timeout(this, this.connectOptions.timeout, this._disconnected,  [ERROR.CONNECT_TIMEOUT.code, format(ERROR.CONNECT_TIMEOUT)]);\n\t\t};\n\n\n\t\t// Schedule a new message to be sent over the WebSockets\n\t\t// connection. CONNECT messages cause WebSocket connection\n\t\t// to be started. All other messages are queued internally\n\t\t// until this has happened. When WS connection starts, process\n\t\t// all outstanding messages.\n\t\tClientImpl.prototype._schedule_message = function (message) {\n\t\t\t// Add messages in fifo order to array, by adding to start\n\t\t\tthis._msg_queue.unshift(message);\n\t\t\t// Process outstanding messages in the queue if we have an  open socket, and have received CONNACK.\n\t\t\tif (this.connected) {\n\t\t\t\tthis._process_queue();\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype.store = function(prefix, wireMessage) {\n\t\t\tvar storedMessage = {type:wireMessage.type, messageIdentifier:wireMessage.messageIdentifier, version:1};\n\n\t\t\tswitch(wireMessage.type) {\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\tif(wireMessage.pubRecReceived)\n\t\t\t\t\tstoredMessage.pubRecReceived = true;\n\n\t\t\t\t// Convert the payload to a hex string.\n\t\t\t\tstoredMessage.payloadMessage = {};\n\t\t\t\tvar hex = \"\";\n\t\t\t\tvar messageBytes = wireMessage.payloadMessage.payloadBytes;\n\t\t\t\tfor (var i=0; i<messageBytes.length; i++) {\n\t\t\t\t\tif (messageBytes[i] <= 0xF)\n\t\t\t\t\t\thex = hex+\"0\"+messageBytes[i].toString(16);\n\t\t\t\t\telse\n\t\t\t\t\t\thex = hex+messageBytes[i].toString(16);\n\t\t\t\t}\n\t\t\t\tstoredMessage.payloadMessage.payloadHex = hex;\n\n\t\t\t\tstoredMessage.payloadMessage.qos = wireMessage.payloadMessage.qos;\n\t\t\t\tstoredMessage.payloadMessage.destinationName = wireMessage.payloadMessage.destinationName;\n\t\t\t\tif (wireMessage.payloadMessage.duplicate)\n\t\t\t\t\tstoredMessage.payloadMessage.duplicate = true;\n\t\t\t\tif (wireMessage.payloadMessage.retained)\n\t\t\t\t\tstoredMessage.payloadMessage.retained = true;\n\n\t\t\t\t// Add a sequence number to sent messages.\n\t\t\t\tif ( prefix.indexOf(\"Sent:\") === 0 ) {\n\t\t\t\t\tif ( wireMessage.sequence === undefined )\n\t\t\t\t\t\twireMessage.sequence = ++this._sequence;\n\t\t\t\t\tstoredMessage.sequence = wireMessage.sequence;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow Error(format(ERROR.INVALID_STORED_DATA, [prefix+this._localKey+wireMessage.messageIdentifier, storedMessage]));\n\t\t\t}\n\t\t\tlocalStorage.setItem(prefix+this._localKey+wireMessage.messageIdentifier, JSON.stringify(storedMessage));\n\t\t};\n\n\t\tClientImpl.prototype.restore = function(key) {\n\t\t\tvar value = localStorage.getItem(key);\n\t\t\tvar storedMessage = JSON.parse(value);\n\n\t\t\tvar wireMessage = new WireMessage(storedMessage.type, storedMessage);\n\n\t\t\tswitch(storedMessage.type) {\n\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\t// Replace the payload message with a Message object.\n\t\t\t\tvar hex = storedMessage.payloadMessage.payloadHex;\n\t\t\t\tvar buffer = new ArrayBuffer((hex.length)/2);\n\t\t\t\tvar byteStream = new Uint8Array(buffer);\n\t\t\t\tvar i = 0;\n\t\t\t\twhile (hex.length >= 2) {\n\t\t\t\t\tvar x = parseInt(hex.substring(0, 2), 16);\n\t\t\t\t\thex = hex.substring(2, hex.length);\n\t\t\t\t\tbyteStream[i++] = x;\n\t\t\t\t}\n\t\t\t\tvar payloadMessage = new Message(byteStream);\n\n\t\t\t\tpayloadMessage.qos = storedMessage.payloadMessage.qos;\n\t\t\t\tpayloadMessage.destinationName = storedMessage.payloadMessage.destinationName;\n\t\t\t\tif (storedMessage.payloadMessage.duplicate)\n\t\t\t\t\tpayloadMessage.duplicate = true;\n\t\t\t\tif (storedMessage.payloadMessage.retained)\n\t\t\t\t\tpayloadMessage.retained = true;\n\t\t\t\twireMessage.payloadMessage = payloadMessage;\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow Error(format(ERROR.INVALID_STORED_DATA, [key, value]));\n\t\t\t}\n\n\t\t\tif (key.indexOf(\"Sent:\"+this._localKey) === 0) {\n\t\t\t\twireMessage.payloadMessage.duplicate = true;\n\t\t\t\tthis._sentMessages[wireMessage.messageIdentifier] = wireMessage;\n\t\t\t} else if (key.indexOf(\"Received:\"+this._localKey) === 0) {\n\t\t\t\tthis._receivedMessages[wireMessage.messageIdentifier] = wireMessage;\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype._process_queue = function () {\n\t\t\tvar message = null;\n\n\t\t\t// Send all queued messages down socket connection\n\t\t\twhile ((message = this._msg_queue.pop())) {\n\t\t\t\tthis._socket_send(message);\n\t\t\t\t// Notify listeners that message was successfully sent\n\t\t\t\tif (this._notify_msg_sent[message]) {\n\t\t\t\t\tthis._notify_msg_sent[message]();\n\t\t\t\t\tdelete this._notify_msg_sent[message];\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Expect an ACK response for this message. Add message to the set of in progress\n\t * messages and set an unused identifier in this message.\n\t * @ignore\n\t */\n\t\tClientImpl.prototype._requires_ack = function (wireMessage) {\n\t\t\tvar messageCount = Object.keys(this._sentMessages).length;\n\t\t\tif (messageCount > this.maxMessageIdentifier)\n\t\t\t\tthrow Error (\"Too many messages:\"+messageCount);\n\n\t\t\twhile(this._sentMessages[this._message_identifier] !== undefined) {\n\t\t\t\tthis._message_identifier++;\n\t\t\t}\n\t\t\twireMessage.messageIdentifier = this._message_identifier;\n\t\t\tthis._sentMessages[wireMessage.messageIdentifier] = wireMessage;\n\t\t\tif (wireMessage.type === MESSAGE_TYPE.PUBLISH) {\n\t\t\t\tthis.store(\"Sent:\", wireMessage);\n\t\t\t}\n\t\t\tif (this._message_identifier === this.maxMessageIdentifier) {\n\t\t\t\tthis._message_identifier = 1;\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Called when the underlying websocket has been opened.\n\t * @ignore\n\t */\n\t\tClientImpl.prototype._on_socket_open = function () {\n\t\t// Create the CONNECT message object.\n\t\t\tvar wireMessage = new WireMessage(MESSAGE_TYPE.CONNECT, this.connectOptions);\n\t\t\twireMessage.clientId = this.clientId;\n\t\t\tthis._socket_send(wireMessage);\n\t\t};\n\n\t\t/**\n\t * Called when the underlying websocket has received a complete packet.\n\t * @ignore\n\t */\n\t\tClientImpl.prototype._on_socket_message = function (event) {\n\t\t\tthis._trace(\"Client._on_socket_message\", event.data);\n\t\t\tvar messages = this._deframeMessages(event.data);\n\t\t\tfor (var i = 0; i < messages.length; i+=1) {\n\t\t\t\tthis._handleMessage(messages[i]);\n\t\t\t}\n\t\t};\n\n\t\tClientImpl.prototype._deframeMessages = function(data) {\n\t\t\tvar byteArray = new Uint8Array(data);\n\t\t\tvar messages = [];\n\t\t\tif (this.receiveBuffer) {\n\t\t\t\tvar newData = new Uint8Array(this.receiveBuffer.length+byteArray.length);\n\t\t\t\tnewData.set(this.receiveBuffer);\n\t\t\t\tnewData.set(byteArray,this.receiveBuffer.length);\n\t\t\t\tbyteArray = newData;\n\t\t\t\tdelete this.receiveBuffer;\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tvar offset = 0;\n\t\t\t\twhile(offset < byteArray.length) {\n\t\t\t\t\tvar result = decodeMessage(byteArray,offset);\n\t\t\t\t\tvar wireMessage = result[0];\n\t\t\t\t\toffset = result[1];\n\t\t\t\t\tif (wireMessage !== null) {\n\t\t\t\t\t\tmessages.push(wireMessage);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (offset < byteArray.length) {\n\t\t\t\t\tthis.receiveBuffer = byteArray.subarray(offset);\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tvar errorStack = ((error.hasOwnProperty(\"stack\") == \"undefined\") ? error.stack.toString() : \"No Error Stack Available\");\n\t\t\t\tthis._disconnected(ERROR.INTERNAL_ERROR.code , format(ERROR.INTERNAL_ERROR, [error.message,errorStack]));\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn messages;\n\t\t};\n\n\t\tClientImpl.prototype._handleMessage = function(wireMessage) {\n\n\t\t\tthis._trace(\"Client._handleMessage\", wireMessage);\n\n\t\t\ttry {\n\t\t\t\tswitch(wireMessage.type) {\n\t\t\t\tcase MESSAGE_TYPE.CONNACK:\n\t\t\t\t\tthis._connectTimeout.cancel();\n\t\t\t\t\tif (this._reconnectTimeout)\n\t\t\t\t\t\tthis._reconnectTimeout.cancel();\n\n\t\t\t\t\t// If we have started using clean session then clear up the local state.\n\t\t\t\t\tif (this.connectOptions.cleanSession) {\n\t\t\t\t\t\tfor (var key in this._sentMessages) {\n\t\t\t\t\t\t\tvar sentMessage = this._sentMessages[key];\n\t\t\t\t\t\t\tlocalStorage.removeItem(\"Sent:\"+this._localKey+sentMessage.messageIdentifier);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._sentMessages = {};\n\n\t\t\t\t\t\tfor (var key in this._receivedMessages) {\n\t\t\t\t\t\t\tvar receivedMessage = this._receivedMessages[key];\n\t\t\t\t\t\t\tlocalStorage.removeItem(\"Received:\"+this._localKey+receivedMessage.messageIdentifier);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._receivedMessages = {};\n\t\t\t\t\t}\n\t\t\t\t\t// Client connected and ready for business.\n\t\t\t\t\tif (wireMessage.returnCode === 0) {\n\n\t\t\t\t\t\tthis.connected = true;\n\t\t\t\t\t\t// Jump to the end of the list of uris and stop looking for a good host.\n\n\t\t\t\t\t\tif (this.connectOptions.uris)\n\t\t\t\t\t\t\tthis.hostIndex = this.connectOptions.uris.length;\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._disconnected(ERROR.CONNACK_RETURNCODE.code , format(ERROR.CONNACK_RETURNCODE, [wireMessage.returnCode, CONNACK_RC[wireMessage.returnCode]]));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Resend messages.\n\t\t\t\t\tvar sequencedMessages = [];\n\t\t\t\t\tfor (var msgId in this._sentMessages) {\n\t\t\t\t\t\tif (this._sentMessages.hasOwnProperty(msgId))\n\t\t\t\t\t\t\tsequencedMessages.push(this._sentMessages[msgId]);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Also schedule qos 0 buffered messages if any\n\t\t\t\t\tif (this._buffered_msg_queue.length > 0) {\n\t\t\t\t\t\tvar msg = null;\n\t\t\t\t\t\twhile ((msg = this._buffered_msg_queue.pop())) {\n\t\t\t\t\t\t\tsequencedMessages.push(msg);\n\t\t\t\t\t\t\tif (this.onMessageDelivered)\n\t\t\t\t\t\t\t\tthis._notify_msg_sent[msg] = this.onMessageDelivered(msg.payloadMessage);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Sort sentMessages into the original sent order.\n\t\t\t\t\tvar sequencedMessages = sequencedMessages.sort(function(a,b) {return a.sequence - b.sequence;} );\n\t\t\t\t\tfor (var i=0, len=sequencedMessages.length; i<len; i++) {\n\t\t\t\t\t\tvar sentMessage = sequencedMessages[i];\n\t\t\t\t\t\tif (sentMessage.type == MESSAGE_TYPE.PUBLISH && sentMessage.pubRecReceived) {\n\t\t\t\t\t\t\tvar pubRelMessage = new WireMessage(MESSAGE_TYPE.PUBREL, {messageIdentifier:sentMessage.messageIdentifier});\n\t\t\t\t\t\t\tthis._schedule_message(pubRelMessage);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._schedule_message(sentMessage);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Execute the connectOptions.onSuccess callback if there is one.\n\t\t\t\t\t// Will also now return if this connection was the result of an automatic\n\t\t\t\t\t// reconnect and which URI was successfully connected to.\n\t\t\t\t\tif (this.connectOptions.onSuccess) {\n\t\t\t\t\t\tthis.connectOptions.onSuccess({invocationContext:this.connectOptions.invocationContext});\n\t\t\t\t\t}\n\n\t\t\t\t\tvar reconnected = false;\n\t\t\t\t\tif (this._reconnecting) {\n\t\t\t\t\t\treconnected = true;\n\t\t\t\t\t\tthis._reconnectInterval = 1;\n\t\t\t\t\t\tthis._reconnecting = false;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Execute the onConnected callback if there is one.\n\t\t\t\t\tthis._connected(reconnected, this._wsuri);\n\n\t\t\t\t\t// Process all queued messages now that the connection is established.\n\t\t\t\t\tthis._process_queue();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBLISH:\n\t\t\t\t\tthis._receivePublish(wireMessage);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBACK:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t// If this is a re flow of a PUBACK after we have restarted receivedMessage will not exist.\n\t\t\t\t\tif (sentMessage) {\n\t\t\t\t\t\tdelete this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t\tlocalStorage.removeItem(\"Sent:\"+this._localKey+wireMessage.messageIdentifier);\n\t\t\t\t\t\tif (this.onMessageDelivered)\n\t\t\t\t\t\t\tthis.onMessageDelivered(sentMessage.payloadMessage);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBREC:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t// If this is a re flow of a PUBREC after we have restarted receivedMessage will not exist.\n\t\t\t\t\tif (sentMessage) {\n\t\t\t\t\t\tsentMessage.pubRecReceived = true;\n\t\t\t\t\t\tvar pubRelMessage = new WireMessage(MESSAGE_TYPE.PUBREL, {messageIdentifier:wireMessage.messageIdentifier});\n\t\t\t\t\t\tthis.store(\"Sent:\", sentMessage);\n\t\t\t\t\t\tthis._schedule_message(pubRelMessage);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBREL:\n\t\t\t\t\tvar receivedMessage = this._receivedMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tlocalStorage.removeItem(\"Received:\"+this._localKey+wireMessage.messageIdentifier);\n\t\t\t\t\t// If this is a re flow of a PUBREL after we have restarted receivedMessage will not exist.\n\t\t\t\t\tif (receivedMessage) {\n\t\t\t\t\t\tthis._receiveMessage(receivedMessage);\n\t\t\t\t\t\tdelete this._receivedMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t}\n\t\t\t\t\t// Always flow PubComp, we may have previously flowed PubComp but the server lost it and restarted.\n\t\t\t\t\tvar pubCompMessage = new WireMessage(MESSAGE_TYPE.PUBCOMP, {messageIdentifier:wireMessage.messageIdentifier});\n\t\t\t\t\tthis._schedule_message(pubCompMessage);\n\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PUBCOMP:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tdelete this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tlocalStorage.removeItem(\"Sent:\"+this._localKey+wireMessage.messageIdentifier);\n\t\t\t\t\tif (this.onMessageDelivered)\n\t\t\t\t\t\tthis.onMessageDelivered(sentMessage.payloadMessage);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.SUBACK:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tif (sentMessage) {\n\t\t\t\t\t\tif(sentMessage.timeOut)\n\t\t\t\t\t\t\tsentMessage.timeOut.cancel();\n\t\t\t\t\t\t// This will need to be fixed when we add multiple topic support\n\t\t\t\t\t\tif (wireMessage.returnCode[0] === 0x80) {\n\t\t\t\t\t\t\tif (sentMessage.onFailure) {\n\t\t\t\t\t\t\t\tsentMessage.onFailure(wireMessage.returnCode);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (sentMessage.onSuccess) {\n\t\t\t\t\t\t\tsentMessage.onSuccess(wireMessage.returnCode);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdelete this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.UNSUBACK:\n\t\t\t\t\tvar sentMessage = this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\tif (sentMessage) {\n\t\t\t\t\t\tif (sentMessage.timeOut)\n\t\t\t\t\t\t\tsentMessage.timeOut.cancel();\n\t\t\t\t\t\tif (sentMessage.callback) {\n\t\t\t\t\t\t\tsentMessage.callback();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdelete this._sentMessages[wireMessage.messageIdentifier];\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.PINGRESP:\n\t\t\t\t/* The sendPinger or receivePinger may have sent a ping, the receivePinger has already been reset. */\n\t\t\t\t\tthis.sendPinger.reset();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MESSAGE_TYPE.DISCONNECT:\n\t\t\t\t// Clients do not expect to receive disconnect packets.\n\t\t\t\t\tthis._disconnected(ERROR.INVALID_MQTT_MESSAGE_TYPE.code , format(ERROR.INVALID_MQTT_MESSAGE_TYPE, [wireMessage.type]));\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthis._disconnected(ERROR.INVALID_MQTT_MESSAGE_TYPE.code , format(ERROR.INVALID_MQTT_MESSAGE_TYPE, [wireMessage.type]));\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tvar errorStack = ((error.hasOwnProperty(\"stack\") == \"undefined\") ? error.stack.toString() : \"No Error Stack Available\");\n\t\t\t\tthis._disconnected(ERROR.INTERNAL_ERROR.code , format(ERROR.INTERNAL_ERROR, [error.message,errorStack]));\n\t\t\t\treturn;\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._on_socket_error = function (error) {\n\t\t\tif (!this._reconnecting) {\n\t\t\t\tthis._disconnected(ERROR.SOCKET_ERROR.code , format(ERROR.SOCKET_ERROR, [error.data]));\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._on_socket_close = function () {\n\t\t\tif (!this._reconnecting) {\n\t\t\t\tthis._disconnected(ERROR.SOCKET_CLOSE.code , format(ERROR.SOCKET_CLOSE));\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._socket_send = function (wireMessage) {\n\n\t\t\tif (wireMessage.type == 1) {\n\t\t\t\tvar wireMessageMasked = this._traceMask(wireMessage, \"password\");\n\t\t\t\tthis._trace(\"Client._socket_send\", wireMessageMasked);\n\t\t\t}\n\t\t\telse this._trace(\"Client._socket_send\", wireMessage);\n\n\t\t\tthis.socket.send(wireMessage.encode());\n\t\t\t/* We have proved to the server we are alive. */\n\t\t\tthis.sendPinger.reset();\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._receivePublish = function (wireMessage) {\n\t\t\tswitch(wireMessage.payloadMessage.qos) {\n\t\t\tcase \"undefined\":\n\t\t\tcase 0:\n\t\t\t\tthis._receiveMessage(wireMessage);\n\t\t\t\tbreak;\n\n\t\t\tcase 1:\n\t\t\t\tvar pubAckMessage = new WireMessage(MESSAGE_TYPE.PUBACK, {messageIdentifier:wireMessage.messageIdentifier});\n\t\t\t\tthis._schedule_message(pubAckMessage);\n\t\t\t\tthis._receiveMessage(wireMessage);\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\n\t\t\t\tthis._receivedMessages[wireMessage.messageIdentifier] = wireMessage;\n\t\t\t\tthis.store(\"Received:\", wireMessage);\n\t\t\t\tvar pubRecMessage = new WireMessage(MESSAGE_TYPE.PUBREC, {messageIdentifier:wireMessage.messageIdentifier});\n\t\t\t\tthis._schedule_message(pubRecMessage);\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow Error(\"Invaild qos=\" + wireMessage.payloadMessage.qos);\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._receiveMessage = function (wireMessage) {\n\t\t\tif (this.onMessageArrived) {\n\t\t\t\tthis.onMessageArrived(wireMessage.payloadMessage);\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Client has connected.\n\t * @param {reconnect} [boolean] indicate if this was a result of reconnect operation.\n\t * @param {uri} [string] fully qualified WebSocket URI of the server.\n\t */\n\t\tClientImpl.prototype._connected = function (reconnect, uri) {\n\t\t// Execute the onConnected callback if there is one.\n\t\t\tif (this.onConnected)\n\t\t\t\tthis.onConnected(reconnect, uri);\n\t\t};\n\n\t\t/**\n\t * Attempts to reconnect the client to the server.\n   * For each reconnect attempt, will double the reconnect interval\n   * up to 128 seconds.\n\t */\n\t\tClientImpl.prototype._reconnect = function () {\n\t\t\tthis._trace(\"Client._reconnect\");\n\t\t\tif (!this.connected) {\n\t\t\t\tthis._reconnecting = true;\n\t\t\t\tthis.sendPinger.cancel();\n\t\t\t\tthis.receivePinger.cancel();\n\t\t\t\tif (this._reconnectInterval < 128)\n\t\t\t\t\tthis._reconnectInterval = this._reconnectInterval * 2;\n\t\t\t\tif (this.connectOptions.uris) {\n\t\t\t\t\tthis.hostIndex = 0;\n\t\t\t\t\tthis._doConnect(this.connectOptions.uris[0]);\n\t\t\t\t} else {\n\t\t\t\t\tthis._doConnect(this.uri);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t * Client has disconnected either at its own request or because the server\n\t * or network disconnected it. Remove all non-durable state.\n\t * @param {errorCode} [number] the error number.\n\t * @param {errorText} [string] the error text.\n\t * @ignore\n\t */\n\t\tClientImpl.prototype._disconnected = function (errorCode, errorText) {\n\t\t\tthis._trace(\"Client._disconnected\", errorCode, errorText);\n\n\t\t\tif (errorCode !== undefined && this._reconnecting) {\n\t\t\t\t//Continue automatic reconnect process\n\t\t\t\tthis._reconnectTimeout = new Timeout(this, this._reconnectInterval, this._reconnect);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.sendPinger.cancel();\n\t\t\tthis.receivePinger.cancel();\n\t\t\tif (this._connectTimeout) {\n\t\t\t\tthis._connectTimeout.cancel();\n\t\t\t\tthis._connectTimeout = null;\n\t\t\t}\n\n\t\t\t// Clear message buffers.\n\t\t\tthis._msg_queue = [];\n\t\t\tthis._buffered_msg_queue = [];\n\t\t\tthis._notify_msg_sent = {};\n\n\t\t\tif (this.socket) {\n\t\t\t// Cancel all socket callbacks so that they cannot be driven again by this socket.\n\t\t\t\tthis.socket.onopen = null;\n\t\t\t\tthis.socket.onmessage = null;\n\t\t\t\tthis.socket.onerror = null;\n\t\t\t\tthis.socket.onclose = null;\n\t\t\t\tif (this.socket.readyState === 1)\n\t\t\t\t\tthis.socket.close();\n\t\t\t\tdelete this.socket;\n\t\t\t}\n\n\t\t\tif (this.connectOptions.uris && this.hostIndex < this.connectOptions.uris.length-1) {\n\t\t\t// Try the next host.\n\t\t\t\tthis.hostIndex++;\n\t\t\t\tthis._doConnect(this.connectOptions.uris[this.hostIndex]);\n\t\t\t} else {\n\n\t\t\t\tif (errorCode === undefined) {\n\t\t\t\t\terrorCode = ERROR.OK.code;\n\t\t\t\t\terrorText = format(ERROR.OK);\n\t\t\t\t}\n\n\t\t\t\t// Run any application callbacks last as they may attempt to reconnect and hence create a new socket.\n\t\t\t\tif (this.connected) {\n\t\t\t\t\tthis.connected = false;\n\t\t\t\t\t// Execute the connectionLostCallback if there is one, and we were connected.\n\t\t\t\t\tif (this.onConnectionLost) {\n\t\t\t\t\t\tthis.onConnectionLost({errorCode:errorCode, errorMessage:errorText, reconnect:this.connectOptions.reconnect, uri:this._wsuri});\n\t\t\t\t\t}\n\t\t\t\t\tif (errorCode !== ERROR.OK.code && this.connectOptions.reconnect) {\n\t\t\t\t\t// Start automatic reconnect process for the very first time since last successful connect.\n\t\t\t\t\t\tthis._reconnectInterval = 1;\n\t\t\t\t\t\tthis._reconnect();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t// Otherwise we never had a connection, so indicate that the connect has failed.\n\t\t\t\t\tif (this.connectOptions.mqttVersion === 4 && this.connectOptions.mqttVersionExplicit === false) {\n\t\t\t\t\t\tthis._trace(\"Failed to connect V4, dropping back to V3\");\n\t\t\t\t\t\tthis.connectOptions.mqttVersion = 3;\n\t\t\t\t\t\tif (this.connectOptions.uris) {\n\t\t\t\t\t\t\tthis.hostIndex = 0;\n\t\t\t\t\t\t\tthis._doConnect(this.connectOptions.uris[0]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._doConnect(this.uri);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if(this.connectOptions.onFailure) {\n\t\t\t\t\t\tthis.connectOptions.onFailure({invocationContext:this.connectOptions.invocationContext, errorCode:errorCode, errorMessage:errorText});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._trace = function () {\n\t\t// Pass trace message back to client's callback function\n\t\t\tif (this.traceFunction) {\n\t\t\t\tvar args = Array.prototype.slice.call(arguments);\n\t\t\t\tfor (var i in args)\n\t\t\t\t{\n\t\t\t\t\tif (typeof args[i] !== \"undefined\")\n\t\t\t\t\t\targs.splice(i, 1, JSON.stringify(args[i]));\n\t\t\t\t}\n\t\t\t\tvar record = args.join(\"\");\n\t\t\t\tthis.traceFunction ({severity: \"Debug\", message: record\t});\n\t\t\t}\n\n\t\t\t//buffer style trace\n\t\t\tif ( this._traceBuffer !== null ) {\n\t\t\t\tfor (var i = 0, max = arguments.length; i < max; i++) {\n\t\t\t\t\tif ( this._traceBuffer.length == this._MAX_TRACE_ENTRIES ) {\n\t\t\t\t\t\tthis._traceBuffer.shift();\n\t\t\t\t\t}\n\t\t\t\t\tif (i === 0) this._traceBuffer.push(arguments[i]);\n\t\t\t\t\telse if (typeof arguments[i] === \"undefined\" ) this._traceBuffer.push(arguments[i]);\n\t\t\t\t\telse this._traceBuffer.push(\"  \"+JSON.stringify(arguments[i]));\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/** @ignore */\n\t\tClientImpl.prototype._traceMask = function (traceObject, masked) {\n\t\t\tvar traceObjectMasked = {};\n\t\t\tfor (var attr in traceObject) {\n\t\t\t\tif (traceObject.hasOwnProperty(attr)) {\n\t\t\t\t\tif (attr == masked)\n\t\t\t\t\t\ttraceObjectMasked[attr] = \"******\";\n\t\t\t\t\telse\n\t\t\t\t\t\ttraceObjectMasked[attr] = traceObject[attr];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn traceObjectMasked;\n\t\t};\n\n\t\t// ------------------------------------------------------------------------\n\t\t// Public Programming interface.\n\t\t// ------------------------------------------------------------------------\n\n\t\t/**\n\t * The JavaScript application communicates to the server using a {@link Paho.Client} object.\n\t * <p>\n\t * Most applications will create just one Client object and then call its connect() method,\n\t * however applications can create more than one Client object if they wish.\n\t * In this case the combination of host, port and clientId attributes must be different for each Client object.\n\t * <p>\n\t * The send, subscribe and unsubscribe methods are implemented as asynchronous JavaScript methods\n\t * (even though the underlying protocol exchange might be synchronous in nature).\n\t * This means they signal their completion by calling back to the application,\n\t * via Success or Failure callback functions provided by the application on the method in question.\n\t * Such callbacks are called at most once per method invocation and do not persist beyond the lifetime\n\t * of the script that made the invocation.\n\t * <p>\n\t * In contrast there are some callback functions, most notably <i>onMessageArrived</i>,\n\t * that are defined on the {@link Paho.Client} object.\n\t * These may get called multiple times, and aren't directly related to specific method invocations made by the client.\n\t *\n\t * @name Paho.Client\n\t *\n\t * @constructor\n\t *\n\t * @param {string} host - the address of the messaging server, as a fully qualified WebSocket URI, as a DNS name or dotted decimal IP address.\n\t * @param {number} port - the port number to connect to - only required if host is not a URI\n\t * @param {string} path - the path on the host to connect to - only used if host is not a URI. Default: '/mqtt'.\n\t * @param {string} clientId - the Messaging client identifier, between 1 and 23 characters in length.\n\t *\n\t * @property {string} host - <i>read only</i> the server's DNS hostname or dotted decimal IP address.\n\t * @property {number} port - <i>read only</i> the server's port.\n\t * @property {string} path - <i>read only</i> the server's path.\n\t * @property {string} clientId - <i>read only</i> used when connecting to the server.\n\t * @property {function} onConnectionLost - called when a connection has been lost.\n\t *                            after a connect() method has succeeded.\n\t *                            Establish the call back used when a connection has been lost. The connection may be\n\t *                            lost because the client initiates a disconnect or because the server or network\n\t *                            cause the client to be disconnected. The disconnect call back may be called without\n\t *                            the connectionComplete call back being invoked if, for example the client fails to\n\t *                            connect.\n\t *                            A single response object parameter is passed to the onConnectionLost callback containing the following fields:\n\t *                            <ol>\n\t *                            <li>errorCode\n\t *                            <li>errorMessage\n\t *                            </ol>\n\t * @property {function} onMessageDelivered - called when a message has been delivered.\n\t *                            All processing that this Client will ever do has been completed. So, for example,\n\t *                            in the case of a Qos=2 message sent by this client, the PubComp flow has been received from the server\n\t *                            and the message has been removed from persistent storage before this callback is invoked.\n\t *                            Parameters passed to the onMessageDelivered callback are:\n\t *                            <ol>\n\t *                            <li>{@link Paho.Message} that was delivered.\n\t *                            </ol>\n\t * @property {function} onMessageArrived - called when a message has arrived in this Paho.client.\n\t *                            Parameters passed to the onMessageArrived callback are:\n\t *                            <ol>\n\t *                            <li>{@link Paho.Message} that has arrived.\n\t *                            </ol>\n\t * @property {function} onConnected - called when a connection is successfully made to the server.\n\t *                                  after a connect() method.\n\t *                                  Parameters passed to the onConnected callback are:\n\t *                                  <ol>\n\t *                                  <li>reconnect (boolean) - If true, the connection was the result of a reconnect.</li>\n\t *                                  <li>URI (string) - The URI used to connect to the server.</li>\n\t *                                  </ol>\n\t * @property {boolean} disconnectedPublishing - if set, will enable disconnected publishing in\n\t *                                            in the event that the connection to the server is lost.\n\t * @property {number} disconnectedBufferSize - Used to set the maximum number of messages that the disconnected\n\t *                                             buffer will hold before rejecting new messages. Default size: 5000 messages\n\t * @property {function} trace - called whenever trace is called. TODO\n\t */\n\t\tvar Client = function (host, port, path, clientId) {\n\n\t\t\tvar uri;\n\n\t\t\tif (typeof host !== \"string\")\n\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof host, \"host\"]));\n\n\t\t\tif (arguments.length == 2) {\n\t\t\t// host: must be full ws:// uri\n\t\t\t// port: clientId\n\t\t\t\tclientId = port;\n\t\t\t\turi = host;\n\t\t\t\tvar match = uri.match(/^(wss?):\\/\\/((\\[(.+)\\])|([^\\/]+?))(:(\\d+))?(\\/.*)$/);\n\t\t\t\tif (match) {\n\t\t\t\t\thost = match[4]||match[2];\n\t\t\t\t\tport = parseInt(match[7]);\n\t\t\t\t\tpath = match[8];\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT,[host,\"host\"]));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (arguments.length == 3) {\n\t\t\t\t\tclientId = path;\n\t\t\t\t\tpath = \"/mqtt\";\n\t\t\t\t}\n\t\t\t\tif (typeof port !== \"number\" || port < 0)\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof port, \"port\"]));\n\t\t\t\tif (typeof path !== \"string\")\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof path, \"path\"]));\n\n\t\t\t\tvar ipv6AddSBracket = (host.indexOf(\":\") !== -1 && host.slice(0,1) !== \"[\" && host.slice(-1) !== \"]\");\n\t\t\t\turi = \"ws://\"+(ipv6AddSBracket?\"[\"+host+\"]\":host)+\":\"+port+path;\n\t\t\t}\n\n\t\t\tvar clientIdLength = 0;\n\t\t\tfor (var i = 0; i<clientId.length; i++) {\n\t\t\t\tvar charCode = clientId.charCodeAt(i);\n\t\t\t\tif (0xD800 <= charCode && charCode <= 0xDBFF)  {\n\t\t\t\t\ti++; // Surrogate pair.\n\t\t\t\t}\n\t\t\t\tclientIdLength++;\n\t\t\t}\n\t\t\tif (typeof clientId !== \"string\" || clientIdLength > 65535)\n\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [clientId, \"clientId\"]));\n\n\t\t\tvar client = new ClientImpl(uri, host, port, path, clientId);\n\n\t\t\t//Public Properties\n\t\t\tObject.defineProperties(this,{\n\t\t\t\t\"host\":{\n\t\t\t\t\tget: function() { return host; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"port\":{\n\t\t\t\t\tget: function() { return port; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"path\":{\n\t\t\t\t\tget: function() { return path; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"uri\":{\n\t\t\t\t\tget: function() { return uri; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"clientId\":{\n\t\t\t\t\tget: function() { return client.clientId; },\n\t\t\t\t\tset: function() { throw new Error(format(ERROR.UNSUPPORTED_OPERATION)); }\n\t\t\t\t},\n\t\t\t\t\"onConnected\":{\n\t\t\t\t\tget: function() { return client.onConnected; },\n\t\t\t\t\tset: function(newOnConnected) {\n\t\t\t\t\t\tif (typeof newOnConnected === \"function\")\n\t\t\t\t\t\t\tclient.onConnected = newOnConnected;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof newOnConnected, \"onConnected\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"disconnectedPublishing\":{\n\t\t\t\t\tget: function() { return client.disconnectedPublishing; },\n\t\t\t\t\tset: function(newDisconnectedPublishing) {\n\t\t\t\t\t\tclient.disconnectedPublishing = newDisconnectedPublishing;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"disconnectedBufferSize\":{\n\t\t\t\t\tget: function() { return client.disconnectedBufferSize; },\n\t\t\t\t\tset: function(newDisconnectedBufferSize) {\n\t\t\t\t\t\tclient.disconnectedBufferSize = newDisconnectedBufferSize;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"onConnectionLost\":{\n\t\t\t\t\tget: function() { return client.onConnectionLost; },\n\t\t\t\t\tset: function(newOnConnectionLost) {\n\t\t\t\t\t\tif (typeof newOnConnectionLost === \"function\")\n\t\t\t\t\t\t\tclient.onConnectionLost = newOnConnectionLost;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof newOnConnectionLost, \"onConnectionLost\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"onMessageDelivered\":{\n\t\t\t\t\tget: function() { return client.onMessageDelivered; },\n\t\t\t\t\tset: function(newOnMessageDelivered) {\n\t\t\t\t\t\tif (typeof newOnMessageDelivered === \"function\")\n\t\t\t\t\t\t\tclient.onMessageDelivered = newOnMessageDelivered;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof newOnMessageDelivered, \"onMessageDelivered\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"onMessageArrived\":{\n\t\t\t\t\tget: function() { return client.onMessageArrived; },\n\t\t\t\t\tset: function(newOnMessageArrived) {\n\t\t\t\t\t\tif (typeof newOnMessageArrived === \"function\")\n\t\t\t\t\t\t\tclient.onMessageArrived = newOnMessageArrived;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof newOnMessageArrived, \"onMessageArrived\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"trace\":{\n\t\t\t\t\tget: function() { return client.traceFunction; },\n\t\t\t\t\tset: function(trace) {\n\t\t\t\t\t\tif(typeof trace === \"function\"){\n\t\t\t\t\t\t\tclient.traceFunction = trace;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof trace, \"onTrace\"]));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\n\t\t\t/**\n\t\t * Connect this Messaging client to its server.\n\t\t *\n\t\t * @name Paho.Client#connect\n\t\t * @function\n\t\t * @param {object} connectOptions - Attributes used with the connection.\n\t\t * @param {number} connectOptions.timeout - If the connect has not succeeded within this\n\t\t *                    number of seconds, it is deemed to have failed.\n\t\t *                    The default is 30 seconds.\n\t\t * @param {string} connectOptions.userName - Authentication username for this connection.\n\t\t * @param {string} connectOptions.password - Authentication password for this connection.\n\t\t * @param {Paho.Message} connectOptions.willMessage - sent by the server when the client\n\t\t *                    disconnects abnormally.\n\t\t * @param {number} connectOptions.keepAliveInterval - the server disconnects this client if\n\t\t *                    there is no activity for this number of seconds.\n\t\t *                    The default value of 60 seconds is assumed if not set.\n\t\t * @param {boolean} connectOptions.cleanSession - if true(default) the client and server\n\t\t *                    persistent state is deleted on successful connect.\n\t\t * @param {boolean} connectOptions.useSSL - if present and true, use an SSL Websocket connection.\n\t\t * @param {object} connectOptions.invocationContext - passed to the onSuccess callback or onFailure callback.\n\t\t * @param {function} connectOptions.onSuccess - called when the connect acknowledgement\n\t\t *                    has been received from the server.\n\t\t * A single response object parameter is passed to the onSuccess callback containing the following fields:\n\t\t * <ol>\n\t\t * <li>invocationContext as passed in to the onSuccess method in the connectOptions.\n\t\t * </ol>\n\t * @param {function} connectOptions.onFailure - called when the connect request has failed or timed out.\n\t\t * A single response object parameter is passed to the onFailure callback containing the following fields:\n\t\t * <ol>\n\t\t * <li>invocationContext as passed in to the onFailure method in the connectOptions.\n\t\t * <li>errorCode a number indicating the nature of the error.\n\t\t * <li>errorMessage text describing the error.\n\t\t * </ol>\n\t * @param {array} connectOptions.hosts - If present this contains either a set of hostnames or fully qualified\n\t\t * WebSocket URIs (ws://iot.eclipse.org:80/ws), that are tried in order in place\n\t\t * of the host and port paramater on the construtor. The hosts are tried one at at time in order until\n\t\t * one of then succeeds.\n\t * @param {array} connectOptions.ports - If present the set of ports matching the hosts. If hosts contains URIs, this property\n\t\t * is not used.\n\t * @param {boolean} connectOptions.reconnect - Sets whether the client will automatically attempt to reconnect\n\t * to the server if the connection is lost.\n\t *<ul>\n\t *<li>If set to false, the client will not attempt to automatically reconnect to the server in the event that the\n\t * connection is lost.</li>\n\t *<li>If set to true, in the event that the connection is lost, the client will attempt to reconnect to the server.\n\t * It will initially wait 1 second before it attempts to reconnect, for every failed reconnect attempt, the delay\n\t * will double until it is at 2 minutes at which point the delay will stay at 2 minutes.</li>\n\t *</ul>\n\t * @param {number} connectOptions.mqttVersion - The version of MQTT to use to connect to the MQTT Broker.\n\t *<ul>\n\t *<li>3 - MQTT V3.1</li>\n\t *<li>4 - MQTT V3.1.1</li>\n\t *</ul>\n\t * @param {boolean} connectOptions.mqttVersionExplicit - If set to true, will force the connection to use the\n\t * selected MQTT Version or will fail to connect.\n\t * @param {array} connectOptions.uris - If present, should contain a list of fully qualified WebSocket uris\n\t * (e.g. ws://iot.eclipse.org:80/ws), that are tried in order in place of the host and port parameter of the construtor.\n\t * The uris are tried one at a time in order until one of them succeeds. Do not use this in conjunction with hosts as\n\t * the hosts array will be converted to uris and will overwrite this property.\n\t\t * @throws {InvalidState} If the client is not in disconnected state. The client must have received connectionLost\n\t\t * or disconnected before calling connect for a second or subsequent time.\n\t\t */\n\t\t\tthis.connect = function (connectOptions) {\n\t\t\t\tconnectOptions = connectOptions || {} ;\n\t\t\t\tvalidate(connectOptions,  {timeout:\"number\",\n\t\t\t\t\tuserName:\"string\",\n\t\t\t\t\tpassword:\"string\",\n\t\t\t\t\twillMessage:\"object\",\n\t\t\t\t\tkeepAliveInterval:\"number\",\n\t\t\t\t\tcleanSession:\"boolean\",\n\t\t\t\t\tuseSSL:\"boolean\",\n\t\t\t\t\tinvocationContext:\"object\",\n\t\t\t\t\tonSuccess:\"function\",\n\t\t\t\t\tonFailure:\"function\",\n\t\t\t\t\thosts:\"object\",\n\t\t\t\t\tports:\"object\",\n\t\t\t\t\treconnect:\"boolean\",\n\t\t\t\t\tmqttVersion:\"number\",\n\t\t\t\t\tmqttVersionExplicit:\"boolean\",\n\t\t\t\t\turis: \"object\"});\n\n\t\t\t\t// If no keep alive interval is set, assume 60 seconds.\n\t\t\t\tif (connectOptions.keepAliveInterval === undefined)\n\t\t\t\t\tconnectOptions.keepAliveInterval = 60;\n\n\t\t\t\tif (connectOptions.mqttVersion > 4 || connectOptions.mqttVersion < 3) {\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.mqttVersion, \"connectOptions.mqttVersion\"]));\n\t\t\t\t}\n\n\t\t\t\tif (connectOptions.mqttVersion === undefined) {\n\t\t\t\t\tconnectOptions.mqttVersionExplicit = false;\n\t\t\t\t\tconnectOptions.mqttVersion = 4;\n\t\t\t\t} else {\n\t\t\t\t\tconnectOptions.mqttVersionExplicit = true;\n\t\t\t\t}\n\n\t\t\t\t//Check that if password is set, so is username\n\t\t\t\tif (connectOptions.password !== undefined && connectOptions.userName === undefined)\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.password, \"connectOptions.password\"]));\n\n\t\t\t\tif (connectOptions.willMessage) {\n\t\t\t\t\tif (!(connectOptions.willMessage instanceof Message))\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [connectOptions.willMessage, \"connectOptions.willMessage\"]));\n\t\t\t\t\t// The will message must have a payload that can be represented as a string.\n\t\t\t\t\t// Cause the willMessage to throw an exception if this is not the case.\n\t\t\t\t\tconnectOptions.willMessage.stringPayload = null;\n\n\t\t\t\t\tif (typeof connectOptions.willMessage.destinationName === \"undefined\")\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof connectOptions.willMessage.destinationName, \"connectOptions.willMessage.destinationName\"]));\n\t\t\t\t}\n\t\t\t\tif (typeof connectOptions.cleanSession === \"undefined\")\n\t\t\t\t\tconnectOptions.cleanSession = true;\n\t\t\t\tif (connectOptions.hosts) {\n\n\t\t\t\t\tif (!(connectOptions.hosts instanceof Array) )\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts, \"connectOptions.hosts\"]));\n\t\t\t\t\tif (connectOptions.hosts.length <1 )\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts, \"connectOptions.hosts\"]));\n\n\t\t\t\t\tvar usingURIs = false;\n\t\t\t\t\tfor (var i = 0; i<connectOptions.hosts.length; i++) {\n\t\t\t\t\t\tif (typeof connectOptions.hosts[i] !== \"string\")\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof connectOptions.hosts[i], \"connectOptions.hosts[\"+i+\"]\"]));\n\t\t\t\t\t\tif (/^(wss?):\\/\\/((\\[(.+)\\])|([^\\/]+?))(:(\\d+))?(\\/.*)$/.test(connectOptions.hosts[i])) {\n\t\t\t\t\t\t\tif (i === 0) {\n\t\t\t\t\t\t\t\tusingURIs = true;\n\t\t\t\t\t\t\t} else if (!usingURIs) {\n\t\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts[i], \"connectOptions.hosts[\"+i+\"]\"]));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (usingURIs) {\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts[i], \"connectOptions.hosts[\"+i+\"]\"]));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!usingURIs) {\n\t\t\t\t\t\tif (!connectOptions.ports)\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.ports, \"connectOptions.ports\"]));\n\t\t\t\t\t\tif (!(connectOptions.ports instanceof Array) )\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.ports, \"connectOptions.ports\"]));\n\t\t\t\t\t\tif (connectOptions.hosts.length !== connectOptions.ports.length)\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.ports, \"connectOptions.ports\"]));\n\n\t\t\t\t\t\tconnectOptions.uris = [];\n\n\t\t\t\t\t\tfor (var i = 0; i<connectOptions.hosts.length; i++) {\n\t\t\t\t\t\t\tif (typeof connectOptions.ports[i] !== \"number\" || connectOptions.ports[i] < 0)\n\t\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_TYPE, [typeof connectOptions.ports[i], \"connectOptions.ports[\"+i+\"]\"]));\n\t\t\t\t\t\t\tvar host = connectOptions.hosts[i];\n\t\t\t\t\t\t\tvar port = connectOptions.ports[i];\n\n\t\t\t\t\t\t\tvar ipv6 = (host.indexOf(\":\") !== -1);\n\t\t\t\t\t\t\turi = \"ws://\"+(ipv6?\"[\"+host+\"]\":host)+\":\"+port+path;\n\t\t\t\t\t\t\tconnectOptions.uris.push(uri);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconnectOptions.uris = connectOptions.hosts;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tclient.connect(connectOptions);\n\t\t\t};\n\n\t\t\t/**\n\t\t * Subscribe for messages, request receipt of a copy of messages sent to the destinations described by the filter.\n\t\t *\n\t\t * @name Paho.Client#subscribe\n\t\t * @function\n\t\t * @param {string} filter describing the destinations to receive messages from.\n\t\t * <br>\n\t\t * @param {object} subscribeOptions - used to control the subscription\n\t\t *\n\t\t * @param {number} subscribeOptions.qos - the maximum qos of any publications sent\n\t\t *                                  as a result of making this subscription.\n\t\t * @param {object} subscribeOptions.invocationContext - passed to the onSuccess callback\n\t\t *                                  or onFailure callback.\n\t\t * @param {function} subscribeOptions.onSuccess - called when the subscribe acknowledgement\n\t\t *                                  has been received from the server.\n\t\t *                                  A single response object parameter is passed to the onSuccess callback containing the following fields:\n\t\t *                                  <ol>\n\t\t *                                  <li>invocationContext if set in the subscribeOptions.\n\t\t *                                  </ol>\n\t\t * @param {function} subscribeOptions.onFailure - called when the subscribe request has failed or timed out.\n\t\t *                                  A single response object parameter is passed to the onFailure callback containing the following fields:\n\t\t *                                  <ol>\n\t\t *                                  <li>invocationContext - if set in the subscribeOptions.\n\t\t *                                  <li>errorCode - a number indicating the nature of the error.\n\t\t *                                  <li>errorMessage - text describing the error.\n\t\t *                                  </ol>\n\t\t * @param {number} subscribeOptions.timeout - which, if present, determines the number of\n\t\t *                                  seconds after which the onFailure calback is called.\n\t\t *                                  The presence of a timeout does not prevent the onSuccess\n\t\t *                                  callback from being called when the subscribe completes.\n\t\t * @throws {InvalidState} if the client is not in connected state.\n\t\t */\n\t\t\tthis.subscribe = function (filter, subscribeOptions) {\n\t\t\t\tif (typeof filter !== \"string\" && filter.constructor !== Array)\n\t\t\t\t\tthrow new Error(\"Invalid argument:\"+filter);\n\t\t\t\tsubscribeOptions = subscribeOptions || {} ;\n\t\t\t\tvalidate(subscribeOptions,  {qos:\"number\",\n\t\t\t\t\tinvocationContext:\"object\",\n\t\t\t\t\tonSuccess:\"function\",\n\t\t\t\t\tonFailure:\"function\",\n\t\t\t\t\ttimeout:\"number\"\n\t\t\t\t});\n\t\t\t\tif (subscribeOptions.timeout && !subscribeOptions.onFailure)\n\t\t\t\t\tthrow new Error(\"subscribeOptions.timeout specified with no onFailure callback.\");\n\t\t\t\tif (typeof subscribeOptions.qos !== \"undefined\" && !(subscribeOptions.qos === 0 || subscribeOptions.qos === 1 || subscribeOptions.qos === 2 ))\n\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [subscribeOptions.qos, \"subscribeOptions.qos\"]));\n\t\t\t\tclient.subscribe(filter, subscribeOptions);\n\t\t\t};\n\n\t\t/**\n\t\t * Unsubscribe for messages, stop receiving messages sent to destinations described by the filter.\n\t\t *\n\t\t * @name Paho.Client#unsubscribe\n\t\t * @function\n\t\t * @param {string} filter - describing the destinations to receive messages from.\n\t\t * @param {object} unsubscribeOptions - used to control the subscription\n\t\t * @param {object} unsubscribeOptions.invocationContext - passed to the onSuccess callback\n\t\t\t\t\t\t\t\t\t\t\t  or onFailure callback.\n\t\t * @param {function} unsubscribeOptions.onSuccess - called when the unsubscribe acknowledgement has been received from the server.\n\t\t *                                    A single response object parameter is passed to the\n\t\t *                                    onSuccess callback containing the following fields:\n\t\t *                                    <ol>\n\t\t *                                    <li>invocationContext - if set in the unsubscribeOptions.\n\t\t *                                    </ol>\n\t\t * @param {function} unsubscribeOptions.onFailure called when the unsubscribe request has failed or timed out.\n\t\t *                                    A single response object parameter is passed to the onFailure callback containing the following fields:\n\t\t *                                    <ol>\n\t\t *                                    <li>invocationContext - if set in the unsubscribeOptions.\n\t\t *                                    <li>errorCode - a number indicating the nature of the error.\n\t\t *                                    <li>errorMessage - text describing the error.\n\t\t *                                    </ol>\n\t\t * @param {number} unsubscribeOptions.timeout - which, if present, determines the number of seconds\n\t\t *                                    after which the onFailure callback is called. The presence of\n\t\t *                                    a timeout does not prevent the onSuccess callback from being\n\t\t *                                    called when the unsubscribe completes\n\t\t * @throws {InvalidState} if the client is not in connected state.\n\t\t */\n\t\t\tthis.unsubscribe = function (filter, unsubscribeOptions) {\n\t\t\t\tif (typeof filter !== \"string\" && filter.constructor !== Array)\n\t\t\t\t\tthrow new Error(\"Invalid argument:\"+filter);\n\t\t\t\tunsubscribeOptions = unsubscribeOptions || {} ;\n\t\t\t\tvalidate(unsubscribeOptions,  {invocationContext:\"object\",\n\t\t\t\t\tonSuccess:\"function\",\n\t\t\t\t\tonFailure:\"function\",\n\t\t\t\t\ttimeout:\"number\"\n\t\t\t\t});\n\t\t\t\tif (unsubscribeOptions.timeout && !unsubscribeOptions.onFailure)\n\t\t\t\t\tthrow new Error(\"unsubscribeOptions.timeout specified with no onFailure callback.\");\n\t\t\t\tclient.unsubscribe(filter, unsubscribeOptions);\n\t\t\t};\n\n\t\t\t/**\n\t\t * Send a message to the consumers of the destination in the Message.\n\t\t *\n\t\t * @name Paho.Client#send\n\t\t * @function\n\t\t * @param {string|Paho.Message} topic - <b>mandatory</b> The name of the destination to which the message is to be sent.\n\t\t * \t\t\t\t\t   - If it is the only parameter, used as Paho.Message object.\n\t\t * @param {String|ArrayBuffer} payload - The message data to be sent.\n\t\t * @param {number} qos The Quality of Service used to deliver the message.\n\t\t * \t\t<dl>\n\t\t * \t\t\t<dt>0 Best effort (default).\n\t\t *     \t\t\t<dt>1 At least once.\n\t\t *     \t\t\t<dt>2 Exactly once.\n\t\t * \t\t</dl>\n\t\t * @param {Boolean} retained If true, the message is to be retained by the server and delivered\n\t\t *                     to both current and future subscriptions.\n\t\t *                     If false the server only delivers the message to current subscribers, this is the default for new Messages.\n\t\t *                     A received message has the retained boolean set to true if the message was published\n\t\t *                     with the retained boolean set to true\n\t\t *                     and the subscrption was made after the message has been published.\n\t\t * @throws {InvalidState} if the client is not connected.\n\t\t */\n\t\t\tthis.send = function (topic,payload,qos,retained) {\n\t\t\t\tvar message ;\n\n\t\t\t\tif(arguments.length === 0){\n\t\t\t\t\tthrow new Error(\"Invalid argument.\"+\"length\");\n\n\t\t\t\t}else if(arguments.length == 1) {\n\n\t\t\t\t\tif (!(topic instanceof Message) && (typeof topic !== \"string\"))\n\t\t\t\t\t\tthrow new Error(\"Invalid argument:\"+ typeof topic);\n\n\t\t\t\t\tmessage = topic;\n\t\t\t\t\tif (typeof message.destinationName === \"undefined\")\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT,[message.destinationName,\"Message.destinationName\"]));\n\t\t\t\t\tclient.send(message);\n\n\t\t\t\t}else {\n\t\t\t\t//parameter checking in Message object\n\t\t\t\t\tmessage = new Message(payload);\n\t\t\t\t\tmessage.destinationName = topic;\n\t\t\t\t\tif(arguments.length >= 3)\n\t\t\t\t\t\tmessage.qos = qos;\n\t\t\t\t\tif(arguments.length >= 4)\n\t\t\t\t\t\tmessage.retained = retained;\n\t\t\t\t\tclient.send(message);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t/**\n\t\t * Publish a message to the consumers of the destination in the Message.\n\t\t * Synonym for Paho.Mqtt.Client#send\n\t\t *\n\t\t * @name Paho.Client#publish\n\t\t * @function\n\t\t * @param {string|Paho.Message} topic - <b>mandatory</b> The name of the topic to which the message is to be published.\n\t\t * \t\t\t\t\t   - If it is the only parameter, used as Paho.Message object.\n\t\t * @param {String|ArrayBuffer} payload - The message data to be published.\n\t\t * @param {number} qos The Quality of Service used to deliver the message.\n\t\t * \t\t<dl>\n\t\t * \t\t\t<dt>0 Best effort (default).\n\t\t *     \t\t\t<dt>1 At least once.\n\t\t *     \t\t\t<dt>2 Exactly once.\n\t\t * \t\t</dl>\n\t\t * @param {Boolean} retained If true, the message is to be retained by the server and delivered\n\t\t *                     to both current and future subscriptions.\n\t\t *                     If false the server only delivers the message to current subscribers, this is the default for new Messages.\n\t\t *                     A received message has the retained boolean set to true if the message was published\n\t\t *                     with the retained boolean set to true\n\t\t *                     and the subscrption was made after the message has been published.\n\t\t * @throws {InvalidState} if the client is not connected.\n\t\t */\n\t\t\tthis.publish = function(topic,payload,qos,retained) {\n\t\t\t\tvar message ;\n\n\t\t\t\tif(arguments.length === 0){\n\t\t\t\t\tthrow new Error(\"Invalid argument.\"+\"length\");\n\n\t\t\t\t}else if(arguments.length == 1) {\n\n\t\t\t\t\tif (!(topic instanceof Message) && (typeof topic !== \"string\"))\n\t\t\t\t\t\tthrow new Error(\"Invalid argument:\"+ typeof topic);\n\n\t\t\t\t\tmessage = topic;\n\t\t\t\t\tif (typeof message.destinationName === \"undefined\")\n\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT,[message.destinationName,\"Message.destinationName\"]));\n\t\t\t\t\tclient.send(message);\n\n\t\t\t\t}else {\n\t\t\t\t\t//parameter checking in Message object\n\t\t\t\t\tmessage = new Message(payload);\n\t\t\t\t\tmessage.destinationName = topic;\n\t\t\t\t\tif(arguments.length >= 3)\n\t\t\t\t\t\tmessage.qos = qos;\n\t\t\t\t\tif(arguments.length >= 4)\n\t\t\t\t\t\tmessage.retained = retained;\n\t\t\t\t\tclient.send(message);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t/**\n\t\t * Normal disconnect of this Messaging client from its server.\n\t\t *\n\t\t * @name Paho.Client#disconnect\n\t\t * @function\n\t\t * @throws {InvalidState} if the client is already disconnected.\n\t\t */\n\t\t\tthis.disconnect = function () {\n\t\t\t\tclient.disconnect();\n\t\t\t};\n\n\t\t\t/**\n\t\t * Get the contents of the trace log.\n\t\t *\n\t\t * @name Paho.Client#getTraceLog\n\t\t * @function\n\t\t * @return {Object[]} tracebuffer containing the time ordered trace records.\n\t\t */\n\t\t\tthis.getTraceLog = function () {\n\t\t\t\treturn client.getTraceLog();\n\t\t\t};\n\n\t\t\t/**\n\t\t * Start tracing.\n\t\t *\n\t\t * @name Paho.Client#startTrace\n\t\t * @function\n\t\t */\n\t\t\tthis.startTrace = function () {\n\t\t\t\tclient.startTrace();\n\t\t\t};\n\n\t\t\t/**\n\t\t * Stop tracing.\n\t\t *\n\t\t * @name Paho.Client#stopTrace\n\t\t * @function\n\t\t */\n\t\t\tthis.stopTrace = function () {\n\t\t\t\tclient.stopTrace();\n\t\t\t};\n\n\t\t\tthis.isConnected = function() {\n\t\t\t\treturn client.connected;\n\t\t\t};\n\t\t};\n\n\t\t/**\n\t * An application message, sent or received.\n\t * <p>\n\t * All attributes may be null, which implies the default values.\n\t *\n\t * @name Paho.Message\n\t * @constructor\n\t * @param {String|ArrayBuffer} payload The message data to be sent.\n\t * <p>\n\t * @property {string} payloadString <i>read only</i> The payload as a string if the payload consists of valid UTF-8 characters.\n\t * @property {ArrayBuffer} payloadBytes <i>read only</i> The payload as an ArrayBuffer.\n\t * <p>\n\t * @property {string} destinationName <b>mandatory</b> The name of the destination to which the message is to be sent\n\t *                    (for messages about to be sent) or the name of the destination from which the message has been received.\n\t *                    (for messages received by the onMessage function).\n\t * <p>\n\t * @property {number} qos The Quality of Service used to deliver the message.\n\t * <dl>\n\t *     <dt>0 Best effort (default).\n\t *     <dt>1 At least once.\n\t *     <dt>2 Exactly once.\n\t * </dl>\n\t * <p>\n\t * @property {Boolean} retained If true, the message is to be retained by the server and delivered\n\t *                     to both current and future subscriptions.\n\t *                     If false the server only delivers the message to current subscribers, this is the default for new Messages.\n\t *                     A received message has the retained boolean set to true if the message was published\n\t *                     with the retained boolean set to true\n\t *                     and the subscrption was made after the message has been published.\n\t * <p>\n\t * @property {Boolean} duplicate <i>read only</i> If true, this message might be a duplicate of one which has already been received.\n\t *                     This is only set on messages received from the server.\n\t *\n\t */\n\t\tvar Message = function (newPayload) {\n\t\t\tvar payload;\n\t\t\tif (   typeof newPayload === \"string\" ||\n\t\tnewPayload instanceof ArrayBuffer ||\n\t\t(ArrayBuffer.isView(newPayload) && !(newPayload instanceof DataView))\n\t\t\t) {\n\t\t\t\tpayload = newPayload;\n\t\t\t} else {\n\t\t\t\tthrow (format(ERROR.INVALID_ARGUMENT, [newPayload, \"newPayload\"]));\n\t\t\t}\n\n\t\t\tvar destinationName;\n\t\t\tvar qos = 0;\n\t\t\tvar retained = false;\n\t\t\tvar duplicate = false;\n\n\t\t\tObject.defineProperties(this,{\n\t\t\t\t\"payloadString\":{\n\t\t\t\t\tenumerable : true,\n\t\t\t\t\tget : function () {\n\t\t\t\t\t\tif (typeof payload === \"string\")\n\t\t\t\t\t\t\treturn payload;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\treturn parseUTF8(payload, 0, payload.length);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"payloadBytes\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() {\n\t\t\t\t\t\tif (typeof payload === \"string\") {\n\t\t\t\t\t\t\tvar buffer = new ArrayBuffer(UTF8Length(payload));\n\t\t\t\t\t\t\tvar byteStream = new Uint8Array(buffer);\n\t\t\t\t\t\t\tstringToUTF8(payload, byteStream, 0);\n\n\t\t\t\t\t\t\treturn byteStream;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn payload;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"destinationName\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return destinationName; },\n\t\t\t\t\tset: function(newDestinationName) {\n\t\t\t\t\t\tif (typeof newDestinationName === \"string\")\n\t\t\t\t\t\t\tdestinationName = newDestinationName;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [newDestinationName, \"newDestinationName\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"qos\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return qos; },\n\t\t\t\t\tset: function(newQos) {\n\t\t\t\t\t\tif (newQos === 0 || newQos === 1 || newQos === 2 )\n\t\t\t\t\t\t\tqos = newQos;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(\"Invalid argument:\"+newQos);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"retained\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return retained; },\n\t\t\t\t\tset: function(newRetained) {\n\t\t\t\t\t\tif (typeof newRetained === \"boolean\")\n\t\t\t\t\t\t\tretained = newRetained;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthrow new Error(format(ERROR.INVALID_ARGUMENT, [newRetained, \"newRetained\"]));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"topic\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return destinationName; },\n\t\t\t\t\tset: function(newTopic) {destinationName=newTopic;}\n\t\t\t\t},\n\t\t\t\t\"duplicate\":{\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() { return duplicate; },\n\t\t\t\t\tset: function(newDuplicate) {duplicate=newDuplicate;}\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\t// Module contents.\n\t\treturn {\n\t\t\tClient: Client,\n\t\t\tMessage: Message\n\t\t};\n\t// eslint-disable-next-line no-nested-ternary\n\t})(typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {});\n\treturn PahoMQTT;\n});\n","/**\n * Assign properties from `props` to `obj`\n * @template O, P The obj and props types\n * @param {O} obj The object to copy properties to\n * @param {P} props The object to copy properties from\n * @returns {O & P}\n */\nexport function assign(obj, props) {\n\t// @ts-ignore We change the type of `obj` to be `O & P`\n\tfor (let i in props) obj[i] = props[i];\n\treturn /** @type {O & P} */ (obj);\n}\n\n/**\n * Remove a child node from its parent if attached. This is a workaround for\n * IE11 which doesn't support `Element.prototype.remove()`. Using this function\n * is smaller than including a dedicated polyfill.\n * @param {Node} node The node to remove\n */\nexport function removeNode(node) {\n\tlet parentNode = node.parentNode;\n\tif (parentNode) parentNode.removeChild(node);\n}\n","import options from './options';\n\n/**\n * Create an virtual node (used for JSX)\n * @param {import('./internal').VNode[\"type\"]} type The node name or Component\n * constructor for this virtual node\n * @param {object | null | undefined} [props] The properties of the virtual node\n * @param {Array<import('.').ComponentChildren>} [children] The children of the virtual node\n * @returns {import('./internal').VNode}\n */\nexport function createElement(type, props, children) {\n\tlet normalizedProps = {},\n\t\tkey,\n\t\tref,\n\t\ti;\n\tfor (i in props) {\n\t\tif (i == 'key') key = props[i];\n\t\telse if (i == 'ref') ref = props[i];\n\t\telse normalizedProps[i] = props[i];\n\t}\n\n\tif (arguments.length > 3) {\n\t\tchildren = [children];\n\t\t// https://github.com/preactjs/preact/issues/1916\n\t\tfor (i = 3; i < arguments.length; i++) {\n\t\t\tchildren.push(arguments[i]);\n\t\t}\n\t}\n\tif (children != null) {\n\t\tnormalizedProps.children = children;\n\t}\n\n\t// If a Component VNode, check for and apply defaultProps\n\t// Note: type may be undefined in development, must never error here.\n\tif (typeof type == 'function' && type.defaultProps != null) {\n\t\tfor (i in type.defaultProps) {\n\t\t\tif (normalizedProps[i] === undefined) {\n\t\t\t\tnormalizedProps[i] = type.defaultProps[i];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn createVNode(type, normalizedProps, key, ref, null);\n}\n\n/**\n * Create a VNode (used internally by Preact)\n * @param {import('./internal').VNode[\"type\"]} type The node name or Component\n * Constructor for this virtual node\n * @param {object | string | number | null} props The properties of this virtual node.\n * If this virtual node represents a text node, this is the text of the node (string or number).\n * @param {string | number | null} key The key for this virtual node, used when\n * diffing it against its children\n * @param {import('./internal').VNode[\"ref\"]} ref The ref property that will\n * receive a reference to its created child\n * @returns {import('./internal').VNode}\n */\nexport function createVNode(type, props, key, ref, original) {\n\t// V8 seems to be better at detecting type shapes if the object is allocated from the same call site\n\t// Do not inline into createElement and coerceToVNode!\n\tconst vnode = {\n\t\ttype,\n\t\tprops,\n\t\tkey,\n\t\tref,\n\t\t_children: null,\n\t\t_parent: null,\n\t\t_depth: 0,\n\t\t_dom: null,\n\t\t// _nextDom must be initialized to undefined b/c it will eventually\n\t\t// be set to dom.nextSibling which can return `null` and it is important\n\t\t// to be able to distinguish between an uninitialized _nextDom and\n\t\t// a _nextDom that has been set to `null`\n\t\t_nextDom: undefined,\n\t\t_component: null,\n\t\t_hydrating: null,\n\t\tconstructor: undefined,\n\t\t_original: original == null ? ++options._vnodeId : original\n\t};\n\n\tif (options.vnode != null) options.vnode(vnode);\n\n\treturn vnode;\n}\n\nexport function createRef() {\n\treturn { current: null };\n}\n\nexport function Fragment(props) {\n\treturn props.children;\n}\n\n/**\n * Check if a the argument is a valid Preact VNode.\n * @param {*} vnode\n * @returns {vnode is import('./internal').VNode}\n */\nexport const isValidElement = vnode =>\n\tvnode != null && vnode.constructor === undefined;\n","import { assign } from './util';\nimport { diff, commitRoot } from './diff/index';\nimport options from './options';\nimport { Fragment } from './create-element';\n\n/**\n * Base Component class. Provides `setState()` and `forceUpdate()`, which\n * trigger rendering\n * @param {object} props The initial component props\n * @param {object} context The initial context from parent components'\n * getChildContext\n */\nexport function Component(props, context) {\n\tthis.props = props;\n\tthis.context = context;\n}\n\n/**\n * Update component state and schedule a re-render.\n * @this {import('./internal').Component}\n * @param {object | ((s: object, p: object) => object)} update A hash of state\n * properties to update with new values or a function that given the current\n * state and props returns a new partial state\n * @param {() => void} [callback] A function to be called once component state is\n * updated\n */\nComponent.prototype.setState = function(update, callback) {\n\t// only clone state when copying to nextState the first time.\n\tlet s;\n\tif (this._nextState != null && this._nextState !== this.state) {\n\t\ts = this._nextState;\n\t} else {\n\t\ts = this._nextState = assign({}, this.state);\n\t}\n\n\tif (typeof update == 'function') {\n\t\t// Some libraries like `immer` mark the current state as readonly,\n\t\t// preventing us from mutating it, so we need to clone it. See #2716\n\t\tupdate = update(assign({}, s), this.props);\n\t}\n\n\tif (update) {\n\t\tassign(s, update);\n\t}\n\n\t// Skip update if updater function returned null\n\tif (update == null) return;\n\n\tif (this._vnode) {\n\t\tif (callback) this._renderCallbacks.push(callback);\n\t\tenqueueRender(this);\n\t}\n};\n\n/**\n * Immediately perform a synchronous re-render of the component\n * @this {import('./internal').Component}\n * @param {() => void} [callback] A function to be called after component is\n * re-rendered\n */\nComponent.prototype.forceUpdate = function(callback) {\n\tif (this._vnode) {\n\t\t// Set render mode so that we can differentiate where the render request\n\t\t// is coming from. We need this because forceUpdate should never call\n\t\t// shouldComponentUpdate\n\t\tthis._force = true;\n\t\tif (callback) this._renderCallbacks.push(callback);\n\t\tenqueueRender(this);\n\t}\n};\n\n/**\n * Accepts `props` and `state`, and returns a new Virtual DOM tree to build.\n * Virtual DOM is generally constructed via [JSX](http://jasonformat.com/wtf-is-jsx).\n * @param {object} props Props (eg: JSX attributes) received from parent\n * element/component\n * @param {object} state The component's current state\n * @param {object} context Context object, as returned by the nearest\n * ancestor's `getChildContext()`\n * @returns {import('./index').ComponentChildren | void}\n */\nComponent.prototype.render = Fragment;\n\n/**\n * @param {import('./internal').VNode} vnode\n * @param {number | null} [childIndex]\n */\nexport function getDomSibling(vnode, childIndex) {\n\tif (childIndex == null) {\n\t\t// Use childIndex==null as a signal to resume the search from the vnode's sibling\n\t\treturn vnode._parent\n\t\t\t? getDomSibling(vnode._parent, vnode._parent._children.indexOf(vnode) + 1)\n\t\t\t: null;\n\t}\n\n\tlet sibling;\n\tfor (; childIndex < vnode._children.length; childIndex++) {\n\t\tsibling = vnode._children[childIndex];\n\n\t\tif (sibling != null && sibling._dom != null) {\n\t\t\t// Since updateParentDomPointers keeps _dom pointer correct,\n\t\t\t// we can rely on _dom to tell us if this subtree contains a\n\t\t\t// rendered DOM node, and what the first rendered DOM node is\n\t\t\treturn sibling._dom;\n\t\t}\n\t}\n\n\t// If we get here, we have not found a DOM node in this vnode's children.\n\t// We must resume from this vnode's sibling (in it's parent _children array)\n\t// Only climb up and search the parent if we aren't searching through a DOM\n\t// VNode (meaning we reached the DOM parent of the original vnode that began\n\t// the search)\n\treturn typeof vnode.type == 'function' ? getDomSibling(vnode) : null;\n}\n\n/**\n * Trigger in-place re-rendering of a component.\n * @param {import('./internal').Component} component The component to rerender\n */\nfunction renderComponent(component) {\n\tlet vnode = component._vnode,\n\t\toldDom = vnode._dom,\n\t\tparentDom = component._parentDom;\n\n\tif (parentDom) {\n\t\tlet commitQueue = [];\n\t\tconst oldVNode = assign({}, vnode);\n\t\toldVNode._original = vnode._original + 1;\n\n\t\tdiff(\n\t\t\tparentDom,\n\t\t\tvnode,\n\t\t\toldVNode,\n\t\t\tcomponent._globalContext,\n\t\t\tparentDom.ownerSVGElement !== undefined,\n\t\t\tvnode._hydrating != null ? [oldDom] : null,\n\t\t\tcommitQueue,\n\t\t\toldDom == null ? getDomSibling(vnode) : oldDom,\n\t\t\tvnode._hydrating\n\t\t);\n\t\tcommitRoot(commitQueue, vnode);\n\n\t\tif (vnode._dom != oldDom) {\n\t\t\tupdateParentDomPointers(vnode);\n\t\t}\n\t}\n}\n\n/**\n * @param {import('./internal').VNode} vnode\n */\nfunction updateParentDomPointers(vnode) {\n\tif ((vnode = vnode._parent) != null && vnode._component != null) {\n\t\tvnode._dom = vnode._component.base = null;\n\t\tfor (let i = 0; i < vnode._children.length; i++) {\n\t\t\tlet child = vnode._children[i];\n\t\t\tif (child != null && child._dom != null) {\n\t\t\t\tvnode._dom = vnode._component.base = child._dom;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn updateParentDomPointers(vnode);\n\t}\n}\n\n/**\n * The render queue\n * @type {Array<import('./internal').Component>}\n */\nlet rerenderQueue = [];\n\n/**\n * Asynchronously schedule a callback\n * @type {(cb: () => void) => void}\n */\n/* istanbul ignore next */\n// Note the following line isn't tree-shaken by rollup cuz of rollup/rollup#2566\nconst defer =\n\ttypeof Promise == 'function'\n\t\t? Promise.prototype.then.bind(Promise.resolve())\n\t\t: setTimeout;\n\n/*\n * The value of `Component.debounce` must asynchronously invoke the passed in callback. It is\n * important that contributors to Preact can consistently reason about what calls to `setState`, etc.\n * do, and when their effects will be applied. See the links below for some further reading on designing\n * asynchronous APIs.\n * * [Designing APIs for Asynchrony](https://blog.izs.me/2013/08/designing-apis-for-asynchrony)\n * * [Callbacks synchronous and asynchronous](https://blog.ometer.com/2011/07/24/callbacks-synchronous-and-asynchronous/)\n */\n\nlet prevDebounce;\n\n/**\n * Enqueue a rerender of a component\n * @param {import('./internal').Component} c The component to rerender\n */\nexport function enqueueRender(c) {\n\tif (\n\t\t(!c._dirty &&\n\t\t\t(c._dirty = true) &&\n\t\t\trerenderQueue.push(c) &&\n\t\t\t!process._rerenderCount++) ||\n\t\tprevDebounce !== options.debounceRendering\n\t) {\n\t\tprevDebounce = options.debounceRendering;\n\t\t(prevDebounce || defer)(process);\n\t}\n}\n\n/** Flush the render queue by rerendering all queued components */\nfunction process() {\n\tlet queue;\n\twhile ((process._rerenderCount = rerenderQueue.length)) {\n\t\tqueue = rerenderQueue.sort((a, b) => a._vnode._depth - b._vnode._depth);\n\t\trerenderQueue = [];\n\t\t// Don't update `renderCount` yet. Keep its value non-zero to prevent unnecessary\n\t\t// process() calls from getting scheduled while `queue` is still being consumed.\n\t\tqueue.some(c => {\n\t\t\tif (c._dirty) renderComponent(c);\n\t\t});\n\t}\n}\nprocess._rerenderCount = 0;\n","import { diff, unmount, applyRef } from './index';\nimport { createVNode, Fragment } from '../create-element';\nimport { EMPTY_OBJ, EMPTY_ARR } from '../constants';\nimport { getDomSibling } from '../component';\n\n/**\n * Diff the children of a virtual node\n * @param {import('../internal').PreactElement} parentDom The DOM element whose\n * children are being diffed\n * @param {import('../internal').ComponentChildren[]} renderResult\n * @param {import('../internal').VNode} newParentVNode The new virtual\n * node whose children should be diff'ed against oldParentVNode\n * @param {import('../internal').VNode} oldParentVNode The old virtual\n * node whose children should be diff'ed against newParentVNode\n * @param {object} globalContext The current context object - modified by getChildContext\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node\n * @param {Array<import('../internal').PreactElement>} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {import('../internal').PreactElement} oldDom The current attached DOM\n * element any new dom elements should be placed around. Likely `null` on first\n * render (except when hydrating). Can be a sibling DOM element when diffing\n * Fragments that have siblings. In most cases, it starts out as `oldChildren[0]._dom`.\n * @param {boolean} isHydrating Whether or not we are in hydration\n */\nexport function diffChildren(\n\tparentDom,\n\trenderResult,\n\tnewParentVNode,\n\toldParentVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\toldDom,\n\tisHydrating\n) {\n\tlet i, j, oldVNode, childVNode, newDom, firstChildDom, refs;\n\n\t// This is a compression of oldParentVNode!=null && oldParentVNode != EMPTY_OBJ && oldParentVNode._children || EMPTY_ARR\n\t// as EMPTY_OBJ._children should be `undefined`.\n\tlet oldChildren = (oldParentVNode && oldParentVNode._children) || EMPTY_ARR;\n\n\tlet oldChildrenLength = oldChildren.length;\n\n\tnewParentVNode._children = [];\n\tfor (i = 0; i < renderResult.length; i++) {\n\t\tchildVNode = renderResult[i];\n\n\t\tif (childVNode == null || typeof childVNode == 'boolean') {\n\t\t\tchildVNode = newParentVNode._children[i] = null;\n\t\t}\n\t\t// If this newVNode is being reused (e.g. <div>{reuse}{reuse}</div>) in the same diff,\n\t\t// or we are rendering a component (e.g. setState) copy the oldVNodes so it can have\n\t\t// it's own DOM & etc. pointers\n\t\telse if (\n\t\t\ttypeof childVNode == 'string' ||\n\t\t\ttypeof childVNode == 'number' ||\n\t\t\t// eslint-disable-next-line valid-typeof\n\t\t\ttypeof childVNode == 'bigint'\n\t\t) {\n\t\t\tchildVNode = newParentVNode._children[i] = createVNode(\n\t\t\t\tnull,\n\t\t\t\tchildVNode,\n\t\t\t\tnull,\n\t\t\t\tnull,\n\t\t\t\tchildVNode\n\t\t\t);\n\t\t} else if (Array.isArray(childVNode)) {\n\t\t\tchildVNode = newParentVNode._children[i] = createVNode(\n\t\t\t\tFragment,\n\t\t\t\t{ children: childVNode },\n\t\t\t\tnull,\n\t\t\t\tnull,\n\t\t\t\tnull\n\t\t\t);\n\t\t} else if (childVNode._depth > 0) {\n\t\t\t// VNode is already in use, clone it. This can happen in the following\n\t\t\t// scenario:\n\t\t\t//   const reuse = <div />\n\t\t\t//   <div>{reuse}<span />{reuse}</div>\n\t\t\tchildVNode = newParentVNode._children[i] = createVNode(\n\t\t\t\tchildVNode.type,\n\t\t\t\tchildVNode.props,\n\t\t\t\tchildVNode.key,\n\t\t\t\tnull,\n\t\t\t\tchildVNode._original\n\t\t\t);\n\t\t} else {\n\t\t\tchildVNode = newParentVNode._children[i] = childVNode;\n\t\t}\n\n\t\t// Terser removes the `continue` here and wraps the loop body\n\t\t// in a `if (childVNode) { ... } condition\n\t\tif (childVNode == null) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tchildVNode._parent = newParentVNode;\n\t\tchildVNode._depth = newParentVNode._depth + 1;\n\n\t\t// Check if we find a corresponding element in oldChildren.\n\t\t// If found, delete the array item by setting to `undefined`.\n\t\t// We use `undefined`, as `null` is reserved for empty placeholders\n\t\t// (holes).\n\t\toldVNode = oldChildren[i];\n\n\t\tif (\n\t\t\toldVNode === null ||\n\t\t\t(oldVNode &&\n\t\t\t\tchildVNode.key == oldVNode.key &&\n\t\t\t\tchildVNode.type === oldVNode.type)\n\t\t) {\n\t\t\toldChildren[i] = undefined;\n\t\t} else {\n\t\t\t// Either oldVNode === undefined or oldChildrenLength > 0,\n\t\t\t// so after this loop oldVNode == null or oldVNode is a valid value.\n\t\t\tfor (j = 0; j < oldChildrenLength; j++) {\n\t\t\t\toldVNode = oldChildren[j];\n\t\t\t\t// If childVNode is unkeyed, we only match similarly unkeyed nodes, otherwise we match by key.\n\t\t\t\t// We always match by type (in either case).\n\t\t\t\tif (\n\t\t\t\t\toldVNode &&\n\t\t\t\t\tchildVNode.key == oldVNode.key &&\n\t\t\t\t\tchildVNode.type === oldVNode.type\n\t\t\t\t) {\n\t\t\t\t\toldChildren[j] = undefined;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\toldVNode = null;\n\t\t\t}\n\t\t}\n\n\t\toldVNode = oldVNode || EMPTY_OBJ;\n\n\t\t// Morph the old element into the new one, but don't append it to the dom yet\n\t\tdiff(\n\t\t\tparentDom,\n\t\t\tchildVNode,\n\t\t\toldVNode,\n\t\t\tglobalContext,\n\t\t\tisSvg,\n\t\t\texcessDomChildren,\n\t\t\tcommitQueue,\n\t\t\toldDom,\n\t\t\tisHydrating\n\t\t);\n\n\t\tnewDom = childVNode._dom;\n\n\t\tif ((j = childVNode.ref) && oldVNode.ref != j) {\n\t\t\tif (!refs) refs = [];\n\t\t\tif (oldVNode.ref) refs.push(oldVNode.ref, null, childVNode);\n\t\t\trefs.push(j, childVNode._component || newDom, childVNode);\n\t\t}\n\n\t\tif (newDom != null) {\n\t\t\tif (firstChildDom == null) {\n\t\t\t\tfirstChildDom = newDom;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\ttypeof childVNode.type == 'function' &&\n\t\t\t\tchildVNode._children != null && // Can be null if childVNode suspended\n\t\t\t\tchildVNode._children === oldVNode._children\n\t\t\t) {\n\t\t\t\tchildVNode._nextDom = oldDom = reorderChildren(\n\t\t\t\t\tchildVNode,\n\t\t\t\t\toldDom,\n\t\t\t\t\tparentDom\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\toldDom = placeChild(\n\t\t\t\t\tparentDom,\n\t\t\t\t\tchildVNode,\n\t\t\t\t\toldVNode,\n\t\t\t\t\toldChildren,\n\t\t\t\t\tnewDom,\n\t\t\t\t\toldDom\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Browsers will infer an option's `value` from `textContent` when\n\t\t\t// no value is present. This essentially bypasses our code to set it\n\t\t\t// later in `diff()`. It works fine in all browsers except for IE11\n\t\t\t// where it breaks setting `select.value`. There it will be always set\n\t\t\t// to an empty string. Re-applying an options value will fix that, so\n\t\t\t// there are probably some internal data structures that aren't\n\t\t\t// updated properly.\n\t\t\t//\n\t\t\t// To fix it we make sure to reset the inferred value, so that our own\n\t\t\t// value check in `diff()` won't be skipped.\n\t\t\tif (!isHydrating && newParentVNode.type === 'option') {\n\t\t\t\t// @ts-ignore We have validated that the type of parentDOM is 'option'\n\t\t\t\t// in the above check\n\t\t\t\tparentDom.value = '';\n\t\t\t} else if (typeof newParentVNode.type == 'function') {\n\t\t\t\t// Because the newParentVNode is Fragment-like, we need to set it's\n\t\t\t\t// _nextDom property to the nextSibling of its last child DOM node.\n\t\t\t\t//\n\t\t\t\t// `oldDom` contains the correct value here because if the last child\n\t\t\t\t// is a Fragment-like, then oldDom has already been set to that child's _nextDom.\n\t\t\t\t// If the last child is a DOM VNode, then oldDom will be set to that DOM\n\t\t\t\t// node's nextSibling.\n\t\t\t\tnewParentVNode._nextDom = oldDom;\n\t\t\t}\n\t\t} else if (\n\t\t\toldDom &&\n\t\t\toldVNode._dom == oldDom &&\n\t\t\toldDom.parentNode != parentDom\n\t\t) {\n\t\t\t// The above condition is to handle null placeholders. See test in placeholder.test.js:\n\t\t\t// `efficiently replace null placeholders in parent rerenders`\n\t\t\toldDom = getDomSibling(oldVNode);\n\t\t}\n\t}\n\n\tnewParentVNode._dom = firstChildDom;\n\n\t// Remove remaining oldChildren if there are any.\n\tfor (i = oldChildrenLength; i--; ) {\n\t\tif (oldChildren[i] != null) {\n\t\t\tif (\n\t\t\t\ttypeof newParentVNode.type == 'function' &&\n\t\t\t\toldChildren[i]._dom != null &&\n\t\t\t\toldChildren[i]._dom == newParentVNode._nextDom\n\t\t\t) {\n\t\t\t\t// If the newParentVNode.__nextDom points to a dom node that is about to\n\t\t\t\t// be unmounted, then get the next sibling of that vnode and set\n\t\t\t\t// _nextDom to it\n\t\t\t\tnewParentVNode._nextDom = getDomSibling(oldParentVNode, i + 1);\n\t\t\t}\n\n\t\t\tunmount(oldChildren[i], oldChildren[i]);\n\t\t}\n\t}\n\n\t// Set refs only after unmount\n\tif (refs) {\n\t\tfor (i = 0; i < refs.length; i++) {\n\t\t\tapplyRef(refs[i], refs[++i], refs[++i]);\n\t\t}\n\t}\n}\n\nfunction reorderChildren(childVNode, oldDom, parentDom) {\n\tfor (let tmp = 0; tmp < childVNode._children.length; tmp++) {\n\t\tlet vnode = childVNode._children[tmp];\n\t\tif (vnode) {\n\t\t\t// We typically enter this code path on sCU bailout, where we copy\n\t\t\t// oldVNode._children to newVNode._children. If that is the case, we need\n\t\t\t// to update the old children's _parent pointer to point to the newVNode\n\t\t\t// (childVNode here).\n\t\t\tvnode._parent = childVNode;\n\n\t\t\tif (typeof vnode.type == 'function') {\n\t\t\t\toldDom = reorderChildren(vnode, oldDom, parentDom);\n\t\t\t} else {\n\t\t\t\toldDom = placeChild(\n\t\t\t\t\tparentDom,\n\t\t\t\t\tvnode,\n\t\t\t\t\tvnode,\n\t\t\t\t\tchildVNode._children,\n\t\t\t\t\tvnode._dom,\n\t\t\t\t\toldDom\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn oldDom;\n}\n\n/**\n * Flatten and loop through the children of a virtual node\n * @param {import('../index').ComponentChildren} children The unflattened\n * children of a virtual node\n * @returns {import('../internal').VNode[]}\n */\nexport function toChildArray(children, out) {\n\tout = out || [];\n\tif (children == null || typeof children == 'boolean') {\n\t} else if (Array.isArray(children)) {\n\t\tchildren.some(child => {\n\t\t\ttoChildArray(child, out);\n\t\t});\n\t} else {\n\t\tout.push(children);\n\t}\n\treturn out;\n}\n\nfunction placeChild(\n\tparentDom,\n\tchildVNode,\n\toldVNode,\n\toldChildren,\n\tnewDom,\n\toldDom\n) {\n\tlet nextDom;\n\tif (childVNode._nextDom !== undefined) {\n\t\t// Only Fragments or components that return Fragment like VNodes will\n\t\t// have a non-undefined _nextDom. Continue the diff from the sibling\n\t\t// of last DOM child of this child VNode\n\t\tnextDom = childVNode._nextDom;\n\n\t\t// Eagerly cleanup _nextDom. We don't need to persist the value because\n\t\t// it is only used by `diffChildren` to determine where to resume the diff after\n\t\t// diffing Components and Fragments. Once we store it the nextDOM local var, we\n\t\t// can clean up the property\n\t\tchildVNode._nextDom = undefined;\n\t} else if (\n\t\toldVNode == null ||\n\t\tnewDom != oldDom ||\n\t\tnewDom.parentNode == null\n\t) {\n\t\touter: if (oldDom == null || oldDom.parentNode !== parentDom) {\n\t\t\tparentDom.appendChild(newDom);\n\t\t\tnextDom = null;\n\t\t} else {\n\t\t\t// `j<oldChildrenLength; j+=2` is an alternative to `j++<oldChildrenLength/2`\n\t\t\tfor (\n\t\t\t\tlet sibDom = oldDom, j = 0;\n\t\t\t\t(sibDom = sibDom.nextSibling) && j < oldChildren.length;\n\t\t\t\tj += 2\n\t\t\t) {\n\t\t\t\tif (sibDom == newDom) {\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t}\n\t\t\tparentDom.insertBefore(newDom, oldDom);\n\t\t\tnextDom = oldDom;\n\t\t}\n\t}\n\n\t// If we have pre-calculated the nextDOM node, use it. Else calculate it now\n\t// Strictly check for `undefined` here cuz `null` is a valid value of `nextDom`.\n\t// See more detail in create-element.js:createVNode\n\tif (nextDom !== undefined) {\n\t\toldDom = nextDom;\n\t} else {\n\t\toldDom = newDom.nextSibling;\n\t}\n\n\treturn oldDom;\n}\n","import { IS_NON_DIMENSIONAL } from '../constants';\nimport options from '../options';\n\n/**\n * Diff the old and new properties of a VNode and apply changes to the DOM node\n * @param {import('../internal').PreactElement} dom The DOM node to apply\n * changes to\n * @param {object} newProps The new props\n * @param {object} oldProps The old props\n * @param {boolean} isSvg Whether or not this node is an SVG node\n * @param {boolean} hydrate Whether or not we are in hydration mode\n */\nexport function diffProps(dom, newProps, oldProps, isSvg, hydrate) {\n\tlet i;\n\n\tfor (i in oldProps) {\n\t\tif (i !== 'children' && i !== 'key' && !(i in newProps)) {\n\t\t\tsetProperty(dom, i, null, oldProps[i], isSvg);\n\t\t}\n\t}\n\n\tfor (i in newProps) {\n\t\tif (\n\t\t\t(!hydrate || typeof newProps[i] == 'function') &&\n\t\t\ti !== 'children' &&\n\t\t\ti !== 'key' &&\n\t\t\ti !== 'value' &&\n\t\t\ti !== 'checked' &&\n\t\t\toldProps[i] !== newProps[i]\n\t\t) {\n\t\t\tsetProperty(dom, i, newProps[i], oldProps[i], isSvg);\n\t\t}\n\t}\n}\n\nfunction setStyle(style, key, value) {\n\tif (key[0] === '-') {\n\t\tstyle.setProperty(key, value);\n\t} else if (value == null) {\n\t\tstyle[key] = '';\n\t} else if (typeof value != 'number' || IS_NON_DIMENSIONAL.test(key)) {\n\t\tstyle[key] = value;\n\t} else {\n\t\tstyle[key] = value + 'px';\n\t}\n}\n\n/**\n * Set a property value on a DOM node\n * @param {import('../internal').PreactElement} dom The DOM node to modify\n * @param {string} name The name of the property to set\n * @param {*} value The value to set the property to\n * @param {*} oldValue The old value the property had\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node or not\n */\nexport function setProperty(dom, name, value, oldValue, isSvg) {\n\tlet useCapture;\n\n\to: if (name === 'style') {\n\t\tif (typeof value == 'string') {\n\t\t\tdom.style.cssText = value;\n\t\t} else {\n\t\t\tif (typeof oldValue == 'string') {\n\t\t\t\tdom.style.cssText = oldValue = '';\n\t\t\t}\n\n\t\t\tif (oldValue) {\n\t\t\t\tfor (name in oldValue) {\n\t\t\t\t\tif (!(value && name in value)) {\n\t\t\t\t\t\tsetStyle(dom.style, name, '');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (value) {\n\t\t\t\tfor (name in value) {\n\t\t\t\t\tif (!oldValue || value[name] !== oldValue[name]) {\n\t\t\t\t\t\tsetStyle(dom.style, name, value[name]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t// Benchmark for comparison: https://esbench.com/bench/574c954bdb965b9a00965ac6\n\telse if (name[0] === 'o' && name[1] === 'n') {\n\t\tuseCapture = name !== (name = name.replace(/Capture$/, ''));\n\n\t\t// Infer correct casing for DOM built-in events:\n\t\tif (name.toLowerCase() in dom) name = name.toLowerCase().slice(2);\n\t\telse name = name.slice(2);\n\n\t\tif (!dom._listeners) dom._listeners = {};\n\t\tdom._listeners[name + useCapture] = value;\n\n\t\tif (value) {\n\t\t\tif (!oldValue) {\n\t\t\t\tconst handler = useCapture ? eventProxyCapture : eventProxy;\n\t\t\t\tdom.addEventListener(name, handler, useCapture);\n\t\t\t}\n\t\t} else {\n\t\t\tconst handler = useCapture ? eventProxyCapture : eventProxy;\n\t\t\tdom.removeEventListener(name, handler, useCapture);\n\t\t}\n\t} else if (name !== 'dangerouslySetInnerHTML') {\n\t\tif (isSvg) {\n\t\t\t// Normalize incorrect prop usage for SVG:\n\t\t\t// - xlink:href / xlinkHref --> href (xlink:href was removed from SVG and isn't needed)\n\t\t\t// - className --> class\n\t\t\tname = name.replace(/xlink[H:h]/, 'h').replace(/sName$/, 's');\n\t\t} else if (\n\t\t\tname !== 'href' &&\n\t\t\tname !== 'list' &&\n\t\t\tname !== 'form' &&\n\t\t\t// Default value in browsers is `-1` and an empty string is\n\t\t\t// cast to `0` instead\n\t\t\tname !== 'tabIndex' &&\n\t\t\tname !== 'download' &&\n\t\t\tname in dom\n\t\t) {\n\t\t\ttry {\n\t\t\t\tdom[name] = value == null ? '' : value;\n\t\t\t\t// labelled break is 1b smaller here than a return statement (sorry)\n\t\t\t\tbreak o;\n\t\t\t} catch (e) {}\n\t\t}\n\n\t\t// ARIA-attributes have a different notion of boolean values.\n\t\t// The value `false` is different from the attribute not\n\t\t// existing on the DOM, so we can't remove it. For non-boolean\n\t\t// ARIA-attributes we could treat false as a removal, but the\n\t\t// amount of exceptions would cost us too many bytes. On top of\n\t\t// that other VDOM frameworks also always stringify `false`.\n\n\t\tif (typeof value === 'function') {\n\t\t\t// never serialize functions as attribute values\n\t\t} else if (\n\t\t\tvalue != null &&\n\t\t\t(value !== false || (name[0] === 'a' && name[1] === 'r'))\n\t\t) {\n\t\t\tdom.setAttribute(name, value);\n\t\t} else {\n\t\t\tdom.removeAttribute(name);\n\t\t}\n\t}\n}\n\n/**\n * Proxy an event to hooked event handlers\n * @param {Event} e The event object from the browser\n * @private\n */\nfunction eventProxy(e) {\n\tthis._listeners[e.type + false](options.event ? options.event(e) : e);\n}\n\nfunction eventProxyCapture(e) {\n\tthis._listeners[e.type + true](options.event ? options.event(e) : e);\n}\n","import { EMPTY_OBJ, EMPTY_ARR } from '../constants';\nimport { Component } from '../component';\nimport { Fragment } from '../create-element';\nimport { diffChildren } from './children';\nimport { diffProps, setProperty } from './props';\nimport { assign, removeNode } from '../util';\nimport options from '../options';\n\n/**\n * Diff two virtual nodes and apply proper changes to the DOM\n * @param {import('../internal').PreactElement} parentDom The parent of the DOM element\n * @param {import('../internal').VNode} newVNode The new virtual node\n * @param {import('../internal').VNode} oldVNode The old virtual node\n * @param {object} globalContext The current context object. Modified by getChildContext\n * @param {boolean} isSvg Whether or not this element is an SVG node\n * @param {Array<import('../internal').PreactElement>} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {import('../internal').PreactElement} oldDom The current attached DOM\n * element any new dom elements should be placed around. Likely `null` on first\n * render (except when hydrating). Can be a sibling DOM element when diffing\n * Fragments that have siblings. In most cases, it starts out as `oldChildren[0]._dom`.\n * @param {boolean} [isHydrating] Whether or not we are in hydration\n */\nexport function diff(\n\tparentDom,\n\tnewVNode,\n\toldVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\toldDom,\n\tisHydrating\n) {\n\tlet tmp,\n\t\tnewType = newVNode.type;\n\n\t// When passing through createElement it assigns the object\n\t// constructor as undefined. This to prevent JSON-injection.\n\tif (newVNode.constructor !== undefined) return null;\n\n\t// If the previous diff bailed out, resume creating/hydrating.\n\tif (oldVNode._hydrating != null) {\n\t\tisHydrating = oldVNode._hydrating;\n\t\toldDom = newVNode._dom = oldVNode._dom;\n\t\t// if we resume, we want the tree to be \"unlocked\"\n\t\tnewVNode._hydrating = null;\n\t\texcessDomChildren = [oldDom];\n\t}\n\n\tif ((tmp = options._diff)) tmp(newVNode);\n\n\ttry {\n\t\touter: if (typeof newType == 'function') {\n\t\t\tlet c, isNew, oldProps, oldState, snapshot, clearProcessingException;\n\t\t\tlet newProps = newVNode.props;\n\n\t\t\t// Necessary for createContext api. Setting this property will pass\n\t\t\t// the context value as `this.context` just for this component.\n\t\t\ttmp = newType.contextType;\n\t\t\tlet provider = tmp && globalContext[tmp._id];\n\t\t\tlet componentContext = tmp\n\t\t\t\t? provider\n\t\t\t\t\t? provider.props.value\n\t\t\t\t\t: tmp._defaultValue\n\t\t\t\t: globalContext;\n\n\t\t\t// Get component and set it to `c`\n\t\t\tif (oldVNode._component) {\n\t\t\t\tc = newVNode._component = oldVNode._component;\n\t\t\t\tclearProcessingException = c._processingException = c._pendingError;\n\t\t\t} else {\n\t\t\t\t// Instantiate the new component\n\t\t\t\tif ('prototype' in newType && newType.prototype.render) {\n\t\t\t\t\t// @ts-ignore The check above verifies that newType is suppose to be constructed\n\t\t\t\t\tnewVNode._component = c = new newType(newProps, componentContext); // eslint-disable-line new-cap\n\t\t\t\t} else {\n\t\t\t\t\t// @ts-ignore Trust me, Component implements the interface we want\n\t\t\t\t\tnewVNode._component = c = new Component(newProps, componentContext);\n\t\t\t\t\tc.constructor = newType;\n\t\t\t\t\tc.render = doRender;\n\t\t\t\t}\n\t\t\t\tif (provider) provider.sub(c);\n\n\t\t\t\tc.props = newProps;\n\t\t\t\tif (!c.state) c.state = {};\n\t\t\t\tc.context = componentContext;\n\t\t\t\tc._globalContext = globalContext;\n\t\t\t\tisNew = c._dirty = true;\n\t\t\t\tc._renderCallbacks = [];\n\t\t\t}\n\n\t\t\t// Invoke getDerivedStateFromProps\n\t\t\tif (c._nextState == null) {\n\t\t\t\tc._nextState = c.state;\n\t\t\t}\n\t\t\tif (newType.getDerivedStateFromProps != null) {\n\t\t\t\tif (c._nextState == c.state) {\n\t\t\t\t\tc._nextState = assign({}, c._nextState);\n\t\t\t\t}\n\n\t\t\t\tassign(\n\t\t\t\t\tc._nextState,\n\t\t\t\t\tnewType.getDerivedStateFromProps(newProps, c._nextState)\n\t\t\t\t);\n\t\t\t}\n\n\t\t\toldProps = c.props;\n\t\t\toldState = c.state;\n\n\t\t\t// Invoke pre-render lifecycle methods\n\t\t\tif (isNew) {\n\t\t\t\tif (\n\t\t\t\t\tnewType.getDerivedStateFromProps == null &&\n\t\t\t\t\tc.componentWillMount != null\n\t\t\t\t) {\n\t\t\t\t\tc.componentWillMount();\n\t\t\t\t}\n\n\t\t\t\tif (c.componentDidMount != null) {\n\t\t\t\t\tc._renderCallbacks.push(c.componentDidMount);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (\n\t\t\t\t\tnewType.getDerivedStateFromProps == null &&\n\t\t\t\t\tnewProps !== oldProps &&\n\t\t\t\t\tc.componentWillReceiveProps != null\n\t\t\t\t) {\n\t\t\t\t\tc.componentWillReceiveProps(newProps, componentContext);\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\t(!c._force &&\n\t\t\t\t\t\tc.shouldComponentUpdate != null &&\n\t\t\t\t\t\tc.shouldComponentUpdate(\n\t\t\t\t\t\t\tnewProps,\n\t\t\t\t\t\t\tc._nextState,\n\t\t\t\t\t\t\tcomponentContext\n\t\t\t\t\t\t) === false) ||\n\t\t\t\t\tnewVNode._original === oldVNode._original\n\t\t\t\t) {\n\t\t\t\t\tc.props = newProps;\n\t\t\t\t\tc.state = c._nextState;\n\t\t\t\t\t// More info about this here: https://gist.github.com/JoviDeCroock/bec5f2ce93544d2e6070ef8e0036e4e8\n\t\t\t\t\tif (newVNode._original !== oldVNode._original) c._dirty = false;\n\t\t\t\t\tc._vnode = newVNode;\n\t\t\t\t\tnewVNode._dom = oldVNode._dom;\n\t\t\t\t\tnewVNode._children = oldVNode._children;\n\t\t\t\t\tnewVNode._children.forEach(vnode => {\n\t\t\t\t\t\tif (vnode) vnode._parent = newVNode;\n\t\t\t\t\t});\n\t\t\t\t\tif (c._renderCallbacks.length) {\n\t\t\t\t\t\tcommitQueue.push(c);\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\n\t\t\t\tif (c.componentWillUpdate != null) {\n\t\t\t\t\tc.componentWillUpdate(newProps, c._nextState, componentContext);\n\t\t\t\t}\n\n\t\t\t\tif (c.componentDidUpdate != null) {\n\t\t\t\t\tc._renderCallbacks.push(() => {\n\t\t\t\t\t\tc.componentDidUpdate(oldProps, oldState, snapshot);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tc.context = componentContext;\n\t\t\tc.props = newProps;\n\t\t\tc.state = c._nextState;\n\n\t\t\tif ((tmp = options._render)) tmp(newVNode);\n\n\t\t\tc._dirty = false;\n\t\t\tc._vnode = newVNode;\n\t\t\tc._parentDom = parentDom;\n\n\t\t\ttmp = c.render(c.props, c.state, c.context);\n\n\t\t\t// Handle setState called in render, see #2553\n\t\t\tc.state = c._nextState;\n\n\t\t\tif (c.getChildContext != null) {\n\t\t\t\tglobalContext = assign(assign({}, globalContext), c.getChildContext());\n\t\t\t}\n\n\t\t\tif (!isNew && c.getSnapshotBeforeUpdate != null) {\n\t\t\t\tsnapshot = c.getSnapshotBeforeUpdate(oldProps, oldState);\n\t\t\t}\n\n\t\t\tlet isTopLevelFragment =\n\t\t\t\ttmp != null && tmp.type === Fragment && tmp.key == null;\n\t\t\tlet renderResult = isTopLevelFragment ? tmp.props.children : tmp;\n\n\t\t\tdiffChildren(\n\t\t\t\tparentDom,\n\t\t\t\tArray.isArray(renderResult) ? renderResult : [renderResult],\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\toldDom,\n\t\t\t\tisHydrating\n\t\t\t);\n\n\t\t\tc.base = newVNode._dom;\n\n\t\t\t// We successfully rendered this VNode, unset any stored hydration/bailout state:\n\t\t\tnewVNode._hydrating = null;\n\n\t\t\tif (c._renderCallbacks.length) {\n\t\t\t\tcommitQueue.push(c);\n\t\t\t}\n\n\t\t\tif (clearProcessingException) {\n\t\t\t\tc._pendingError = c._processingException = null;\n\t\t\t}\n\n\t\t\tc._force = false;\n\t\t} else if (\n\t\t\texcessDomChildren == null &&\n\t\t\tnewVNode._original === oldVNode._original\n\t\t) {\n\t\t\tnewVNode._children = oldVNode._children;\n\t\t\tnewVNode._dom = oldVNode._dom;\n\t\t} else {\n\t\t\tnewVNode._dom = diffElementNodes(\n\t\t\t\toldVNode._dom,\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\tisHydrating\n\t\t\t);\n\t\t}\n\n\t\tif ((tmp = options.diffed)) tmp(newVNode);\n\t} catch (e) {\n\t\tnewVNode._original = null;\n\t\t// if hydrating or creating initial tree, bailout preserves DOM:\n\t\tif (isHydrating || excessDomChildren != null) {\n\t\t\tnewVNode._dom = oldDom;\n\t\t\tnewVNode._hydrating = !!isHydrating;\n\t\t\texcessDomChildren[excessDomChildren.indexOf(oldDom)] = null;\n\t\t\t// ^ could possibly be simplified to:\n\t\t\t// excessDomChildren.length = 0;\n\t\t}\n\t\toptions._catchError(e, newVNode, oldVNode);\n\t}\n}\n\n/**\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {import('../internal').VNode} root\n */\nexport function commitRoot(commitQueue, root) {\n\tif (options._commit) options._commit(root, commitQueue);\n\n\tcommitQueue.some(c => {\n\t\ttry {\n\t\t\t// @ts-ignore Reuse the commitQueue variable here so the type changes\n\t\t\tcommitQueue = c._renderCallbacks;\n\t\t\tc._renderCallbacks = [];\n\t\t\tcommitQueue.some(cb => {\n\t\t\t\t// @ts-ignore See above ts-ignore on commitQueue\n\t\t\t\tcb.call(c);\n\t\t\t});\n\t\t} catch (e) {\n\t\t\toptions._catchError(e, c._vnode);\n\t\t}\n\t});\n}\n\n/**\n * Diff two virtual nodes representing DOM element\n * @param {import('../internal').PreactElement} dom The DOM element representing\n * the virtual nodes being diffed\n * @param {import('../internal').VNode} newVNode The new virtual node\n * @param {import('../internal').VNode} oldVNode The old virtual node\n * @param {object} globalContext The current context object\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node\n * @param {*} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {boolean} isHydrating Whether or not we are in hydration\n * @returns {import('../internal').PreactElement}\n */\nfunction diffElementNodes(\n\tdom,\n\tnewVNode,\n\toldVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\tisHydrating\n) {\n\tlet oldProps = oldVNode.props;\n\tlet newProps = newVNode.props;\n\tlet nodeType = newVNode.type;\n\tlet i = 0;\n\n\t// Tracks entering and exiting SVG namespace when descending through the tree.\n\tif (nodeType === 'svg') isSvg = true;\n\n\tif (excessDomChildren != null) {\n\t\tfor (; i < excessDomChildren.length; i++) {\n\t\t\tconst child = excessDomChildren[i];\n\n\t\t\t// if newVNode matches an element in excessDomChildren or the `dom`\n\t\t\t// argument matches an element in excessDomChildren, remove it from\n\t\t\t// excessDomChildren so it isn't later removed in diffChildren\n\t\t\tif (\n\t\t\t\tchild &&\n\t\t\t\t(child === dom ||\n\t\t\t\t\t(nodeType ? child.localName == nodeType : child.nodeType == 3))\n\t\t\t) {\n\t\t\t\tdom = child;\n\t\t\t\texcessDomChildren[i] = null;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (dom == null) {\n\t\tif (nodeType === null) {\n\t\t\t// @ts-ignore createTextNode returns Text, we expect PreactElement\n\t\t\treturn document.createTextNode(newProps);\n\t\t}\n\n\t\tif (isSvg) {\n\t\t\tdom = document.createElementNS(\n\t\t\t\t'http://www.w3.org/2000/svg',\n\t\t\t\t// @ts-ignore We know `newVNode.type` is a string\n\t\t\t\tnodeType\n\t\t\t);\n\t\t} else {\n\t\t\tdom = document.createElement(\n\t\t\t\t// @ts-ignore We know `newVNode.type` is a string\n\t\t\t\tnodeType,\n\t\t\t\tnewProps.is && newProps\n\t\t\t);\n\t\t}\n\n\t\t// we created a new parent, so none of the previously attached children can be reused:\n\t\texcessDomChildren = null;\n\t\t// we are creating a new node, so we can assume this is a new subtree (in case we are hydrating), this deopts the hydrate\n\t\tisHydrating = false;\n\t}\n\n\tif (nodeType === null) {\n\t\t// During hydration, we still have to split merged text from SSR'd HTML.\n\t\tif (oldProps !== newProps && (!isHydrating || dom.data !== newProps)) {\n\t\t\tdom.data = newProps;\n\t\t}\n\t} else {\n\t\t// If excessDomChildren was not null, repopulate it with the current element's children:\n\t\texcessDomChildren =\n\t\t\texcessDomChildren && EMPTY_ARR.slice.call(dom.childNodes);\n\n\t\toldProps = oldVNode.props || EMPTY_OBJ;\n\n\t\tlet oldHtml = oldProps.dangerouslySetInnerHTML;\n\t\tlet newHtml = newProps.dangerouslySetInnerHTML;\n\n\t\t// During hydration, props are not diffed at all (including dangerouslySetInnerHTML)\n\t\t// @TODO we should warn in debug mode when props don't match here.\n\t\tif (!isHydrating) {\n\t\t\t// But, if we are in a situation where we are using existing DOM (e.g. replaceNode)\n\t\t\t// we should read the existing DOM attributes to diff them\n\t\t\tif (excessDomChildren != null) {\n\t\t\t\toldProps = {};\n\t\t\t\tfor (let i = 0; i < dom.attributes.length; i++) {\n\t\t\t\t\toldProps[dom.attributes[i].name] = dom.attributes[i].value;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (newHtml || oldHtml) {\n\t\t\t\t// Avoid re-applying the same '__html' if it did not changed between re-render\n\t\t\t\tif (\n\t\t\t\t\t!newHtml ||\n\t\t\t\t\t((!oldHtml || newHtml.__html != oldHtml.__html) &&\n\t\t\t\t\t\tnewHtml.__html !== dom.innerHTML)\n\t\t\t\t) {\n\t\t\t\t\tdom.innerHTML = (newHtml && newHtml.__html) || '';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tdiffProps(dom, newProps, oldProps, isSvg, isHydrating);\n\n\t\t// If the new vnode didn't have dangerouslySetInnerHTML, diff its children\n\t\tif (newHtml) {\n\t\t\tnewVNode._children = [];\n\t\t} else {\n\t\t\ti = newVNode.props.children;\n\t\t\tdiffChildren(\n\t\t\t\tdom,\n\t\t\t\tArray.isArray(i) ? i : [i],\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg && nodeType !== 'foreignObject',\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\tdom.firstChild,\n\t\t\t\tisHydrating\n\t\t\t);\n\n\t\t\t// Remove children that are not part of any vnode.\n\t\t\tif (excessDomChildren != null) {\n\t\t\t\tfor (i = excessDomChildren.length; i--; ) {\n\t\t\t\t\tif (excessDomChildren[i] != null) removeNode(excessDomChildren[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// (as above, don't diff props during hydration)\n\t\tif (!isHydrating) {\n\t\t\tif (\n\t\t\t\t'value' in newProps &&\n\t\t\t\t(i = newProps.value) !== undefined &&\n\t\t\t\t// #2756 For the <progress>-element the initial value is 0,\n\t\t\t\t// despite the attribute not being present. When the attribute\n\t\t\t\t// is missing the progress bar is treated as indeterminate.\n\t\t\t\t// To fix that we'll always update it when it is 0 for progress elements\n\t\t\t\t(i !== dom.value || (nodeType === 'progress' && !i))\n\t\t\t) {\n\t\t\t\tsetProperty(dom, 'value', i, oldProps.value, false);\n\t\t\t}\n\t\t\tif (\n\t\t\t\t'checked' in newProps &&\n\t\t\t\t(i = newProps.checked) !== undefined &&\n\t\t\t\ti !== dom.checked\n\t\t\t) {\n\t\t\t\tsetProperty(dom, 'checked', i, oldProps.checked, false);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn dom;\n}\n\n/**\n * Invoke or update a ref, depending on whether it is a function or object ref.\n * @param {object|function} ref\n * @param {any} value\n * @param {import('../internal').VNode} vnode\n */\nexport function applyRef(ref, value, vnode) {\n\ttry {\n\t\tif (typeof ref == 'function') ref(value);\n\t\telse ref.current = value;\n\t} catch (e) {\n\t\toptions._catchError(e, vnode);\n\t}\n}\n\n/**\n * Unmount a virtual node from the tree and apply DOM changes\n * @param {import('../internal').VNode} vnode The virtual node to unmount\n * @param {import('../internal').VNode} parentVNode The parent of the VNode that\n * initiated the unmount\n * @param {boolean} [skipRemove] Flag that indicates that a parent node of the\n * current element is already detached from the DOM.\n */\nexport function unmount(vnode, parentVNode, skipRemove) {\n\tlet r;\n\tif (options.unmount) options.unmount(vnode);\n\n\tif ((r = vnode.ref)) {\n\t\tif (!r.current || r.current === vnode._dom) applyRef(r, null, parentVNode);\n\t}\n\n\tlet dom;\n\tif (!skipRemove && typeof vnode.type != 'function') {\n\t\tskipRemove = (dom = vnode._dom) != null;\n\t}\n\n\t// Must be set to `undefined` to properly clean up `_nextDom`\n\t// for which `null` is a valid value. See comment in `create-element.js`\n\tvnode._dom = vnode._nextDom = undefined;\n\n\tif ((r = vnode._component) != null) {\n\t\tif (r.componentWillUnmount) {\n\t\t\ttry {\n\t\t\t\tr.componentWillUnmount();\n\t\t\t} catch (e) {\n\t\t\t\toptions._catchError(e, parentVNode);\n\t\t\t}\n\t\t}\n\n\t\tr.base = r._parentDom = null;\n\t}\n\n\tif ((r = vnode._children)) {\n\t\tfor (let i = 0; i < r.length; i++) {\n\t\t\tif (r[i]) unmount(r[i], parentVNode, skipRemove);\n\t\t}\n\t}\n\n\tif (dom != null) removeNode(dom);\n}\n\n/** The `.render()` method for a PFC backing instance. */\nfunction doRender(props, state, context) {\n\treturn this.constructor(props, context);\n}\n","import { EMPTY_OBJ, EMPTY_ARR } from './constants';\nimport { commitRoot, diff } from './diff/index';\nimport { createElement, Fragment } from './create-element';\nimport options from './options';\n\n/**\n * Render a Preact virtual node into a DOM element\n * @param {import('./internal').ComponentChild} vnode The virtual node to render\n * @param {import('./internal').PreactElement} parentDom The DOM element to\n * render into\n * @param {import('./internal').PreactElement | object} [replaceNode] Optional: Attempt to re-use an\n * existing DOM tree rooted at `replaceNode`\n */\nexport function render(vnode, parentDom, replaceNode) {\n\tif (options._root) options._root(vnode, parentDom);\n\n\t// We abuse the `replaceNode` parameter in `hydrate()` to signal if we are in\n\t// hydration mode or not by passing the `hydrate` function instead of a DOM\n\t// element..\n\tlet isHydrating = typeof replaceNode === 'function';\n\n\t// To be able to support calling `render()` multiple times on the same\n\t// DOM node, we need to obtain a reference to the previous tree. We do\n\t// this by assigning a new `_children` property to DOM nodes which points\n\t// to the last rendered tree. By default this property is not present, which\n\t// means that we are mounting a new tree for the first time.\n\tlet oldVNode = isHydrating\n\t\t? null\n\t\t: (replaceNode && replaceNode._children) || parentDom._children;\n\n\tvnode = (\n\t\t(!isHydrating && replaceNode) ||\n\t\tparentDom\n\t)._children = createElement(Fragment, null, [vnode]);\n\n\t// List of effects that need to be called after diffing.\n\tlet commitQueue = [];\n\tdiff(\n\t\tparentDom,\n\t\t// Determine the new vnode tree and store it on the DOM element on\n\t\t// our custom `_children` property.\n\t\tvnode,\n\t\toldVNode || EMPTY_OBJ,\n\t\tEMPTY_OBJ,\n\t\tparentDom.ownerSVGElement !== undefined,\n\t\t!isHydrating && replaceNode\n\t\t\t? [replaceNode]\n\t\t\t: oldVNode\n\t\t\t? null\n\t\t\t: parentDom.firstChild\n\t\t\t? EMPTY_ARR.slice.call(parentDom.childNodes)\n\t\t\t: null,\n\t\tcommitQueue,\n\t\t!isHydrating && replaceNode\n\t\t\t? replaceNode\n\t\t\t: oldVNode\n\t\t\t? oldVNode._dom\n\t\t\t: parentDom.firstChild,\n\t\tisHydrating\n\t);\n\n\t// Flush all queued effects\n\tcommitRoot(commitQueue, vnode);\n}\n\n/**\n * Update an existing DOM element with data from a Preact virtual node\n * @param {import('./internal').ComponentChild} vnode The virtual node to render\n * @param {import('./internal').PreactElement} parentDom The DOM element to\n * update\n */\nexport function hydrate(vnode, parentDom) {\n\trender(vnode, parentDom, hydrate);\n}\n","export const EMPTY_OBJ = {};\nexport const EMPTY_ARR = [];\nexport const IS_NON_DIMENSIONAL = /acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;\n","import { _catchError } from './diff/catch-error';\n\n/**\n * The `option` object can potentially contain callback functions\n * that are called during various stages of our renderer. This is the\n * foundation on which all our addons like `preact/debug`, `preact/compat`,\n * and `preact/hooks` are based on. See the `Options` type in `internal.d.ts`\n * for a full list of available option hooks (most editors/IDEs allow you to\n * ctrl+click or cmd+click on mac the type definition below).\n * @type {import('./internal').Options}\n */\nconst options = {\n\t_catchError,\n\t_vnodeId: 0\n};\n\nexport default options;\n","/**\n * Find the closest error boundary to a thrown error and call it\n * @param {object} error The thrown value\n * @param {import('../internal').VNode} vnode The vnode that threw\n * the error that was caught (except for unmounting when this parameter\n * is the highest parent that was being unmounted)\n */\nexport function _catchError(error, vnode) {\n\t/** @type {import('../internal').Component} */\n\tlet component, ctor, handled;\n\n\tfor (; (vnode = vnode._parent); ) {\n\t\tif ((component = vnode._component) && !component._processingException) {\n\t\t\ttry {\n\t\t\t\tctor = component.constructor;\n\n\t\t\t\tif (ctor && ctor.getDerivedStateFromError != null) {\n\t\t\t\t\tcomponent.setState(ctor.getDerivedStateFromError(error));\n\t\t\t\t\thandled = component._dirty;\n\t\t\t\t}\n\n\t\t\t\tif (component.componentDidCatch != null) {\n\t\t\t\t\tcomponent.componentDidCatch(error);\n\t\t\t\t\thandled = component._dirty;\n\t\t\t\t}\n\n\t\t\t\t// This is an error boundary. Mark it as having bailed out, and whether it was mid-hydration.\n\t\t\t\tif (handled) {\n\t\t\t\t\treturn (component._pendingError = component);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\terror = e;\n\t\t\t}\n\t\t}\n\t}\n\n\tthrow error;\n}\n","/* global __webpack_public_path__ */\n\nimport * as Preact from 'preact';\nconst { h, render, hydrate } = Preact;\n\nconst interopDefault = m => (m && m.default ? m.default : m);\n\nconst normalizeURL = url => (url[url.length - 1] === '/' ? url : url + '/');\n\nif (process.env.NODE_ENV === 'development') {\n\t// enable preact devtools\n\trequire('preact/debug');\n\n\t// only add a debug sw if webpack service worker is not requested.\n\tif (process.env.ADD_SW === undefined && 'serviceWorker' in navigator) {\n\t\t// eslint-disable-next-line no-undef\n\t\tnavigator.serviceWorker.register(__webpack_public_path__ + 'sw-debug.js');\n\t} else if (process.env.ADD_SW && 'serviceWorker' in navigator) {\n\t\t// eslint-disable-next-line no-undef\n\t\tnavigator.serviceWorker.register(\n\t\t\t__webpack_public_path__ + (process.env.ES_BUILD ? 'sw-esm.js' : 'sw.js')\n\t\t);\n\t}\n} else if (process.env.ADD_SW && 'serviceWorker' in navigator) {\n\t// eslint-disable-next-line no-undef\n\tnavigator.serviceWorker.register(\n\t\t__webpack_public_path__ + (process.env.ES_BUILD ? 'sw-esm.js' : 'sw.js')\n\t);\n}\n\nlet app = interopDefault(require('preact-cli-entrypoint'));\n\nif (typeof app === 'function') {\n\tlet root =\n\t\tdocument.getElementById('preact_root') || document.body.firstElementChild;\n\n\tlet init = () => {\n\t\tlet app = interopDefault(require('preact-cli-entrypoint'));\n\t\tlet preRenderData = {};\n\t\tconst inlineDataElement = document.querySelector(\n\t\t\t'[type=\"__PREACT_CLI_DATA__\"]'\n\t\t);\n\t\tif (inlineDataElement) {\n\t\t\tpreRenderData =\n\t\t\t\tJSON.parse(decodeURI(inlineDataElement.innerHTML)).preRenderData ||\n\t\t\t\tpreRenderData;\n\t\t}\n\t\t/* An object named CLI_DATA is passed as a prop,\n\t\t * this keeps us future proof if in case we decide,\n\t\t * to send other data like at some point in time.\n\t\t */\n\t\tconst CLI_DATA = { preRenderData };\n\t\tconst currentURL = preRenderData.url ? normalizeURL(preRenderData.url) : '';\n\t\tconst canHydrate =\n\t\t\tprocess.env.PRERENDER &&\n\t\t\tprocess.env.NODE_ENV === 'production' &&\n\t\t\thydrate &&\n\t\t\tcurrentURL === normalizeURL(location.pathname);\n\t\tconst doRender = canHydrate ? hydrate : render;\n\t\troot = doRender(h(app, { CLI_DATA }), document.body, root);\n\t};\n\n\tif (module.hot) module.hot.accept('preact-cli-entrypoint', init);\n\n\tinit();\n}\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","import { options } from 'preact';\n\n/** @type {number} */\nlet currentIndex;\n\n/** @type {import('./internal').Component} */\nlet currentComponent;\n/**\n * Keep track of the previous component so that we can set\n * `currentComponent` to `null` and throw when a hook is invoked\n * outside of render\n * @type {import('./internal').Component}\n */\nlet previousComponent;\n\n/** @type {number} */\nlet currentHook = 0;\n\n/** @type {Array<import('./internal').Component>} */\nlet afterPaintEffects = [];\n\nlet oldBeforeDiff = options._diff;\nlet oldBeforeRender = options._render;\nlet oldAfterDiff = options.diffed;\nlet oldCommit = options._commit;\nlet oldBeforeUnmount = options.unmount;\n\nconst RAF_TIMEOUT = 100;\nlet prevRaf;\n\noptions._diff = vnode => {\n\tcurrentComponent = null;\n\tif (oldBeforeDiff) oldBeforeDiff(vnode);\n};\n\noptions._render = vnode => {\n\tif (oldBeforeRender) oldBeforeRender(vnode);\n\n\tcurrentComponent = vnode._component;\n\tcurrentIndex = 0;\n\n\tconst hooks = currentComponent.__hooks;\n\tif (hooks) {\n\t\thooks._pendingEffects.forEach(invokeCleanup);\n\t\thooks._pendingEffects.forEach(invokeEffect);\n\t\thooks._pendingEffects = [];\n\t}\n};\n\noptions.diffed = vnode => {\n\tif (oldAfterDiff) oldAfterDiff(vnode);\n\n\tconst c = vnode._component;\n\tif (c && c.__hooks && c.__hooks._pendingEffects.length) {\n\t\tafterPaint(afterPaintEffects.push(c));\n\t}\n\tcurrentComponent = previousComponent;\n};\n\noptions._commit = (vnode, commitQueue) => {\n\tcommitQueue.some(component => {\n\t\ttry {\n\t\t\tcomponent._renderCallbacks.forEach(invokeCleanup);\n\t\t\tcomponent._renderCallbacks = component._renderCallbacks.filter(cb =>\n\t\t\t\tcb._value ? invokeEffect(cb) : true\n\t\t\t);\n\t\t} catch (e) {\n\t\t\tcommitQueue.some(c => {\n\t\t\t\tif (c._renderCallbacks) c._renderCallbacks = [];\n\t\t\t});\n\t\t\tcommitQueue = [];\n\t\t\toptions._catchError(e, component._vnode);\n\t\t}\n\t});\n\n\tif (oldCommit) oldCommit(vnode, commitQueue);\n};\n\noptions.unmount = vnode => {\n\tif (oldBeforeUnmount) oldBeforeUnmount(vnode);\n\n\tconst c = vnode._component;\n\tif (c && c.__hooks) {\n\t\ttry {\n\t\t\tc.__hooks._list.forEach(invokeCleanup);\n\t\t} catch (e) {\n\t\t\toptions._catchError(e, c._vnode);\n\t\t}\n\t}\n};\n\n/**\n * Get a hook's state from the currentComponent\n * @param {number} index The index of the hook to get\n * @param {number} type The index of the hook to get\n * @returns {any}\n */\nfunction getHookState(index, type) {\n\tif (options._hook) {\n\t\toptions._hook(currentComponent, index, currentHook || type);\n\t}\n\tcurrentHook = 0;\n\n\t// Largely inspired by:\n\t// * https://github.com/michael-klein/funcy.js/blob/f6be73468e6ec46b0ff5aa3cc4c9baf72a29025a/src/hooks/core_hooks.mjs\n\t// * https://github.com/michael-klein/funcy.js/blob/650beaa58c43c33a74820a3c98b3c7079cf2e333/src/renderer.mjs\n\t// Other implementations to look at:\n\t// * https://codesandbox.io/s/mnox05qp8\n\tconst hooks =\n\t\tcurrentComponent.__hooks ||\n\t\t(currentComponent.__hooks = {\n\t\t\t_list: [],\n\t\t\t_pendingEffects: []\n\t\t});\n\n\tif (index >= hooks._list.length) {\n\t\thooks._list.push({});\n\t}\n\treturn hooks._list[index];\n}\n\n/**\n * @param {import('./index').StateUpdater<any>} [initialState]\n */\nexport function useState(initialState) {\n\tcurrentHook = 1;\n\treturn useReducer(invokeOrReturn, initialState);\n}\n\n/**\n * @param {import('./index').Reducer<any, any>} reducer\n * @param {import('./index').StateUpdater<any>} initialState\n * @param {(initialState: any) => void} [init]\n * @returns {[ any, (state: any) => void ]}\n */\nexport function useReducer(reducer, initialState, init) {\n\t/** @type {import('./internal').ReducerHookState} */\n\tconst hookState = getHookState(currentIndex++, 2);\n\thookState._reducer = reducer;\n\tif (!hookState._component) {\n\t\thookState._value = [\n\t\t\t!init ? invokeOrReturn(undefined, initialState) : init(initialState),\n\n\t\t\taction => {\n\t\t\t\tconst nextValue = hookState._reducer(hookState._value[0], action);\n\t\t\t\tif (hookState._value[0] !== nextValue) {\n\t\t\t\t\thookState._value = [nextValue, hookState._value[1]];\n\t\t\t\t\thookState._component.setState({});\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\thookState._component = currentComponent;\n\t}\n\n\treturn hookState._value;\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {any[]} args\n */\nexport function useEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 3);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._args = args;\n\n\t\tcurrentComponent.__hooks._pendingEffects.push(state);\n\t}\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {any[]} args\n */\nexport function useLayoutEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 4);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._args = args;\n\n\t\tcurrentComponent._renderCallbacks.push(state);\n\t}\n}\n\nexport function useRef(initialValue) {\n\tcurrentHook = 5;\n\treturn useMemo(() => ({ current: initialValue }), []);\n}\n\n/**\n * @param {object} ref\n * @param {() => object} createHandle\n * @param {any[]} args\n */\nexport function useImperativeHandle(ref, createHandle, args) {\n\tcurrentHook = 6;\n\tuseLayoutEffect(\n\t\t() => {\n\t\t\tif (typeof ref == 'function') ref(createHandle());\n\t\t\telse if (ref) ref.current = createHandle();\n\t\t},\n\t\targs == null ? args : args.concat(ref)\n\t);\n}\n\n/**\n * @param {() => any} factory\n * @param {any[]} args\n */\nexport function useMemo(factory, args) {\n\t/** @type {import('./internal').MemoHookState} */\n\tconst state = getHookState(currentIndex++, 7);\n\tif (argsChanged(state._args, args)) {\n\t\tstate._value = factory();\n\t\tstate._args = args;\n\t\tstate._factory = factory;\n\t}\n\n\treturn state._value;\n}\n\n/**\n * @param {() => void} callback\n * @param {any[]} args\n */\nexport function useCallback(callback, args) {\n\tcurrentHook = 8;\n\treturn useMemo(() => callback, args);\n}\n\n/**\n * @param {import('./internal').PreactContext} context\n */\nexport function useContext(context) {\n\tconst provider = currentComponent.context[context._id];\n\t// We could skip this call here, but than we'd not call\n\t// `options._hook`. We need to do that in order to make\n\t// the devtools aware of this hook.\n\t/** @type {import('./internal').ContextHookState} */\n\tconst state = getHookState(currentIndex++, 9);\n\t// The devtools needs access to the context object to\n\t// be able to pull of the default value when no provider\n\t// is present in the tree.\n\tstate._context = context;\n\tif (!provider) return context._defaultValue;\n\t// This is probably not safe to convert to \"!\"\n\tif (state._value == null) {\n\t\tstate._value = true;\n\t\tprovider.sub(currentComponent);\n\t}\n\treturn provider.props.value;\n}\n\n/**\n * Display a custom label for a custom hook for the devtools panel\n * @type {<T>(value: T, cb?: (value: T) => string | number) => void}\n */\nexport function useDebugValue(value, formatter) {\n\tif (options.useDebugValue) {\n\t\toptions.useDebugValue(formatter ? formatter(value) : value);\n\t}\n}\n\n/**\n * @param {(error: any) => void} cb\n */\nexport function useErrorBoundary(cb) {\n\t/** @type {import('./internal').ErrorBoundaryHookState} */\n\tconst state = getHookState(currentIndex++, 10);\n\tconst errState = useState();\n\tstate._value = cb;\n\tif (!currentComponent.componentDidCatch) {\n\t\tcurrentComponent.componentDidCatch = err => {\n\t\t\tif (state._value) state._value(err);\n\t\t\terrState[1](err);\n\t\t};\n\t}\n\treturn [\n\t\terrState[0],\n\t\t() => {\n\t\t\terrState[1](undefined);\n\t\t}\n\t];\n}\n\n/**\n * After paint effects consumer.\n */\nfunction flushAfterPaintEffects() {\n\tafterPaintEffects.forEach(component => {\n\t\tif (component._parentDom) {\n\t\t\ttry {\n\t\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeCleanup);\n\t\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeEffect);\n\t\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t\t} catch (e) {\n\t\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t\t\toptions._catchError(e, component._vnode);\n\t\t\t}\n\t\t}\n\t});\n\tafterPaintEffects = [];\n}\n\nlet HAS_RAF = typeof requestAnimationFrame == 'function';\n\n/**\n * Schedule a callback to be invoked after the browser has a chance to paint a new frame.\n * Do this by combining requestAnimationFrame (rAF) + setTimeout to invoke a callback after\n * the next browser frame.\n *\n * Also, schedule a timeout in parallel to the the rAF to ensure the callback is invoked\n * even if RAF doesn't fire (for example if the browser tab is not visible)\n *\n * @param {() => void} callback\n */\nfunction afterNextFrame(callback) {\n\tconst done = () => {\n\t\tclearTimeout(timeout);\n\t\tif (HAS_RAF) cancelAnimationFrame(raf);\n\t\tsetTimeout(callback);\n\t};\n\tconst timeout = setTimeout(done, RAF_TIMEOUT);\n\n\tlet raf;\n\tif (HAS_RAF) {\n\t\traf = requestAnimationFrame(done);\n\t}\n}\n\n// Note: if someone used options.debounceRendering = requestAnimationFrame,\n// then effects will ALWAYS run on the NEXT frame instead of the current one, incurring a ~16ms delay.\n// Perhaps this is not such a big deal.\n/**\n * Schedule afterPaintEffects flush after the browser paints\n * @param {number} newQueueLength\n */\nfunction afterPaint(newQueueLength) {\n\tif (newQueueLength === 1 || prevRaf !== options.requestAnimationFrame) {\n\t\tprevRaf = options.requestAnimationFrame;\n\t\t(prevRaf || afterNextFrame)(flushAfterPaintEffects);\n\t}\n}\n\n/**\n * @param {import('./internal').EffectHookState} hook\n */\nfunction invokeCleanup(hook) {\n\t// A hook cleanup can introduce a call to render which creates a new root, this will call options.vnode\n\t// and move the currentComponent away.\n\tconst comp = currentComponent;\n\tif (typeof hook._cleanup == 'function') hook._cleanup();\n\tcurrentComponent = comp;\n}\n\n/**\n * Invoke a Hook's effect\n * @param {import('./internal').EffectHookState} hook\n */\nfunction invokeEffect(hook) {\n\t// A hook call can introduce a call to render which creates a new root, this will call options.vnode\n\t// and move the currentComponent away.\n\tconst comp = currentComponent;\n\thook._cleanup = hook._value();\n\tcurrentComponent = comp;\n}\n\n/**\n * @param {any[]} oldArgs\n * @param {any[]} newArgs\n */\nfunction argsChanged(oldArgs, newArgs) {\n\treturn (\n\t\t!oldArgs ||\n\t\toldArgs.length !== newArgs.length ||\n\t\tnewArgs.some((arg, index) => arg !== oldArgs[index])\n\t);\n}\n\nfunction invokeOrReturn(arg, f) {\n\treturn typeof f == 'function' ? f(arg) : f;\n}\n","import { FunctionalComponent, h } from \"preact\";\nimport style from \"./style.css\";\n\nconst Header: FunctionalComponent = () => {\n  return (\n    <header class={style.header}>\n      <h1>PowerUp Pong</h1>\n    </header>\n  );\n};\n\nexport default Header;\n","import Paho, { Message, ConnectionOptions, Client } from \"paho-mqtt\";\nimport { StateUpdater } from \"preact/hooks\";\nimport {\n  BROKER,\n  BROKER_PORT,\n  DEBUG,\n  GAME_PROPS_TOPIC,\n  GAME_STATE_TOPIC,\n  KEEP_ALIVE_INTERVAL_SEC,\n  PASSWORD,\n  USERNAME,\n  WEB_SOCKET_ID,\n} from \"./constants\";\nimport { GameProps, GameState } from \"./interfaces\";\n\nexport const client: Client = new Paho.Client(\n  BROKER,\n  BROKER_PORT,\n  WEB_SOCKET_ID\n);\n\nconst onConnect = (client: Client) => (): void => {\n  console.log(\"Connected!\");\n  client.subscribe(GAME_STATE_TOPIC);\n  client.subscribe(GAME_PROPS_TOPIC);\n};\n\nconst options: ConnectionOptions = {\n  useSSL: false,\n  keepAliveInterval: KEEP_ALIVE_INTERVAL_SEC,\n  onSuccess: onConnect(client),\n  userName: USERNAME,\n  password: PASSWORD,\n};\n\nclient.connect(options);\n\nexport const onMessageArrived = (\n  setGameState: StateUpdater<GameState>,\n  setGameProps: StateUpdater<GameProps>\n) => (message: Message): void => {\n  if (DEBUG) {\n    console.log(`Message Arrived: ${message.destinationName}`);\n    console.log(`Message Arrived: ${message.payloadString}`);\n  }\n\n  if (message.destinationName == GAME_STATE_TOPIC) {\n    setGameState(JSON.parse(message.payloadString) as GameState);\n  } else {\n    setGameProps(JSON.parse(message.payloadString) as GameProps);\n  }\n};\n","export const DEBUG = false;\n\n/* Broker constants */\n// export const BROKER = \"iot.cs.calvin.edu\";\n// export const BROKER_PORT = 8080;\nexport const USERNAME = \"cs326\";\nexport const PASSWORD = \"piot\";\n// For testing at home\nexport const BROKER = \"mqtt.eclipseprojects.io/mqtt\";\nexport const BROKER_PORT = 80;\n\n/* Topic strings */\nexport const GAME_STATE_TOPIC = \"pup/game\";\nexport const GAME_PROPS_TOPIC = \"pup/game-props\";\n\n/* Additional Constants */\nexport const KEEP_ALIVE_INTERVAL_SEC = 60;\n// This is a small hack to make sure simultaneous viewers can be found.\nexport const WEB_SOCKET_ID = Math.random().toString();\n","/* eslint-disable @typescript-eslint/camelcase */\n\nexport interface GameState {\n  players: [PlayerState, PlayerState];\n  ball: [number, number];\n  powerups: Powerup[];\n}\n\nexport interface PlayerState {\n  id: number;\n  score: number;\n  paddle_pos: number;\n  paddle_width: number;\n  powerups: Powerup[];\n}\n\nexport interface Powerup {\n  pos: [number, number] | null;\n  type: \"paddleGrow\" | \"fastBall\" | \"trackBall\";\n  owner: string | null;\n  time_used: number | null;\n}\n\nexport interface GameProps {\n  x_constraints: [number, number];\n  y_constraints: [number, number];\n  powerup_radius: number;\n}\n\nexport interface DerivedConstants {\n  X_CONSTRAINTS: [number, number];\n  Y_CONSTRAINTS: [number, number];\n  POWERUP_RADIUS: number;\n  CANVAS_PADDING: number;\n  SCALE: number;\n  POWERUP_CANVAS_HEIGHT: number;\n  CANVAS_HEIGHT: number;\n  CANVAS_WIDTH: number;\n}\n\nexport const defaultPlayerState: PlayerState = {\n  id: 1,\n  score: -1,\n  paddle_pos: 100,\n  paddle_width: 200,\n  powerups: [],\n};\n\nexport const defaultGameState: GameState = {\n  players: [defaultPlayerState, defaultPlayerState],\n  ball: [100, 100],\n  powerups: [],\n};\n\nexport const defaultGameProps: GameProps = {\n  x_constraints: [-100, 1123],\n  y_constraints: [-100, 1123],\n  powerup_radius: 20,\n};\n","import { DEBUG } from \"./constants\";\nimport { DerivedConstants, GameProps, GameState, Powerup } from \"./interfaces\";\n\n// ref: https://stackoverflow.com/a/54153800/9931154\nconst clearCanvases = (\n  ctx: CanvasRenderingContext2D,\n  ctxPowerup: CanvasRenderingContext2D,\n  { CANVAS_HEIGHT, CANVAS_WIDTH, POWERUP_RADIUS }: DerivedConstants\n): void => {\n  ctx.fillStyle = \"rgb(255, 255, 255)\";\n  ctx.fillRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);\n  ctxPowerup.fillStyle = \"rgb(255, 255, 255)\";\n  ctxPowerup.fillRect(0, 0, CANVAS_WIDTH, POWERUP_RADIUS * 2);\n};\n\nexport const draw = (\n  ctx: CanvasRenderingContext2D,\n  ctxPowerup: CanvasRenderingContext2D,\n  gameState: GameState,\n  gameProps: GameProps,\n  derivedConstants: DerivedConstants\n): void => {\n  // get constants for the functions\n  const { powerup_radius } = gameProps;\n  const {\n    players: [player1, player2],\n    ball: [ballX, ballY],\n    powerups,\n  } = gameState;\n  const {\n    paddle_pos: paddle1,\n    powerups: powerups1,\n    paddle_width: paddle1_width,\n  } = player1;\n  const {\n    paddle_pos: paddle2,\n    powerups: powerups2,\n    paddle_width: paddle2_width,\n  } = player2;\n  const {\n    SCALE,\n    CANVAS_PADDING,\n    CANVAS_WIDTH,\n    X_CONSTRAINTS,\n    Y_CONSTRAINTS,\n  } = derivedConstants;\n  const HALF_PADDING = CANVAS_PADDING / 2;\n  const PADDLE_THICKNESS = 1;\n  const BALL_RADIUS = 2;\n\n  clearCanvases(ctx, ctxPowerup, derivedConstants);\n\n  ctx.fillStyle = \"#000000\";\n\n  // draw paddle 1\n  ctx.fillRect(\n    HALF_PADDING,\n    paddle1 * SCALE + HALF_PADDING,\n    PADDLE_THICKNESS,\n    paddle1_width * SCALE\n  );\n\n  // draw paddle 2\n  ctx.fillRect(\n    CANVAS_WIDTH - HALF_PADDING,\n    paddle2 * SCALE + HALF_PADDING,\n    PADDLE_THICKNESS,\n    paddle2_width * SCALE\n  );\n\n  // draw powerups\n  if (powerups.length > 0) {\n    powerups.forEach((powerup) => {\n      const { pos, type } = powerup;\n      ctx.fillStyle = getPowerupColor(type);\n      if (pos !== null) {\n        const [xPos, yPos] = pos;\n        ctx.fillRect(\n          (xPos - powerup_radius - X_CONSTRAINTS[0]) * SCALE + HALF_PADDING,\n          (yPos - powerup_radius - Y_CONSTRAINTS[0]) * SCALE + HALF_PADDING,\n          2 * powerup_radius * SCALE,\n          2 * powerup_radius * SCALE\n        );\n      }\n    });\n  }\n\n  drawPowerupQueue(ctxPowerup, powerups1, CANVAS_WIDTH);\n  drawPowerupQueue(ctxPowerup, powerups2, CANVAS_WIDTH, false);\n\n  // draw ball\n  ctx.fillStyle = \"#000000\";\n  const calculatedBallX = (ballX - X_CONSTRAINTS[0]) * SCALE + HALF_PADDING;\n  const calculatedBallY = (ballY - Y_CONSTRAINTS[0]) * SCALE + HALF_PADDING;\n\n  if (DEBUG) {\n    console.log(HALF_PADDING, SCALE);\n    console.log(ballX, ballY);\n    console.log(calculatedBallX, calculatedBallY);\n  }\n  ctx.beginPath();\n  ctx.arc(calculatedBallX, calculatedBallY, BALL_RADIUS, 0, 2 * Math.PI);\n  ctx.fill();\n};\n\nconst drawPowerupQueue = (\n  ctxPowerup: CanvasRenderingContext2D,\n  powerups: Powerup[],\n  canvasWidth: number,\n  left: boolean = true\n): void => {\n  const POWERUP_CANVAS_WIDTH = 15;\n  const POWERUP_CANVAS_OFFSET = 5;\n  const MAX_POWERUPS_SHOWN = 5;\n  const USED_POWERUP_BORDER = 4;\n  if (powerups.length > 0) {\n    powerups.forEach((powerup, i) => {\n      const xPos = left\n        ? POWERUP_CANVAS_OFFSET +\n          i * (POWERUP_CANVAS_OFFSET + POWERUP_CANVAS_WIDTH)\n        : canvasWidth -\n          (POWERUP_CANVAS_OFFSET + POWERUP_CANVAS_WIDTH) * i -\n          (POWERUP_CANVAS_OFFSET + POWERUP_CANVAS_WIDTH);\n      const { time_used, type } = powerup;\n      if (i < MAX_POWERUPS_SHOWN) {\n        if (time_used !== null) {\n          ctxPowerup.fillStyle = \"red\";\n          ctxPowerup.fillRect(\n            xPos - USED_POWERUP_BORDER / 2,\n            POWERUP_CANVAS_OFFSET - USED_POWERUP_BORDER / 2,\n            POWERUP_CANVAS_WIDTH + USED_POWERUP_BORDER,\n            POWERUP_CANVAS_WIDTH + USED_POWERUP_BORDER\n          );\n        }\n        ctxPowerup.fillStyle = getPowerupColor(type);\n        ctxPowerup.fillRect(\n          xPos,\n          POWERUP_CANVAS_OFFSET,\n          POWERUP_CANVAS_WIDTH,\n          POWERUP_CANVAS_WIDTH\n        );\n      }\n    });\n  }\n};\n\nconst getPowerupColor = (type: string) => {\n  return type === \"paddleGrow\"\n    ? \"green\"\n    : type === \"fastBall\"\n    ? \"orange\"\n    : \"purple\";\n};\n","import { FunctionalComponent, h } from \"preact\";\nimport style from \"./style.css\";\n\ninterface PowerupLegendEntryProps {\n  text: string;\n  squareStyle: string;\n}\n\nexport const PowerupLegendEntry: FunctionalComponent<PowerupLegendEntryProps> = ({\n  text,\n  squareStyle,\n}: PowerupLegendEntryProps) => {\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        justifyContent: \"space-between\",\n        width: \"100%\",\n      }}\n    >\n      <div id={squareStyle} />\n      <p class={style.squareText}>{text}</p>\n    </div>\n  );\n};\n","import { FunctionalComponent, h } from \"preact\";\nimport { PowerupLegendEntry } from \"./PowerupLegendEntry\";\nimport style from \"./style.css\";\n\nexport const PowerupLegend: FunctionalComponent = () => {\n  return (\n    <div\n      style={{\n        display: \"flex\",\n      }}\n    >\n      <h1>PowerUps</h1>\n      <div id={style.squares}>\n        <PowerupLegendEntry text=\"Grow\" squareStyle={style.square1} />\n        <PowerupLegendEntry text=\"Fast Ball\" squareStyle={style.square2} />\n        <PowerupLegendEntry text=\"Follow\" squareStyle={style.square3} />\n      </div>\n    </div>\n  );\n};\n","import { Pong } from \"./Pong\";\n\nexport default Pong;\n","/*\nA web viewer for a Power-Up Pong game using websockets\nWritten by Jon Ellis (jde27), Charlie Kornoelje (cek26), and Ryan Vreeke (rjv59)\nfor CS 326 Final Project at Calvin University, April 2021\n*/\n\nimport { FunctionalComponent, h } from \"preact\";\nimport { useEffect, useMemo, useRef, useState } from \"preact/hooks\";\nimport { DEBUG } from \"./constants\";\nimport {\n  defaultGameProps,\n  defaultGameState,\n  GameProps,\n  GameState,\n} from \"./interfaces\";\nimport style from \"./style.css\";\nimport { getDerivedConstants } from \"./getDerivedConstants\";\nimport { client, onMessageArrived } from \"./wsClient\";\nimport { draw } from \"./canvasUtils\";\nimport { PowerupLegend } from \"./PowerUpLegend\";\n\nexport const Pong: FunctionalComponent = () => {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const canvasRefPowerup = useRef<HTMLCanvasElement>(null);\n  const [gameState, setGameState] = useState<GameState>(defaultGameState);\n  const [gameProps, setGameProps] = useState<GameProps>(defaultGameProps);\n\n  client.onMessageArrived = useMemo(() => {\n    return onMessageArrived(setGameState, setGameProps);\n  }, []);\n\n  const derivedConstants = useMemo(() => {\n    return getDerivedConstants(gameProps);\n  }, [gameProps]);\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    const context = canvas.getContext(\"2d\");\n    const canvasPowerup = canvasRefPowerup.current;\n    const contextPowerup = canvasPowerup.getContext(\"2d\");\n    if (context && contextPowerup) {\n      draw(context, contextPowerup, gameState, gameProps, derivedConstants);\n    }\n  }, [gameState, gameProps, derivedConstants]);\n\n  const {\n    POWERUP_CANVAS_HEIGHT,\n    CANVAS_HEIGHT,\n    CANVAS_WIDTH,\n  } = derivedConstants;\n  const [player1_score, player2_score] = gameState.players.map(\n    ({ score }) => score\n  );\n\n  return (\n    <div class={style.pong}>\n      <div class={style.center}>\n        {/* These lines of code helped testing and debugging of PowerUp Pong */}\n        {DEBUG && (\n          <div>\n            <p>Game State: {JSON.stringify(gameState)}</p>\n            <p>Game Properties: {JSON.stringify(gameProps)}</p>\n          </div>\n        )}\n        <div\n          style={{\n            display: \"flex\",\n            justifyContent: \"space-between\",\n            width: \"100%\",\n          }}\n        >\n          <h2>Player 1 Score: {player1_score}</h2>\n          <h2>Player 2 Score: {player2_score}</h2>\n        </div>\n        <PowerupLegend />\n        <canvas\n          ref={canvasRefPowerup}\n          height={POWERUP_CANVAS_HEIGHT}\n          width={CANVAS_WIDTH}\n          style={{ border: \"1px solid purple\" }}\n        />\n        <canvas\n          ref={canvasRef}\n          height={CANVAS_HEIGHT}\n          width={CANVAS_WIDTH}\n          style={{ border: \"1px solid purple\" }}\n        />\n      </div>\n    </div>\n  );\n};\n\n","import { DerivedConstants, GameProps } from \"./interfaces\";\n\n/* get constants related to the game props */\nexport const getDerivedConstants = ({\n  powerup_radius,\n  x_constraints,\n  y_constraints,\n}: GameProps): DerivedConstants => {\n  const X_CONSTRAINTS = x_constraints;\n  const Y_CONSTRAINTS = y_constraints;\n  const POWERUP_RADIUS = powerup_radius;\n  const CANVAS_PADDING = 20;\n  const SCALE = 0.5;\n  const POWERUP_CANVAS_HEIGHT = 25;\n  const CANVAS_HEIGHT =\n    (Y_CONSTRAINTS[1] - Y_CONSTRAINTS[0]) * SCALE + CANVAS_PADDING;\n  const CANVAS_WIDTH =\n    (X_CONSTRAINTS[1] - X_CONSTRAINTS[0]) * SCALE + CANVAS_PADDING;\n\n  return {\n    X_CONSTRAINTS,\n    Y_CONSTRAINTS,\n    POWERUP_RADIUS,\n    CANVAS_PADDING,\n    SCALE,\n    POWERUP_CANVAS_HEIGHT,\n    CANVAS_HEIGHT,\n    CANVAS_WIDTH,\n  };\n};\n","import './style/index.css';\nimport App from './components/app';\n\nexport default App;\n","import { FunctionalComponent, h } from \"preact\";\nimport Header from \"./header\";\nimport Pong from \"./pong\";\n\nconst App: FunctionalComponent = () => {\n  return (\n    <div id=\"app\">\n      <Header />\n      <Pong />\n    </div>\n  );\n};\n\nexport default App;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"header__3QGkI\",\"active\":\"active__3gItZ\"};"],"sourceRoot":""}